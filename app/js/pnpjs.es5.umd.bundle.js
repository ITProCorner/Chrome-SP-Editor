/**
 * @license
 * v2.0.1
 * MIT (https://github.com/pnp/pnpjs/blob/master/LICENSE)
 * Copyright (c) 2020 Microsoft
 * docs: https://pnp.github.io/pnpjs/
 * source: https://github.com/pnp/pnpjs
 * bugs: https://github.com/pnp/pnpjs/issues
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.pnp=t():e.pnp=t()}(window,(function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=144)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1);n.__exportStar(r(152),t),n.__exportStar(r(60),t),n.__exportStar(r(153),t),n.__exportStar(r(154),t),n.__exportStar(r(155),t),n.__exportStar(r(39),t),n.__exportStar(r(63),t),n.__exportStar(r(62),t),n.__exportStar(r(156),t);var o=r(61);t.extendGlobal=o.extendGlobal,t.extendObj=o.extendObj,t.extendFactory=o.extendFactory,t.clearGlobalExtensions=o.clearGlobalExtensions,t.enableExtensions=o.enableExtensions,t.disableExtensions=o.disableExtensions},function(e,t,r){"use strict";r.r(t),r.d(t,"__extends",(function(){return o})),r.d(t,"__assign",(function(){return i})),r.d(t,"__rest",(function(){return a})),r.d(t,"__decorate",(function(){return s})),r.d(t,"__param",(function(){return u})),r.d(t,"__metadata",(function(){return c})),r.d(t,"__awaiter",(function(){return l})),r.d(t,"__generator",(function(){return p})),r.d(t,"__exportStar",(function(){return d})),r.d(t,"__values",(function(){return h})),r.d(t,"__read",(function(){return f})),r.d(t,"__spread",(function(){return y})),r.d(t,"__spreadArrays",(function(){return g})),r.d(t,"__await",(function(){return _})),r.d(t,"__asyncGenerator",(function(){return b})),r.d(t,"__asyncDelegator",(function(){return v})),r.d(t,"__asyncValues",(function(){return m})),r.d(t,"__makeTemplateObject",(function(){return P})),r.d(t,"__importStar",(function(){return S})),r.d(t,"__importDefault",(function(){return T}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function o(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function a(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function s(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a}function u(e,t){return function(r,n){t(r,n,e)}}function c(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function l(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){e.done?o(e.value):new r((function(t){t(e.value)})).then(a,s)}u((n=n.apply(e,t||[])).next())}))}function p(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function d(e,t){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}function h(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}}function f(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function y(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(f(arguments[t]));return e}function g(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)n[o]=i[a];return n}function _(e){return this instanceof _?(this.v=e,this):new _(e)}function b(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),i=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(e){o[e]&&(n[e]=function(t){return new Promise((function(r,n){i.push([e,t,r,n])>1||s(e,t)}))})}function s(e,t){try{(r=o[e](t)).value instanceof _?Promise.resolve(r.value.v).then(u,c):l(i[0][2],r)}catch(e){l(i[0][3],e)}var r}function u(e){s("next",e)}function c(e){s("throw",e)}function l(e,t){e(t),i.shift(),i.length&&s(i[0][0],i[0][1])}}function v(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:_(e[n](t)),done:"return"===n}:o?o(t):t}:o}}function m(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=h(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,o){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,o,(t=e[r](t)).done,t.value)}))}}}function P(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function S(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function T(e){return e&&e.__esModule?e:{default:e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1);n.__exportStar(r(54),t),n.__exportStar(r(55),t),n.__exportStar(r(147),t),n.__exportStar(r(148),t),n.__exportStar(r(27),t)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(2),i=r(0),a=r(18),s=r(8),u=r(4),c=r(5);t.spInvokableFactory=function(e){return i.invokableFactory(e)};var l=function(e){function t(t,r){var n=this,i="",a="",s=new Map;if("string"==typeof t)if(o.isUrlAbsolute(t)||t.lastIndexOf("/")<0)a=t,i=o.combine(t,r);else if(t.lastIndexOf("/")>t.lastIndexOf("(")){var u=t.lastIndexOf("/");a=t.slice(0,u),r=o.combine(t.slice(u),r),i=o.combine(a,r)}else{u=t.lastIndexOf("(");a=t.slice(0,u),i=o.combine(t,r)}else{a=t.toUrl(),i=o.combine(a,r||"");var c=t.query.get("@target");void 0!==c&&s.set("@target",c)}return n=e.call(this,{parentUrl:a,query:s,url:i})||this,"string"!=typeof t&&n.configureFrom(t),n._forceCaching=!1,n}return n.__extends(t,e),t.prototype.toUrlAndQuery=function(){var e=new Map(this.query),t=this.toUrl().replace(/'!(@.*?)::(.*?)'/gi,(function(t,r,n){return a.Logger.write("Rewriting aliased parameter from match "+t+" to label: "+r+" value: "+n,0),e.set(r,"'"+n+"'"),r}));if(e.size>0){var r=t.indexOf("?")>-1?"&":"?";t+=""+r+Array.from(e).map((function(e){return e[0]+"="+e[1]})).join("&")}return t},t.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this.query.set("$select",e.join(",")),this},t.prototype.get=function(e){return u.spGet(this,e)},t.prototype.expand=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this.query.set("$expand",e.join(",")),this},t.prototype.clone=function(t,r,n){void 0===n&&(n=!0);var o=e.prototype.cloneTo.call(this,t(this,r),{includeBatch:n}),i="@target";return this.query.has(i)&&o.query.set(i,this.query.get(i)),o},t.prototype.defaultAction=function(e){return u.spGet(this,e)},t.prototype.getParent=function(e,t,r,n){void 0===t&&(t=this.parentUrl);var o=e(t,r).configureFrom(this),i="@target";return this.query.has(i)&&o.query.set(i,this.query.get(i)),void 0!==n&&(o=o.inBatch(n)),o},t}(i.Queryable);t._SharePointQueryable=l,t.SharePointQueryable=t.spInvokableFactory(l);var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.filter=function(e){return this.query.set("$filter",e),this},t.prototype.orderBy=function(e,t){void 0===t&&(t=!0);var r="$orderby",n=this.query.has(r)?this.query.get(r).split(","):[];return n.push(e+" "+(t?"asc":"desc")),this.query.set(r,n.join(",")),this},t.prototype.skip=function(e){return this.query.set("$skip",e.toString()),this},t.prototype.top=function(e){return this.query.set("$top",e.toString()),this},t}(l);t._SharePointQueryableCollection=p,t.SharePointQueryableCollection=t.spInvokableFactory(p);var d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype._update=function(e,t){var r=this;return function(n){return u.spPost(c.tag.configure(r,e+".Update"),{body:o.jsS(o.assign(s.metadata(e),n)),headers:{"X-HTTP-Method":"MERGE"}}).then((function(e){return t(e,n)}))}},t}(l);t._SharePointQueryableInstance=d,t.SharePointQueryableInstance=t.spInvokableFactory(d),t.deleteable=function(e){return function(){return u.spPostDelete(c.tag.configure(this,e+".delete"))}},t.deleteableWithETag=function(e){return function(t){return void 0===t&&(t="*"),u.spPostDeleteETag(c.tag.configure(this,e+".delete"),{},t)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(0),i=r(28),a=r(2),s=r(40),u=o.defaultPipelineBinder((function(){return new i.SPHttpClient})),c=function(e){var t=u(e);return function(e,r){return n.__awaiter(this,void 0,void 0,(function(){var i,u,c;return n.__generator(this,(function(n){switch(n.label){case 0:return i=o.cloneQueryableData(e.data),u=a.objectDefinedNotNull(i.batch)?i.batch.addDependency():function(){},[4,s.toAbsoluteUrl(e.toUrlAndQuery())];case 1:return c=n.sent(),a.mergeOptions(i.options,r),[2,t(Object.assign({},i,{batchDependency:u,url:c}))]}}))}))}};t.spGet=function(e,t){return e.data.cloneParentWasCaching&&e.usingCaching(e.data.cloneParentCacheOptions),e._forceCaching&&(e.data.useCaching=!0),c("GET")(e,t)},t.spPost=c("POST"),t.spDelete=c("DELETE"),t.spPatch=c("PATCH"),t.spPostDelete=function(e,r){var n=Object.assign(o.headers({"X-HTTP-Method":"DELETE"}),r);return t.spPost(e,n)},t.spPostDeleteETag=function(e,r,n){void 0===n&&(n="*");var i=Object.assign(o.headers({"X-HTTP-Method":"DELETE","IF-Match":n}),r);return t.spPost(e,i)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(2),i=r(0);function a(e){return function(t,r,o){void 0===o&&(o=Object.getOwnPropertyDescriptor(t,r));var a=o.value;return o.value=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return n.__awaiter(this,void 0,void 0,(function(){return n.__generator(this,(function(r){return this.configure(i.headers({"X-PnPjs-Tracking":e})),[2,a.apply(this,t)]}))}))},o}}t.tag=a,a.getClientTag=function(e,t){if(void 0===t&&(t=!0),e.has("X-PnPjs-Tracking")){var r=e.get("X-PnPjs-Tracking");if(t&&e.delete("X-PnPjs-Tracking"),!o.stringIsNullOrEmpty(r))return r}return""},a.configure=function(e,t){return e.configure(i.headers({"X-PnPjs-Tracking":t}))},a.isTagged=function(e){return e.data.options.headers&&e.data.options.headers["X-PnPjs-Tracking"]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1);t.defaultPath=function(e){return function(t){return function(t){function r(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return t.call(this,r[0],r.length>1&&void 0!==r[1]?r[1]:e)||this}return n.__extends(r,t),r}(t)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(2),i=r(0),a=r(3),s=r(6),u=r(15),c=r(41),l=r(8),p=r(30),d=r(4),h=r(17),f=r(5),y=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r.prototype.add=function(e,r,a,s,c,p){return void 0===a&&(a=""),void 0===s&&(s="STS"),void 0===c&&(c=1033),void 0===p&&(p=!0),n.__awaiter(this,void 0,void 0,(function(){var h,f;return n.__generator(this,(function(n){switch(n.label){case 0:return h=i.body({parameters:o.assign(l.metadata("SP.WebCreationInformation"),{Description:a,Language:c,Title:e,Url:r,UseSamePermissionsAsParentSite:p,WebTemplate:s})}),[4,d.spPost(this.clone(t.Webs,"add"),h)];case 1:return[2,{data:f=n.sent(),web:t.Web(u.odataUrlFrom(f).replace(/_api\/web\/?/i,""))}]}}))}))},n.__decorate([f.tag("ws.add")],r.prototype,"add",null),r=n.__decorate([s.defaultPath("webs")],r)}(a._SharePointQueryableCollection);t._Webs=y,t.Webs=a.spInvokableFactory(y);var g=function(e){function r(){var t=null!==e&&e.apply(this,arguments)||this;return t.delete=a.deleteable("w"),t}return n.__extends(r,e),Object.defineProperty(r.prototype,"webs",{get:function(){return t.Webs(this)},enumerable:!0,configurable:!0}),r.prototype.getParentWeb=function(){return n.__awaiter(this,void 0,void 0,(function(){var e;return n.__generator(this,(function(t){switch(t.label){case 0:return[4,d.spGet(this.select("ParentWeb/Id").expand("ParentWeb"))];case 1:return[2,(e=t.sent().ParentWeb)?p.Site(this.parentUrl).openWebById(e.Id):null]}}))}))},r.prototype.getSubwebsFilteredForCurrentUser=function(e,r){void 0===e&&(e=-1),void 0===r&&(r=-1);var n=this.clone(t.Webs,"getSubwebsFilteredForCurrentUser(nWebTemplateFilter="+e+",nConfigurationFilter="+r+")");return f.tag.configure(n,"w.getSubwebsFilteredForCurrentUser")},Object.defineProperty(r.prototype,"allProperties",{get:function(){return f.tag.configure(this.clone(a.SharePointQueryableInstance,"allproperties"),"w.allprops")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"webinfos",{get:function(){return f.tag.configure(a.SharePointQueryableCollection(this,"webinfos"),"w.webinfos")},enumerable:!0,configurable:!0}),r.prototype.createBatch=function(){return new c.SPBatch(this.parentUrl)},r.prototype.update=function(e){return n.__awaiter(this,void 0,void 0,(function(){var t;return n.__generator(this,(function(r){switch(r.label){case 0:return t=i.body(o.assign(l.metadata("SP.Web"),e),i.headers({"X-HTTP-Method":"MERGE"})),[4,d.spPost(this,t)];case 1:return[2,{data:r.sent(),web:this}]}}))}))},r.prototype.applyTheme=function(e,r,n,o){var a=i.body({backgroundImageUrl:n,colorPaletteUrl:e,fontSchemeUrl:r,shareGenerated:o});return d.spPost(this.clone(t.Web,"applytheme"),a)},r.prototype.applyWebTemplate=function(e){var r=this.clone(t.Web,"applywebtemplate");return r.concat("(webTemplate='"+h.escapeQueryStrValue(e)+"')"),d.spPost(r)},r.prototype.availableWebTemplates=function(e,t){void 0===e&&(e=1033),void 0===t&&(t=!0);var r="getavailablewebtemplates(lcid="+e+", doincludecrosslanguage="+t+")";return f.tag.configure(a.SharePointQueryableCollection(this,r),"w.availableWebTemplates")},r.prototype.getChanges=function(e){var r=i.body({query:o.assign(l.metadata("SP.ChangeQuery"),e)});return d.spPost(this.clone(t.Web,"getchanges"),r)},r.prototype.mapToIcon=function(e,r,n){return void 0===r&&(r=0),void 0===n&&(n=""),d.spGet(this.clone(t.Web,"maptoicon(filename='"+h.escapeQueryStrValue(e)+"', progid='"+h.escapeQueryStrValue(n)+"', size="+r+")"))},r.prototype.getStorageEntity=function(e){return d.spGet(this.clone(t.Web,"getStorageEntity('"+h.escapeQueryStrValue(e)+"')"))},r.prototype.setStorageEntity=function(e,r,n,o){return void 0===n&&(n=""),void 0===o&&(o=""),d.spPost(this.clone(t.Web,"setStorageEntity"),i.body({comments:o,description:n,key:e,value:r}))},r.prototype.removeStorageEntity=function(e){return d.spPost(this.clone(t.Web,"removeStorageEntity('"+h.escapeQueryStrValue(e)+"')"))},n.__decorate([f.tag("w.getParentWeb")],r.prototype,"getParentWeb",null),n.__decorate([f.tag("w.update")],r.prototype,"update",null),n.__decorate([f.tag("w.applyTheme")],r.prototype,"applyTheme",null),n.__decorate([f.tag("w.applyWebTemplate")],r.prototype,"applyWebTemplate",null),n.__decorate([f.tag("w.getChanges")],r.prototype,"getChanges",null),n.__decorate([f.tag("w.mapToIcon")],r.prototype,"mapToIcon",null),n.__decorate([f.tag("w.getStorageEntity")],r.prototype,"getStorageEntity",null),n.__decorate([f.tag("w.setStorageEntity")],r.prototype,"setStorageEntity",null),n.__decorate([f.tag("w.removeStorageEntity")],r.prototype,"removeStorageEntity",null),r=n.__decorate([s.defaultPath("_api/web")],r)}(a._SharePointQueryableInstance);t._Web=g,t.Web=a.spInvokableFactory(g)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.metadata=function(e){return{__metadata:{type:e}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(2),i=r(0),a=r(68),s=r(10);t.graphInvokableFactory=function(e){return i.invokableFactory(e)};var u=function(e){function t(t,r){var n=this,i="",a="",s=new Map;return"string"==typeof t?(a=t,i=o.combine(a,r)):(a=t.toUrl(),i=o.combine(a,r)),n=e.call(this,{parentUrl:a,query:s,url:i})||this,"string"!=typeof t&&n.configureFrom(t),n}return n.__extends(t,e),t.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this.query.set("$select",e.join(",")),this},t.prototype.expand=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this.query.set("$expand",e.join(",")),this},t.prototype.defaultAction=function(e){return s.graphGet(this,e)},t.prototype.toUrlAndQuery=function(){var e=this.toUrl();if(o.isUrlAbsolute(e)||(e=o.combine("https://graph.microsoft.com",e)),this.query.size>0){var t=e.indexOf("?")>-1?"&":"?";e+=""+t+Array.from(this.query).map((function(e){return e[0]+"="+e[1]})).join("&")}return e},t.prototype.getParent=function(e,t,r){return void 0===t&&(t=this.parentUrl),new e(t,r)},t.prototype.clone=function(t,r,n){return void 0===n&&(n=!0),e.prototype.cloneTo.call(this,t(this,r),{includeBatch:n})},t.prototype.setEndpoint=function(e){return this.data.url=a.GraphEndpoints.ensure(this.data.url,e),this},t}(i.Queryable);t._GraphQueryable=u,t.GraphQueryable=t.graphInvokableFactory(u);var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.filter=function(e){return this.query.set("$filter",e),this},t.prototype.orderBy=function(e,t){void 0===t&&(t=!0);var r="$orderby",n=this.query.has(r)?this.query.get(r).split(","):[];return n.push(e+" "+(t?"asc":"desc")),this.query.set(r,n.join(",")),this},t.prototype.top=function(e){return this.query.set("$top",e.toString()),this},t.prototype.skip=function(e){return this.query.set("$skip",e.toString()),this},t.prototype.skipToken=function(e){return this.query.set("$skiptoken",e),this},Object.defineProperty(t.prototype,"count",{get:function(){return this.query.set("$count","true"),this},enumerable:!0,configurable:!0}),t}(u);t._GraphQueryableCollection=c,t.GraphQueryableCollection=t.graphInvokableFactory(c);var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.search=function(e){return this.query.set("$search",e),this},t}(c);t._GraphQueryableSearchableCollection=l,t.GraphQueryableSearchableCollection=t.graphInvokableFactory(l);var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t}(u);t._GraphQueryableInstance=p,t.GraphQueryableInstance=t.graphInvokableFactory(p)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(2),i=r(0),a=r(42),s=i.defaultPipelineBinder((function(){return new a.GraphHttpClient})),u=function(e){return function(t,r){return n.__awaiter(this,void 0,void 0,(function(){var a,s,u;return n.__generator(this,(function(n){return a=i.cloneQueryableData(t.data),s=o.objectDefinedNotNull(a.batch)?a.batch.addDependency():function(){},u=t.toUrlAndQuery(),o.mergeOptions(a.options,r),[2,e(Object.assign({},a,{batchDependency:s,url:u}))]}))}))}};t.graphGet=function(e,t){return u(s("GET"))(e,t)},t.graphPost=function(e,t){return u(s("POST"))(e,t)},t.graphDelete=function(e,t){return u(s("DELETE"))(e,t)},t.graphPatch=function(e,t){return u(s("PATCH"))(e,t)},t.graphPut=function(e,t){return u(s("PUT"))(e,t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(10),i=r(0);t.defaultPath=function(e){return function(t){return function(t){function r(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return t.call(this,r[0],r.length>1&&void 0!==r[1]?r[1]:e)||this}return n.__extends(r,t),r}(t)}},t.deleteable=function(){return function(e){return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.delete=function(){return o.graphDelete(this)},t}(e)}},t.deleteableWithETag=function(){return function(e){return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.delete=function(e){return void 0===e&&(e="*"),o.graphDelete(this,i.headers({"If-Match":e}))},t}(e)}},t.updateable=function(){return function(e){return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.update=function(e){return o.graphPatch(this,i.body(e))},t}(e)}},t.updateableWithETag=function(){return function(e){return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.update=function(e,t){return void 0===t&&(t="*"),o.graphPatch(this,i.body(e,i.headers({"If-Match":t})))},t}(e)}},t.addable=function(){return function(e){return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.add=function(e){return o.graphPost(this,i.body(e))},t}(e)}},t.getById=function(e){return function(t){return function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(r,t),r.prototype.getById=function(t){return e(this,t)},r}(t)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2);t.extractWebUrl=function(e){if(n.stringIsNullOrEmpty(e))return"";var t=e.indexOf("_api/");return t<0&&(t=e.indexOf("_vti_bin/")),t>-1?e.substr(0,t):e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(2),i=r(0),a=r(3),s=r(15),u=r(8),c=r(6),l=r(4),p=r(17),d=r(5),h=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r.prototype.getById=function(e){return d.tag.configure(t.List(this).concat("('"+e+"')"),"ls.getById")},r.prototype.getByTitle=function(e){return d.tag.configure(t.List(this,"getByTitle('"+p.escapeQueryStrValue(e)+"')"),"ls.getByTitle")},r.prototype.add=function(e,t,r,o,a){return void 0===t&&(t=""),void 0===r&&(r=100),void 0===o&&(o=!1),void 0===a&&(a={}),n.__awaiter(this,void 0,void 0,(function(){var s;return n.__generator(this,(function(n){switch(n.label){case 0:return s=Object.assign({AllowContentTypes:o,BaseTemplate:r,ContentTypesEnabled:o,Description:t,Title:e},u.metadata("SP.List"),a),[4,l.spPost(this,i.body(s))];case 1:return[2,{data:n.sent(),list:this.getByTitle(s.Title)}]}}))}))},r.prototype.ensure=function(e,t,r,i,a){return void 0===t&&(t=""),void 0===r&&(r=100),void 0===i&&(i=!1),void 0===a&&(a={}),n.__awaiter(this,void 0,void 0,(function(){var s,u;return n.__generator(this,(function(n){switch(n.label){case 0:if(this.hasBatch)throw Error("The ensure list method is not supported for use in a batch.");s=o.assign(a,{Title:e,Description:t,ContentTypesEnabled:i},!0),u=this.getByTitle(s.Title),n.label=1;case 1:return n.trys.push([1,4,,6]),[4,u.select("Title")()];case 2:return n.sent(),[4,u.update(s).then((function(e){return e.data}))];case 3:return[2,{created:!1,data:n.sent(),list:this.getByTitle(s.Title)}];case 4:return n.sent(),[4,this.add(e,t,r,i,s).then((function(e){return e.data}))];case 5:return[2,{created:!0,data:n.sent(),list:this.getByTitle(s.Title)}];case 6:return[2]}}))}))},r.prototype.ensureSiteAssetsLibrary=function(){return n.__awaiter(this,void 0,void 0,(function(){var e;return n.__generator(this,(function(r){switch(r.label){case 0:return[4,l.spPost(this.clone(t.Lists,"ensuresiteassetslibrary"))];case 1:return e=r.sent(),[2,t.List(s.odataUrlFrom(e))]}}))}))},r.prototype.ensureSitePagesLibrary=function(){return n.__awaiter(this,void 0,void 0,(function(){var e;return n.__generator(this,(function(r){switch(r.label){case 0:return[4,l.spPost(this.clone(t.Lists,"ensuresitepageslibrary"))];case 1:return e=r.sent(),[2,t.List(s.odataUrlFrom(e))]}}))}))},n.__decorate([d.tag("ls.add")],r.prototype,"add",null),n.__decorate([d.tag("ls.ensure")],r.prototype,"ensure",null),n.__decorate([d.tag("ls.ensureSiteAssetsLibrary")],r.prototype,"ensureSiteAssetsLibrary",null),n.__decorate([d.tag("ls.ensureSitePagesLibrary")],r.prototype,"ensureSitePagesLibrary",null),r=n.__decorate([c.defaultPath("lists")],r)}(a._SharePointQueryableCollection);t._Lists=h,t.Lists=a.spInvokableFactory(h);var f=function(e){function r(){var t=null!==e&&e.apply(this,arguments)||this;return t.delete=a.deleteableWithETag("l"),t}return n.__extends(r,e),Object.defineProperty(r.prototype,"effectiveBasePermissions",{get:function(){return d.tag.configure(a.SharePointQueryable(this,"EffectiveBasePermissions"),"l.effectiveBasePermissions")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"eventReceivers",{get:function(){return d.tag.configure(a.SharePointQueryableCollection(this,"EventReceivers"),"l.eventReceivers")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"relatedFields",{get:function(){return d.tag.configure(a.SharePointQueryable(this,"getRelatedFields"),"l.relatedFields")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"informationRightsManagementSettings",{get:function(){return d.tag.configure(a.SharePointQueryable(this,"InformationRightsManagementSettings"),"l.informationRightsManagementSettings")},enumerable:!0,configurable:!0}),r.prototype.update=function(e,r){return void 0===r&&(r="*"),n.__awaiter(this,void 0,void 0,(function(){var a,s,c;return n.__generator(this,(function(n){switch(n.label){case 0:return a=i.body(o.assign(u.metadata("SP.List"),e),i.headers({"IF-Match":r,"X-HTTP-Method":"MERGE"})),[4,l.spPost(this,a)];case 1:return s=n.sent(),c=this,o.hOP(e,"Title")&&(c=this.getParent(t.List,this.parentUrl,"getByTitle('"+e.Title+"')")),[2,{data:s,list:c}]}}))}))},r.prototype.getChanges=function(e){return l.spPost(this.clone(t.List,"getchanges"),i.body({query:o.assign(u.metadata("SP.ChangeQuery"),e)}))},r.prototype.getItemsByCAMLQuery=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var a=this.clone(t.List,"getitems");return l.spPost(a.expand.apply(a,r),i.body({query:o.assign(u.metadata("SP.CamlQuery"),e)}))},r.prototype.getListItemChangesSinceToken=function(e){var r=this.clone(t.List,"getlistitemchangessincetoken").usingParser({parse:function(e){return e.text()}});return l.spPost(r,i.body({query:o.assign(u.metadata("SP.ChangeLogItemQuery"),e)}))},r.prototype.recycle=function(){return n.__awaiter(this,void 0,void 0,(function(){var e;return n.__generator(this,(function(r){switch(r.label){case 0:return[4,l.spPost(this.clone(t.List,"recycle"))];case 1:return e=r.sent(),[2,o.hOP(e,"Recycle")?e.Recycle:e]}}))}))},r.prototype.renderListData=function(e){return n.__awaiter(this,void 0,void 0,(function(){var r,i;return n.__generator(this,(function(n){switch(n.label){case 0:return(r=this.clone(t.List,"renderlistdata(@viewXml)")).query.set("@viewXml","'"+e+"'"),[4,l.spPost(r)];case 1:return i=n.sent(),[2,JSON.parse(o.hOP(i,"RenderListData")?i.RenderListData:i)]}}))}))},r.prototype.renderListDataAsStream=function(e,r,n){void 0===r&&(r=null),void 0===n&&(n=new Map),o.hOP(e,"RenderOptions")&&o.isArray(e.RenderOptions)&&(e.RenderOptions=e.RenderOptions.reduce((function(e,t){return e+t})));var a=i.body({overrideParameters:o.assign(u.metadata("SP.RenderListDataOverrideParameters"),r),parameters:o.assign(u.metadata("SP.RenderListDataParameters"),e)}),s=this.clone(t.List,"RenderListDataAsStream",!0);return n&&n.size>0&&n.forEach((function(e,t){return s.query.set(t,e)})),l.spPost(s,a)},r.prototype.renderListFormData=function(e,r,i){return n.__awaiter(this,void 0,void 0,(function(){var a;return n.__generator(this,(function(n){switch(n.label){case 0:return[4,l.spPost(this.clone(t.List,"renderlistformdata(itemid="+e+", formid='"+r+"', mode='"+i+"')"))];case 1:return a=n.sent(),[2,JSON.parse(o.hOP(a,"RenderListFormData")?a.RenderListFormData:a)]}}))}))},r.prototype.reserveListItemId=function(){return n.__awaiter(this,void 0,void 0,(function(){var e;return n.__generator(this,(function(r){switch(r.label){case 0:return[4,l.spPost(this.clone(t.List,"reservelistitemid"))];case 1:return e=r.sent(),[2,o.hOP(e,"ReserveListItemId")?e.ReserveListItemId:e]}}))}))},r.prototype.getListItemEntityTypeFullName=function(){return this.clone(t.List,null,!1).select("ListItemEntityTypeFullName").get().then((function(e){return e.ListItemEntityTypeFullName}))},r.prototype.addValidateUpdateItemUsingPath=function(e,r,a,s){return void 0===a&&(a=!1),n.__awaiter(this,void 0,void 0,(function(){var u;return n.__generator(this,(function(n){switch(n.label){case 0:return[4,l.spPost(this.clone(t.List,"AddValidateUpdateItemUsingPath()"),i.body({bNewDocumentUpdate:a,checkInComment:s,formValues:e,listItemCreateInfo:{FolderPath:{DecodedUrl:r,__metadata:{type:"SP.ResourcePath"}},__metadata:{type:"SP.ListItemCreationInformationUsingPath"}}}))];case 1:return u=n.sent(),[2,o.hOP(u,"AddValidateUpdateItemUsingPath")?u.AddValidateUpdateItemUsingPath:u]}}))}))},n.__decorate([d.tag("l.update")],r.prototype,"update",null),n.__decorate([d.tag("l.getChanges")],r.prototype,"getChanges",null),n.__decorate([d.tag("l.CAMLQuery")],r.prototype,"getItemsByCAMLQuery",null),n.__decorate([d.tag("l.ChangesSinceToken")],r.prototype,"getListItemChangesSinceToken",null),n.__decorate([d.tag("l.recycle")],r.prototype,"recycle",null),n.__decorate([d.tag("l.renderListData")],r.prototype,"renderListData",null),n.__decorate([d.tag("l.AsStream")],r.prototype,"renderListDataAsStream",null),n.__decorate([d.tag("l.renderListFormData")],r.prototype,"renderListFormData",null),n.__decorate([d.tag("l.reserveListItemId")],r.prototype,"reserveListItemId",null),n.__decorate([d.tag("l.getListItemEntityTypeFullName")],r.prototype,"getListItemEntityTypeFullName",null),n.__decorate([d.tag("l.addValidateUpdateItemUsingPath")],r.prototype,"addValidateUpdateItemUsingPath",null),r}(a._SharePointQueryableInstance);t._List=f,t.List=a.spInvokableFactory(f),function(e){e[e.None=0]="None",e[e.ContextInfo=1]="ContextInfo",e[e.ListData=2]="ListData",e[e.ListSchema=4]="ListSchema",e[e.MenuView=8]="MenuView",e[e.ListContentType=16]="ListContentType",e[e.FileSystemItemId=32]="FileSystemItemId",e[e.ClientFormSchema=64]="ClientFormSchema",e[e.QuickLaunch=128]="QuickLaunch",e[e.Spotlight=256]="Spotlight",e[e.Visualization=512]="Visualization",e[e.ViewMetadata=1024]="ViewMetadata",e[e.DisableAutoHyperlink=2048]="DisableAutoHyperlink",e[e.EnableMediaTAUrls=4096]="EnableMediaTAUrls",e[e.ParentInfo=8192]="ParentInfo",e[e.PageContextInfo=16384]="PageContextInfo",e[e.ClientSideComponentManifest=32768]="ClientSideComponentManifest"}(t.RenderListDataOptions||(t.RenderListDataOptions={})),function(e){e[e.Display=1]="Display",e[e.Edit=2]="Edit",e[e.New=3]="New"}(t.ControlMode||(t.ControlMode={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(29),o=function(){function e(e,t){void 0===e&&(e={}),void 0===t&&(t=""),this._options=e,this._baseUrl=t}return e.prototype.configure=function(t,r){return void 0===r&&(r=""),new e(t,r)},e.prototype.setup=function(e){e.pageContext?n.setup({spfxContext:e}):n.setup(e)},e}();t.SPRest=o,t.sp=new o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(2),i=r(18),a=r(0),s=r(12);function u(e){var t=[],r=["odata.type","odata.editLink","__metadata","odata.metadata","odata.id"];if(o.hOP(e,r[0])&&"SP.Web"===e[r[0]])o.hOP(e,r[4])?t.push(e[r[4]]):o.hOP(e,r[2])&&t.push(e.__metadata.uri);else if(o.hOP(e,r[3])&&o.hOP(e,r[1])){var a=o.isUrlAbsolute(e[r[1]])?e[r[1]].split("_api")[1]:e[r[1]];t.push(s.extractWebUrl(e[r[3]]),"_api",a)}else o.hOP(e,r[1])?t.push("_api",e[r[1]]):o.hOP(e,r[2])&&t.push(e.__metadata.uri);return t.length<1?(i.Logger.write("No uri information found in ODataEntity parsing, chaining will fail for this object.",2),""):o.combine.apply(void 0,n.__spread(t))}t.odataUrlFrom=u;var c=function(e){function t(t){var r=e.call(this)||this;return r.factory=t,r.hydrate=function(e){var t=r.factory(u(e),null);return o.assign(t,e)},r}return n.__extends(t,e),t.prototype.parse=function(t){var r=this;return e.prototype.parse.call(this,t).then((function(e){var t=r.factory(u(e),null);return o.assign(t,e)}))},t}(a.ODataParser),l=function(e){function t(t){var r=e.call(this)||this;return r.factory=t,r.hydrate=function(e){return e.map((function(e){var t=r.factory(u(e),null);return o.assign(t,e)}))},r}return n.__extends(t,e),t.prototype.parse=function(t){var r=this;return e.prototype.parse.call(this,t).then((function(e){return e.map((function(e){var t=r.factory(u(e),null);return o.assign(t,e)}))}))},t}(a.ODataParser);t.spODataEntity=function(e){return new c(e)},t.spODataEntityArray=function(e){return new l(e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(3),i=r(2),a=r(13),s=r(0),u=r(18),c=r(8),l=r(6),p=r(4),d=r(5),h=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r.prototype.getById=function(e){return d.tag.configure(t.Item(this).concat("("+e+")"),"is.getById")},r.prototype.getItemByStringId=function(e){return d.tag.configure(t.Item(this.parentUrl,"getItemByStringId('"+e+"')"),"is.getItemByStringId")},r.prototype.skip=function(e,t){return void 0===t&&(t=!1),t?this.query.set("$skiptoken",encodeURIComponent("Paged=TRUE&PagedPrev=TRUE&p_ID="+e)):this.query.set("$skiptoken",encodeURIComponent("Paged=TRUE&p_ID="+e)),this},r.prototype.getPaged=function(){return this.usingParser(new b(this))()},r.prototype.getAll=function(e,r){void 0===e&&(e=2e3),void 0===r&&(r="application/json;odata=nometadata"),u.Logger.write("Calling items.getAll should be done sparingly. Ensure this is the correct choice. If you are unsure, it is not.",2);var n=t.Items(this,"").top(e).configure({headers:{Accept:r}});return this.query.forEach((function(e,t){/^\$select|filter|top|expand$/i.test(t)&&n.query.set(t,e)})),new Promise((function(e,t){var r=[],o=function(n){[].push.apply(r,n.results),n.hasNext?n.getNext().then(o).catch(t):e(r)};n.getPaged().then(o).catch(t)}))},r.prototype.add=function(e,r){return void 0===e&&(e={}),void 0===r&&(r=null),n.__awaiter(this,void 0,void 0,(function(){var o,a,u,l,d=this;return n.__generator(this,(function(n){switch(n.label){case 0:return o=this.addBatchDependency(),[4,this.ensureListItemEntityTypeName(r)];case 1:return a=n.sent(),u=s.body(i.assign(c.metadata(a),e)),l=p.spPost(this.clone(t.Items,""),u).then((function(e){return{data:e,item:d.getById(e.Id)}})),o(),[2,l]}}))}))},r.prototype.ensureListItemEntityTypeName=function(e){return e?Promise.resolve(e):this.getParent(a.List).getListItemEntityTypeFullName()},n.__decorate([d.tag("is.getPaged")],r.prototype,"getPaged",null),n.__decorate([d.tag("is.getAll")],r.prototype,"getAll",null),n.__decorate([d.tag("is.add")],r.prototype,"add",null),r=n.__decorate([l.defaultPath("items")],r)}(o._SharePointQueryableCollection);t._Items=h,t.Items=o.spInvokableFactory(h);var f=function(e){function r(){var t=null!==e&&e.apply(this,arguments)||this;return t.delete=o.deleteableWithETag("i"),t}return n.__extends(r,e),Object.defineProperty(r.prototype,"effectiveBasePermissions",{get:function(){return d.tag.configure(o.SharePointQueryable(this,"EffectiveBasePermissions"),"i.effectiveBasePermissions")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"effectiveBasePermissionsForUI",{get:function(){return d.tag.configure(o.SharePointQueryable(this,"EffectiveBasePermissionsForUI"),"i.effectiveBasePermissionsForUI")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"fieldValuesAsHTML",{get:function(){return d.tag.configure(o.SharePointQueryableInstance(this,"FieldValuesAsHTML"),"i.fvHTML")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"fieldValuesAsText",{get:function(){return d.tag.configure(o.SharePointQueryableInstance(this,"FieldValuesAsText"),"i.fvText")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"fieldValuesForEdit",{get:function(){return d.tag.configure(o.SharePointQueryableInstance(this,"FieldValuesForEdit"),"i.fvEdit")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"versions",{get:function(){return d.tag.configure(t.ItemVersions(this),"i.versions")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"list",{get:function(){return this.getParent(a.List,this.parentUrl.substr(0,this.parentUrl.lastIndexOf("/")))},enumerable:!0,configurable:!0}),r.prototype.update=function(e,r,o){return void 0===r&&(r="*"),void 0===o&&(o=null),n.__awaiter(this,void 0,void 0,(function(){var a,u,l,h;return n.__generator(this,(function(n){switch(n.label){case 0:return a=this.addBatchDependency(),[4,this.ensureListItemEntityTypeName(o)];case 1:return u=n.sent(),l=s.body(i.assign(c.metadata(u),e),s.headers({"IF-Match":r,"X-HTTP-Method":"MERGE"})),a(),h=d.tag.configure(this.clone(t.Item).usingParser(new v),"i.update"),[4,p.spPost(h,l)];case 2:return[2,{data:n.sent(),item:this}]}}))}))},r.prototype.recycle=function(){return p.spPost(this.clone(t.Item,"recycle"))},r.prototype.getWopiFrameUrl=function(e){return void 0===e&&(e=0),n.__awaiter(this,void 0,void 0,(function(){var r,o;return n.__generator(this,(function(n){switch(n.label){case 0:return(r=this.clone(t.Item,"getWOPIFrameUrl(@action)")).query.set("@action",e),[4,p.spPost(r)];case 1:return o=n.sent(),i.hOP(o,"GetWOPIFrameUrl")?[2,o.GetWOPIFrameUrl]:[2,o]}}))}))},r.prototype.validateUpdateListItem=function(e,r){return void 0===r&&(r=!1),p.spPost(this.clone(t.Item,"validateupdatelistitem"),s.body({formValues:e,bNewDocumentUpdate:r}))},r.prototype.ensureListItemEntityTypeName=function(e){return e?Promise.resolve(e):this.list.getListItemEntityTypeFullName()},n.__decorate([d.tag("i.recycle")],r.prototype,"recycle",null),n.__decorate([d.tag("i.getWopiFrameUrl")],r.prototype,"getWopiFrameUrl",null),n.__decorate([d.tag("i.validateUpdateListItem")],r.prototype,"validateUpdateListItem",null),r}(o._SharePointQueryableInstance);t._Item=f,t.Item=o.spInvokableFactory(f);var y=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r.prototype.getById=function(e){return d.tag.configure(t.ItemVersion(this).concat("("+e+")"),"iv.getById")},r=n.__decorate([l.defaultPath("versions")],r)}(o._SharePointQueryableCollection);t._ItemVersions=y,t.ItemVersions=o.spInvokableFactory(y);var g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.delete=o.deleteableWithETag("iv"),t}return n.__extends(t,e),t}(o._SharePointQueryableInstance);t._ItemVersion=g,t.ItemVersion=o.spInvokableFactory(g);var _=function(){function e(e,t,r){this.parent=e,this.nextUrl=t,this.results=r}return Object.defineProperty(e.prototype,"hasNext",{get:function(){return"string"==typeof this.nextUrl&&this.nextUrl.length>0},enumerable:!0,configurable:!0}),e.prototype.getNext=function(){return this.hasNext?d.tag.configure(t.Items(this.nextUrl,null).configureFrom(this.parent),"ip.getNext").getPaged():new Promise((function(e){return e(null)}))},e}();t.PagedItemCollection=_;var b=function(e){function t(t){var r=e.call(this)||this;return r._parent=t,r}return n.__extends(t,e),t.prototype.parse=function(e){var t=this;return new Promise((function(r,n){t.handleError(e,n)&&e.json().then((function(e){var n=i.hOP(e,"d")&&i.hOP(e.d,"__next")?e.d.__next:e["odata.nextLink"];r(new _(t._parent,n,t.parseODataJSON(e)))}))}))},t}(s.ODataParser),v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.parse=function(e){var t=this;return new Promise((function(r,n){t.handleError(e,n)&&r({"odata.etag":e.headers.get("etag")})}))},t}(s.ODataParser)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),o=r(18);t.escapeQueryStrValue=function(e){return n.stringIsNullOrEmpty(e)?"":/!(@.*?)::(.*?)/gi.test(e)?e.replace(/!(@.*?)::(.*)$/gi,(function(e,t,r){return o.Logger.write("Rewriting aliased parameter from match "+e+" to label: "+t+" value: "+r,0),"!"+t+"::"+encodeURIComponent(r.replace(/\'/gi,"''"))})):encodeURIComponent(e.replace(/\'/gi,"''"))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1);n.__exportStar(r(145),t),n.__exportStar(r(146),t)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(9),i=r(43),a=r(69),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.createBatch=function(){return new a.GraphBatch},t.prototype.setup=function(e){i.setup(e)},t}(o._GraphQueryable);t.GraphRest=s,t.graph=new s("v1.0")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(3),i=r(0),a=r(2),s=r(32),u=r(15),c=r(6),l=r(4),p=r(17),d=r(12),h=r(5),f=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r.prototype.getByName=function(e){if(/\%#/.test(e))throw Error("For file names containing % or # please use web.getFileByServerRelativePath");return h.tag.configure(t.File(this).concat("('"+p.escapeQueryStrValue(e)+"')"),"fis.getByName")},r.prototype.add=function(e,r,o){return void 0===o&&(o=!0),n.__awaiter(this,void 0,void 0,(function(){return n.__generator(this,(function(n){switch(n.label){case 0:return[4,l.spPost(t.Files(this,"add(overwrite="+o+",url='"+p.escapeQueryStrValue(e)+"')"),{body:r})];case 1:return[2,{data:n.sent(),file:this.getByName(e)}]}}))}))},r.prototype.addUsingPath=function(e,r,o){return void 0===o&&(o={Overwrite:!1}),n.__awaiter(this,void 0,void 0,(function(){var i,s;return n.__generator(this,(function(n){switch(n.label){case 0:return i=["AddUsingPath(decodedurl='"+p.escapeQueryStrValue(e)+"'"],o&&(o.Overwrite&&i.push(",Overwrite=true"),o.AutoCheckoutOnInvalidData&&i.push(",AutoCheckoutOnInvalidData=true"),a.stringIsNullOrEmpty(o.XorHash)||i.push(",XorHash="+p.escapeQueryStrValue(o.XorHash))),i.push(")"),[4,l.spPost(t.Files(this,i.join("")),{body:r})];case 1:return[2,{data:s=n.sent(),file:t.File(u.odataUrlFrom(s))}]}}))}))},r.prototype.addChunked=function(e,r,o,i,a){return void 0===i&&(i=!0),void 0===a&&(a=10485760),n.__awaiter(this,void 0,void 0,(function(){return n.__generator(this,(function(n){switch(n.label){case 0:return[4,l.spPost(this.clone(t.Files,"add(overwrite="+i+",url='"+p.escapeQueryStrValue(e)+"')",!1))];case 1:return n.sent(),[4,this.getByName(e).setContentChunked(r,o,a)];case 2:return[2,n.sent()]}}))}))},r.prototype.addTemplateFile=function(e,r){return n.__awaiter(this,void 0,void 0,(function(){var o;return n.__generator(this,(function(n){switch(n.label){case 0:return[4,l.spPost(this.clone(t.Files,"addTemplateFile(urloffile='"+p.escapeQueryStrValue(e)+"',templatefiletype="+r+")",!1))];case 1:return[2,{data:o=n.sent(),file:t.File(u.odataUrlFrom(o))}]}}))}))},n.__decorate([h.tag("fis.add")],r.prototype,"add",null),n.__decorate([h.tag("fis.addUsingPath")],r.prototype,"addUsingPath",null),n.__decorate([h.tag("fis.addChunked")],r.prototype,"addChunked",null),n.__decorate([h.tag("fis.addTemplateFile")],r.prototype,"addTemplateFile",null),r=n.__decorate([c.defaultPath("files")],r)}(o._SharePointQueryableCollection);t._Files=f,t.Files=o.spInvokableFactory(f);var y=function(e){function r(){var t=null!==e&&e.apply(this,arguments)||this;return t.delete=o.deleteableWithETag("fi"),t}return n.__extends(r,e),Object.defineProperty(r.prototype,"listItemAllFields",{get:function(){return h.tag.configure(o.SharePointQueryableInstance(this,"listItemAllFields"),"fi.listItemAllFields")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"versions",{get:function(){return h.tag.configure(t.Versions(this),"fi.versions")},enumerable:!0,configurable:!0}),r.prototype.approve=function(e){return void 0===e&&(e=""),l.spPost(this.clone(t.File,"approve(comment='"+p.escapeQueryStrValue(e)+"')"))},r.prototype.cancelUpload=function(e){return l.spPost(this.clone(t.File,"cancelUpload(uploadId=guid'"+e+"')",!1))},r.prototype.checkin=function(e,r){if(void 0===e&&(e=""),void 0===r&&(r=_.Major),e.length>1023)throw Error("The maximum comment length is 1023 characters.");return l.spPost(this.clone(t.File,"checkin(comment='"+p.escapeQueryStrValue(e)+"',checkintype="+r+")"))},r.prototype.checkout=function(){return l.spPost(this.clone(t.File,"checkout"))},r.prototype.copyTo=function(e,r){return void 0===r&&(r=!0),l.spPost(this.clone(t.File,"copyTo(strnewurl='"+p.escapeQueryStrValue(e)+"',boverwrite="+r+")"))},r.prototype.copyByPath=function(e,r,o){return void 0===o&&(o=!1),n.__awaiter(this,void 0,void 0,(function(){var s,u,c,p,h;return n.__generator(this,(function(n){switch(n.label){case 0:return[4,this.select("ServerRelativeUrl")()];case 1:return s=n.sent(),u=s.ServerRelativeUrl,c=s["odata.id"],p=d.extractWebUrl(c),h=p.replace("://","___").split("/")[0].replace("___","://"),[4,l.spPost(t.File(p,"/_api/SP.MoveCopyUtil.CopyFileByPath(overwrite=@a1)?@a1="+r),i.body({destPath:{DecodedUrl:a.isUrlAbsolute(e)?e:""+h+e,__metadata:{type:"SP.ResourcePath"}},options:{KeepBoth:o,ResetAuthorAndCreatedOnCopy:!0,ShouldBypassSharedLocks:!0,__metadata:{type:"SP.MoveCopyOptions"}},srcPath:{DecodedUrl:""+h+u,__metadata:{type:"SP.ResourcePath"}}}))];case 2:return n.sent(),[2]}}))}))},r.prototype.deny=function(e){if(void 0===e&&(e=""),e.length>1023)throw Error("The maximum comment length is 1023 characters.");return l.spPost(this.clone(t.File,"deny(comment='"+p.escapeQueryStrValue(e)+"')"))},r.prototype.moveTo=function(e,r){return void 0===r&&(r=b.Overwrite),l.spPost(this.clone(t.File,"moveTo(newurl='"+p.escapeQueryStrValue(e)+"',flags="+r+")"))},r.prototype.moveByPath=function(e,r,o){return void 0===o&&(o=!1),n.__awaiter(this,void 0,void 0,(function(){var s,u,c,p,h;return n.__generator(this,(function(n){switch(n.label){case 0:return[4,this.select("ServerRelativeUrl")()];case 1:return s=n.sent(),u=s.ServerRelativeUrl,c=s["odata.id"],p=d.extractWebUrl(c),h=p.replace("://","___").split("/")[0].replace("___","://"),[4,l.spPost(t.File(p,"/_api/SP.MoveCopyUtil.MoveFileByPath(overwrite=@a1)?@a1="+r),i.body({destPath:{DecodedUrl:a.isUrlAbsolute(e)?e:""+h+e,__metadata:{type:"SP.ResourcePath"}},options:{KeepBoth:o,ResetAuthorAndCreatedOnCopy:!1,ShouldBypassSharedLocks:!0,__metadata:{type:"SP.MoveCopyOptions"}},srcPath:{DecodedUrl:""+h+u,__metadata:{type:"SP.ResourcePath"}}}))];case 2:return n.sent(),[2]}}))}))},r.prototype.publish=function(e){if(void 0===e&&(e=""),e.length>1023)throw Error("The maximum comment length is 1023 characters.");return l.spPost(this.clone(t.File,"publish(comment='"+p.escapeQueryStrValue(e)+"')"))},r.prototype.recycle=function(){return l.spPost(this.clone(t.File,"recycle"))},r.prototype.undoCheckout=function(){return l.spPost(this.clone(t.File,"undoCheckout"))},r.prototype.unpublish=function(e){if(void 0===e&&(e=""),e.length>1023)throw Error("The maximum comment length is 1023 characters.");return l.spPost(this.clone(t.File,"unpublish(comment='"+p.escapeQueryStrValue(e)+"')"))},r.prototype.getText=function(){return this.clone(t.File,"$value",!1).usingParser(new i.TextParser)(i.headers({binaryStringResponseBody:"true"}))},r.prototype.getBlob=function(){return this.clone(t.File,"$value",!1).usingParser(new i.BlobParser)(i.headers({binaryStringResponseBody:"true"}))},r.prototype.getBuffer=function(){return this.clone(t.File,"$value",!1).usingParser(new i.BufferParser)(i.headers({binaryStringResponseBody:"true"}))},r.prototype.getJSON=function(){return this.clone(t.File,"$value",!1).usingParser(new i.JSONParser)(i.headers({binaryStringResponseBody:"true"}))},r.prototype.setContent=function(e){return n.__awaiter(this,void 0,void 0,(function(){return n.__generator(this,(function(r){switch(r.label){case 0:return[4,l.spPost(this.clone(t.File,"$value",!1),{body:e,headers:{"X-HTTP-Method":"PUT"}})];case 1:return r.sent(),[2,t.File(this)]}}))}))},r.prototype.getItem=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.__awaiter(this,void 0,void 0,(function(){var t,r;return n.__generator(this,(function(n){switch(n.label){case 0:return[4,(t=this.listItemAllFields).select.apply(t,e)()];case 1:return r=n.sent(),[2,a.assign(s.Item(u.odataUrlFrom(r)),r)]}}))}))},r.prototype.setContentChunked=function(e,t,r){return void 0===r&&(r=10485760),n.__awaiter(this,void 0,void 0,(function(){var o,i,s,u,c;return n.__generator(this,(function(n){switch(n.label){case 0:return a.isFunc(t)||(t=function(){return null}),o=e.size,i=parseInt((o/r).toString(),10)+(o%r==0?1:0),s=a.getGUID(),t({uploadId:s,blockNumber:1,chunkSize:r,currentPointer:0,fileSize:o,stage:"starting",totalBlocks:i}),[4,this.startUpload(s,e.slice(0,r))];case 1:u=n.sent(),c=2,n.label=2;case 2:return c<i?(t({uploadId:s,blockNumber:c,chunkSize:r,currentPointer:u,fileSize:o,stage:"continue",totalBlocks:i}),[4,this.continueUpload(s,u,e.slice(u,u+r))]):[3,5];case 3:u=n.sent(),n.label=4;case 4:return c++,[3,2];case 5:return t({uploadId:s,blockNumber:i,chunkSize:r,currentPointer:u,fileSize:o,stage:"finishing",totalBlocks:i}),[2,this.finishUpload(s,u,e.slice(u))]}}))}))},r.prototype.startUpload=function(e,r){return n.__awaiter(this,void 0,void 0,(function(){var o;return n.__generator(this,(function(n){switch(n.label){case 0:return[4,l.spPost(this.clone(t.File,"startUpload(uploadId=guid'"+e+"')",!1),{body:r})];case 1:return"object"==typeof(o=n.sent())&&(o=o.StartUpload),[2,parseFloat(o)]}}))}))},r.prototype.continueUpload=function(e,r,o){return n.__awaiter(this,void 0,void 0,(function(){var i;return n.__generator(this,(function(n){switch(n.label){case 0:return[4,l.spPost(this.clone(t.File,"continueUpload(uploadId=guid'"+e+"',fileOffset="+r+")",!1),{body:o})];case 1:return"object"==typeof(i=n.sent())&&(i=i.ContinueUpload),[2,parseFloat(i)]}}))}))},r.prototype.finishUpload=function(e,r,o){return n.__awaiter(this,void 0,void 0,(function(){var i;return n.__generator(this,(function(n){switch(n.label){case 0:return[4,l.spPost(this.clone(t.File,"finishUpload(uploadId=guid'"+e+"',fileOffset="+r+")",!1),{body:o})];case 1:return[2,{data:i=n.sent(),file:t.File(u.odataUrlFrom(i))}]}}))}))},n.__decorate([h.tag("fi.approve")],r.prototype,"approve",null),n.__decorate([h.tag("fi.cancelUpload")],r.prototype,"cancelUpload",null),n.__decorate([h.tag("fi.checkin")],r.prototype,"checkin",null),n.__decorate([h.tag("fi.checkout")],r.prototype,"checkout",null),n.__decorate([h.tag("fi.copyTo")],r.prototype,"copyTo",null),n.__decorate([h.tag("fi.copyByPath")],r.prototype,"copyByPath",null),n.__decorate([h.tag("fi.deny")],r.prototype,"deny",null),n.__decorate([h.tag("fi.moveTo")],r.prototype,"moveTo",null),n.__decorate([h.tag("fi.moveByPath")],r.prototype,"moveByPath",null),n.__decorate([h.tag("fi.publish")],r.prototype,"publish",null),n.__decorate([h.tag("fi.recycle")],r.prototype,"recycle",null),n.__decorate([h.tag("fi.undoCheckout")],r.prototype,"undoCheckout",null),n.__decorate([h.tag("fi.unpublish")],r.prototype,"unpublish",null),n.__decorate([h.tag("fi.getText")],r.prototype,"getText",null),n.__decorate([h.tag("fi.getBlob")],r.prototype,"getBlob",null),n.__decorate([h.tag("fi.getBuffer")],r.prototype,"getBuffer",null),n.__decorate([h.tag("fi.getJSON")],r.prototype,"getJSON",null),n.__decorate([h.tag("fi.setContent")],r.prototype,"setContent",null),n.__decorate([h.tag("fi.getItem")],r.prototype,"getItem",null),n.__decorate([h.tag("fi.startUpload")],r.prototype,"startUpload",null),n.__decorate([h.tag("fi.continueUpload")],r.prototype,"continueUpload",null),n.__decorate([h.tag("fi.finishUpload")],r.prototype,"finishUpload",null),r}(o._SharePointQueryableInstance);t._File=y,t.File=o.spInvokableFactory(y);var g=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r.prototype.getById=function(e){return h.tag.configure(t.Version(this).concat("("+e+")"),"vers.getById")},r.prototype.deleteAll=function(){return l.spPost(t.Versions(this,"deleteAll"))},r.prototype.deleteById=function(e){return l.spPost(this.clone(t.Versions,"deleteById(vid="+e+")"))},r.prototype.recycleByID=function(e){return l.spPost(this.clone(t.Versions,"recycleByID(vid="+e+")"))},r.prototype.deleteByLabel=function(e){return l.spPost(this.clone(t.Versions,"deleteByLabel(versionlabel='"+p.escapeQueryStrValue(e)+"')"))},r.prototype.recycleByLabel=function(e){return l.spPost(this.clone(t.Versions,"recycleByLabel(versionlabel='"+p.escapeQueryStrValue(e)+"')"))},r.prototype.restoreByLabel=function(e){return l.spPost(this.clone(t.Versions,"restoreByLabel(versionlabel='"+p.escapeQueryStrValue(e)+"')"))},n.__decorate([h.tag("vers.deleteAll")],r.prototype,"deleteAll",null),n.__decorate([h.tag("vers.deleteById")],r.prototype,"deleteById",null),n.__decorate([h.tag("vers.recycleByID")],r.prototype,"recycleByID",null),n.__decorate([h.tag("vers.deleteByLabel")],r.prototype,"deleteByLabel",null),n.__decorate([h.tag("vers.recycleByLabel")],r.prototype,"recycleByLabel",null),n.__decorate([h.tag("vers.restoreByLabel")],r.prototype,"restoreByLabel",null),r=n.__decorate([c.defaultPath("versions")],r)}(o._SharePointQueryableCollection);t._Versions=g,t.Versions=o.spInvokableFactory(g);var _,b,v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.delete=o.deleteableWithETag("ver"),t}return n.__extends(t,e),t}(o._SharePointQueryableInstance);t._Version=v,t.Version=o.spInvokableFactory(v),function(e){e[e.Minor=0]="Minor",e[e.Major=1]="Major",e[e.Overwrite=2]="Overwrite"}(_=t.CheckinType||(t.CheckinType={})),function(e){e[e.Overwrite=1]="Overwrite",e[e.AllowBrokenThickets=8]="AllowBrokenThickets"}(b=t.MoveOperations||(t.MoveOperations={})),function(e){e[e.StandardPage=0]="StandardPage",e[e.WikiPage=1]="WikiPage",e[e.FormPage=2]="FormPage",e[e.ClientSidePage=3]="ClientSidePage"}(t.TemplateFileType||(t.TemplateFileType={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=r(1),i=r(2),a=r(0),s=r(9),u=r(11),c=r(10),l=r(37);!function(e){e[e.Office365=0]="Office365",e[e.Dynamic=1]="Dynamic",e[e.Security=2]="Security"}(n=t.GroupType||(t.GroupType={}));var p=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(r,e),r.prototype.addFavorite=function(){return c.graphPost(this.clone(t.Group,"addFavorite"))},r.prototype.removeFavorite=function(){return c.graphPost(this.clone(t.Group,"removeFavorite"))},r.prototype.resetUnseenCount=function(){return c.graphPost(this.clone(t.Group,"resetUnseenCount"))},r.prototype.subscribeByMail=function(){return c.graphPost(this.clone(t.Group,"subscribeByMail"))},r.prototype.unsubscribeByMail=function(){return c.graphPost(this.clone(t.Group,"unsubscribeByMail"))},r.prototype.getCalendarView=function(e,r){var n=this.clone(t.Group,"calendarView");return n.query.set("startDateTime",e.toISOString()),n.query.set("endDateTime",r.toISOString()),n()},r=o.__decorate([u.deleteable(),u.updateable()],r)}(l._DirectoryObject);t._Group=p,t.Group=s.graphInvokableFactory(p);var d=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(r,e),r.prototype.add=function(e,t,r,s){return void 0===s&&(s={}),o.__awaiter(this,void 0,void 0,(function(){var u,l;return o.__generator(this,(function(o){switch(o.label){case 0:return u=i.assign({displayName:e,mailEnabled:r===n.Office365,mailNickname:t,securityEnabled:r!==n.Office365},s),r!==n.Security&&(u=i.assign(u,{groupTypes:r===n.Office365?["Unified"]:["DynamicMembership"]})),[4,c.graphPost(this,a.body(u))];case 1:return[2,{data:l=o.sent(),group:this.getById(l.id)}]}}))}))},r=o.__decorate([u.defaultPath("groups"),u.getById(t.Group)],r)}(s._GraphQueryableCollection);t._Groups=d,t.Groups=s.graphInvokableFactory(d)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(9),i=r(37),a=r(11),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),Object.defineProperty(t.prototype,"memberOf",{get:function(){return i.DirectoryObjects(this,"memberOf")},enumerable:!0,configurable:!0}),t=n.__decorate([a.updateable(),a.deleteable()],t)}(i._DirectoryObject);t._User=s,t.User=o.graphInvokableFactory(s);var u=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r=n.__decorate([a.defaultPath("users"),a.getById(t.User)],r)}(o._GraphQueryableCollection);t._Users=u,t.Users=o.graphInvokableFactory(u)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(3),i=r(6),a=r(7),s=r(2),u=r(28),c=r(0),l=r(15),p=r(4),d=r(41),h=r(17),f=r(5),y=r(8),g=r(12),_=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),Object.defineProperty(r.prototype,"rootWeb",{get:function(){return f.tag.configure(a.Web(this,"rootweb"),"si.rootWeb")},enumerable:!0,configurable:!0}),r.prototype.getRootWeb=function(){return n.__awaiter(this,void 0,void 0,(function(){var e;return n.__generator(this,(function(t){switch(t.label){case 0:return[4,this.rootWeb.select("Url")()];case 1:return e=t.sent(),[2,f.tag.configure(a.Web(e.Url),"si.getRootWeb")]}}))}))},r.prototype.getContextInfo=function(){return n.__awaiter(this,void 0,void 0,(function(){var e,r,o;return n.__generator(this,(function(n){switch(n.label){case 0:return e=f.tag.configure(t.Site(this.parentUrl,"_api/contextinfo"),"si.getContextInfo"),[4,p.spPost(e)];case 1:return r=n.sent(),s.hOP(r,"GetContextWebInformation")?((o=r.GetContextWebInformation).SupportedSchemaVersions=o.SupportedSchemaVersions.results,[2,o]):[2,r]}}))}))},r.prototype.createBatch=function(){return new d.SPBatch(this.parentUrl)},r.prototype.delete=function(){return n.__awaiter(this,void 0,void 0,(function(){var e,r;return n.__generator(this,(function(n){switch(n.label){case 0:return[4,this.clone(t.Site,"").select("Id")()];case 1:return e=n.sent(),r=f.tag.configure(t.Site(this.parentUrl,"_api/SPSiteManager/Delete"),"si.delete"),[4,p.spPost(r,c.body({siteId:e.Id}))];case 2:return n.sent(),[2]}}))}))},r.prototype.getDocumentLibraries=function(e){return n.__awaiter(this,void 0,void 0,(function(){var t,r;return n.__generator(this,(function(n){switch(n.label){case 0:return(t=f.tag.configure(o.SharePointQueryable("","_api/sp.web.getdocumentlibraries(@v)"),"si.getDocumentLibraries")).query.set("@v","'"+h.escapeQueryStrValue(e)+"'"),[4,t()];case 1:return r=n.sent(),[2,s.hOP(r,"GetDocumentLibraries")?r.GetDocumentLibraries:r]}}))}))},r.prototype.getWebUrlFromPageUrl=function(e){return n.__awaiter(this,void 0,void 0,(function(){var t,r;return n.__generator(this,(function(n){switch(n.label){case 0:return(t=f.tag.configure(o.SharePointQueryable("","_api/sp.web.getweburlfrompageurl(@v)"),"si.getWebUrlFromPageUrl")).query.set("@v","'"+h.escapeQueryStrValue(e)+"'"),[4,t()];case 1:return r=n.sent(),[2,s.hOP(r,"GetWebUrlFromPageUrl")?r.GetWebUrlFromPageUrl:r]}}))}))},r.prototype.getChanges=function(e){var t=c.body({query:s.assign(y.metadata("SP.ChangeQuery"),e)});return p.spPost(this.clone(a.Web,"getchanges"),t)},r.prototype.openWebById=function(e){return n.__awaiter(this,void 0,void 0,(function(){var r;return n.__generator(this,(function(n){switch(n.label){case 0:return[4,p.spPost(this.clone(t.Site,"openWebById('"+e+"')"))];case 1:return[2,{data:r=n.sent(),web:a.Web(g.extractWebUrl(l.odataUrlFrom(r)))}]}}))}))},r.prototype.createCommunicationSite=function(e,t,r,o,i,a,l,p,d){return void 0===t&&(t=1033),void 0===r&&(r=!1),void 0===i&&(i=""),void 0===a&&(a=""),void 0===l&&(l="00000000-0000-0000-0000-000000000000"),void 0===p&&(p="00000000-0000-0000-0000-000000000000"),n.__awaiter(this,void 0,void 0,(function(){var h,f,g,_,b;return n.__generator(this,(function(n){switch(n.label){case 0:return h={Classification:a,Description:i,HubSiteId:p,Lcid:t,Owner:d,ShareByEmailEnabled:r,SiteDesignId:l,Title:e,Url:o,WebTemplate:"SITEPAGEPUBLISHING#0",WebTemplateExtensionId:"00000000-0000-0000-0000-000000000000"},f=c.body({request:s.assign(y.metadata("Microsoft.SharePoint.Portal.SPSiteCreationRequest"),h)},c.headers({Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose;charset=utf-8"})),[4,this.getRootWeb()];case 1:return g=n.sent(),_=new u.SPHttpClient,b=g.parentUrl+"/_api/SPSiteManager/Create",[4,_.post(b,f)];case 2:return[4,n.sent().json()];case 3:return[2,n.sent()]}}))}))},r.prototype.createModernTeamSite=function(e,t,r,o,i,a,c,l,p){return void 0===r&&(r=!0),void 0===o&&(o=1033),void 0===i&&(i=""),void 0===a&&(a=""),void 0===l&&(l="00000000-0000-0000-0000-000000000000"),n.__awaiter(this,void 0,void 0,(function(){var d,h,f,y;return n.__generator(this,(function(n){switch(n.label){case 0:return d={alias:t,displayName:e,isPublic:r,optionalParams:{Classification:a,CreationOptions:{results:["SPSiteLanguage:"+o,"HubSiteId:"+l]},Description:i,Owners:{results:c||[]}}},p&&d.optionalParams.CreationOptions.results.push("implicit_formula_292aa8a00786498a87a5ca52d9f4214a_"+p),[4,this.getRootWeb()];case 1:return h=n.sent(),f=new u.SPHttpClient,y=h.parentUrl+"/_api/GroupSiteManager/CreateGroupEx",[4,f.post(y,{body:s.jsS(d),headers:{Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose;charset=utf-8"}})];case 2:return[4,n.sent().json()];case 3:return[2,n.sent()]}}))}))},n.__decorate([f.tag("si.getChanges")],r.prototype,"getChanges",null),n.__decorate([f.tag("si.openWebById")],r.prototype,"openWebById",null),r=n.__decorate([i.defaultPath("_api/site")],r)}(o._SharePointQueryableInstance);t._Site=_,t.Site=o.spInvokableFactory(_)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(2),i=r(3),a=r(15),s=r(16),u=r(0),c=r(6),l=r(4),p=r(17),d=r(12),h=r(5),f=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r.prototype.getByName=function(e){return h.tag.configure(t.Folder(this).concat("('"+p.escapeQueryStrValue(e)+"')"),"fs.getByName")},r.prototype.add=function(e){return n.__awaiter(this,void 0,void 0,(function(){return n.__generator(this,(function(r){switch(r.label){case 0:return[4,l.spPost(this.clone(t.Folders,"add('"+p.escapeQueryStrValue(e)+"')"))];case 1:return[2,{data:r.sent(),folder:this.getByName(e)}]}}))}))},r.prototype.addUsingPath=function(e,r){return void 0===r&&(r=!1),n.__awaiter(this,void 0,void 0,(function(){return n.__generator(this,(function(n){switch(n.label){case 0:return[4,l.spPost(this.clone(t.Folders,"addUsingPath(DecodedUrl='"+p.escapeQueryStrValue(e)+"',overwrite="+r+")"))];case 1:return[2,{data:n.sent(),folder:t.Folder(d.extractWebUrl(this.toUrl()),"_api/web/getFolderByServerRelativePath(decodedUrl='"+p.escapeQueryStrValue(e)+"')")}]}}))}))},n.__decorate([h.tag("fs.add")],r.prototype,"add",null),n.__decorate([h.tag("fs.addUsingPath")],r.prototype,"addUsingPath",null),r=n.__decorate([c.defaultPath("folders")],r)}(i._SharePointQueryableCollection);t._Folders=f,t.Folders=i.spInvokableFactory(f);var y=function(e){function r(){var t=null!==e&&e.apply(this,arguments)||this;return t.delete=i.deleteableWithETag("f"),t.update=t._update("SP.Folder",(function(e){return{data:e,folder:t}})),t}return n.__extends(r,e),Object.defineProperty(r.prototype,"contentTypeOrder",{get:function(){return h.tag.configure(i.SharePointQueryableCollection(this,"contentTypeOrder"),"f.contentTypeOrder")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"folders",{get:function(){return t.Folders(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"listItemAllFields",{get:function(){return h.tag.configure(i.SharePointQueryableInstance(this,"listItemAllFields"),"f.listItemAllFields")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"parentFolder",{get:function(){return h.tag.configure(t.Folder(this,"parentFolder"),"f.parentFolder")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"properties",{get:function(){return h.tag.configure(i.SharePointQueryableInstance(this,"properties"),"f.properties")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"serverRelativeUrl",{get:function(){return h.tag.configure(i.SharePointQueryable(this,"serverRelativeUrl"),"f.serverRelativeUrl")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"uniqueContentTypeOrder",{get:function(){return h.tag.configure(i.SharePointQueryableCollection(this,"uniqueContentTypeOrder"),"f.uniqueContentTypeOrder")},enumerable:!0,configurable:!0}),r.prototype.recycle=function(){return l.spPost(this.clone(t.Folder,"recycle"))},r.prototype.getItem=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.__awaiter(this,void 0,void 0,(function(){var t,r;return n.__generator(this,(function(n){switch(n.label){case 0:return[4,(t=this.listItemAllFields).select.apply(t,e)()];case 1:return r=n.sent(),[2,o.assign(s.Item(a.odataUrlFrom(r)),r)]}}))}))},r.prototype.moveTo=function(e){return n.__awaiter(this,void 0,void 0,(function(){var r,i,a,s,c;return n.__generator(this,(function(n){switch(n.label){case 0:return[4,this.select("ServerRelativeUrl")()];case 1:return r=n.sent(),i=r.ServerRelativeUrl,a=r["odata.id"],s=d.extractWebUrl(a),c=s.replace("://","___").split("/")[0].replace("___","://"),[4,l.spPost(t.Folder(s,"/_api/SP.MoveCopyUtil.MoveFolder()"),u.body({destUrl:o.isUrlAbsolute(e)?e:""+c+e,srcUrl:""+c+i}))];case 2:return n.sent(),[2]}}))}))},r.prototype.moveByPath=function(e,r){return void 0===r&&(r=!1),n.__awaiter(this,void 0,void 0,(function(){var i,a,s,c,p;return n.__generator(this,(function(n){switch(n.label){case 0:return[4,this.select("ServerRelativeUrl")()];case 1:return i=n.sent(),a=i.ServerRelativeUrl,s=i["odata.id"],c=d.extractWebUrl(s),p=c.replace("://","___").split("/")[0].replace("___","://"),[4,l.spPost(t.Folder(c,"/_api/SP.MoveCopyUtil.MoveFolderByPath()"),u.body({destPath:{DecodedUrl:o.isUrlAbsolute(e)?e:""+p+e,__metadata:{type:"SP.ResourcePath"}},options:{KeepBoth:r,ResetAuthorAndCreatedOnCopy:!0,ShouldBypassSharedLocks:!0,__metadata:{type:"SP.MoveCopyOptions"}},srcPath:{DecodedUrl:""+p+a,__metadata:{type:"SP.ResourcePath"}}}))];case 2:return n.sent(),[2]}}))}))},r.prototype.copyTo=function(e){return n.__awaiter(this,void 0,void 0,(function(){var r,i,a,s,c;return n.__generator(this,(function(n){switch(n.label){case 0:return[4,this.select("ServerRelativeUrl")()];case 1:return r=n.sent(),i=r.ServerRelativeUrl,a=r["odata.id"],s=d.extractWebUrl(a),c=s.replace("://","___").split("/")[0].replace("___","://"),[4,l.spPost(t.Folder(s,"/_api/SP.MoveCopyUtil.CopyFolder()"),u.body({destUrl:o.isUrlAbsolute(e)?e:""+c+e,srcUrl:""+c+i}))];case 2:return n.sent(),[2]}}))}))},r.prototype.copyByPath=function(e,r){return void 0===r&&(r=!1),n.__awaiter(this,void 0,void 0,(function(){var i,a,s,c,p;return n.__generator(this,(function(n){switch(n.label){case 0:return[4,this.select("ServerRelativeUrl")()];case 1:return i=n.sent(),a=i.ServerRelativeUrl,s=i["odata.id"],c=d.extractWebUrl(s),p=c.replace("://","___").split("/")[0].replace("___","://"),[4,l.spPost(t.Folder(c,"/_api/SP.MoveCopyUtil.CopyFolderByPath()"),u.body({destPath:{DecodedUrl:o.isUrlAbsolute(e)?e:""+p+e,__metadata:{type:"SP.ResourcePath"}},options:{KeepBoth:r,ResetAuthorAndCreatedOnCopy:!0,ShouldBypassSharedLocks:!0,__metadata:{type:"SP.MoveCopyOptions"}},srcPath:{DecodedUrl:""+p+a,__metadata:{type:"SP.ResourcePath"}}}))];case 2:return n.sent(),[2]}}))}))},r.prototype.getShareable=function(){return n.__awaiter(this,void 0,void 0,(function(){var e,t;return n.__generator(this,(function(r){switch(r.label){case 0:return[4,this.clone(i.SharePointQueryableInstance,"listItemAllFields",!1).select("odata.id")()];case 1:return e=r.sent(),t=s.Item(a.odataUrlFrom(e)),this.hasBatch&&(t=t.inBatch(this.batch)),[2,t]}}))}))},n.__decorate([h.tag("f.recycle")],r.prototype,"recycle",null),n.__decorate([h.tag("f.getItem")],r.prototype,"getItem",null),n.__decorate([h.tag("f.moveTo")],r.prototype,"moveTo",null),n.__decorate([h.tag("f.moveByPath")],r.prototype,"moveByPath",null),n.__decorate([h.tag("f.copyTo")],r.prototype,"copyTo",null),n.__decorate([h.tag("f.copyByPath")],r.prototype,"copyByPath",null),n.__decorate([h.tag("f.getShareable")],r.prototype,"getShareable",null),r}(i._SharePointQueryableInstance);t._Folder=y,t.Folder=i.spInvokableFactory(y)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(2),i=r(0),a=r(3),s=r(34),u=r(8),c=r(6),l=r(4),p=r(5),d=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r.prototype.getById=function(e){return t.RoleAssignment(this).concat("("+e+")")},r.prototype.add=function(e,r){return n.__awaiter(this,void 0,void 0,(function(){return n.__generator(this,(function(n){switch(n.label){case 0:return[4,l.spPost(this.clone(t.RoleAssignments,"addroleassignment(principalid="+e+", roledefid="+r+")"))];case 1:return n.sent(),[2]}}))}))},r.prototype.remove=function(e,r){return n.__awaiter(this,void 0,void 0,(function(){return n.__generator(this,(function(n){switch(n.label){case 0:return[4,l.spPost(this.clone(t.RoleAssignments,"removeroleassignment(principalid="+e+", roledefid="+r+")"))];case 1:return n.sent(),[2]}}))}))},r=n.__decorate([c.defaultPath("roleassignments")],r)}(a._SharePointQueryableCollection);t._RoleAssignments=d,t.RoleAssignments=a.spInvokableFactory(d);var h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.delete=a.deleteable("ra"),t}return n.__extends(t,e),Object.defineProperty(t.prototype,"groups",{get:function(){return p.tag.configure(s.SiteGroups(this,"groups"),"ra.groups")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bindings",{get:function(){return a.SharePointQueryableCollection(this,"roledefinitionbindings")},enumerable:!0,configurable:!0}),t}(a._SharePointQueryableInstance);t._RoleAssignment=h,t.RoleAssignment=a.spInvokableFactory(h);var f=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r.prototype.getById=function(e){return t.RoleDefinition(this,"getById("+e+")")},r.prototype.getByName=function(e){return t.RoleDefinition(this,"getbyname('"+e+"')")},r.prototype.getByType=function(e){return t.RoleDefinition(this,"getbytype("+e+")")},r.prototype.add=function(e,t,r,a){return n.__awaiter(this,void 0,void 0,(function(){var s,c;return n.__generator(this,(function(n){switch(n.label){case 0:return s=i.body({BasePermissions:o.assign(u.metadata("SP.BasePermissions"),a),Description:t,Name:e,Order:r,__metadata:{type:"SP.RoleDefinition"}}),[4,l.spPost(this,s)];case 1:return[2,{data:c=n.sent(),definition:this.getById(c.Id)}]}}))}))},r=n.__decorate([c.defaultPath("roledefinitions")],r)}(a._SharePointQueryableCollection);t._RoleDefinitions=f,t.RoleDefinitions=a.spInvokableFactory(f);var y=function(e){function r(){var t=null!==e&&e.apply(this,arguments)||this;return t.delete=a.deleteable("rd"),t}return n.__extends(r,e),r.prototype.update=function(e){return n.__awaiter(this,void 0,void 0,(function(){var r,a,s,c,p;return n.__generator(this,(function(n){switch(n.label){case 0:return r=["BasePermissions"],void 0!==o.hOP(e,r[0])&&(e[r[0]]=o.assign(u.metadata("SP."+r[0]),e[r[0]])),a=i.body(o.assign(u.metadata("SP.RoleDefinition"),e),i.headers({"X-HTTP-Method":"MERGE"})),[4,l.spPost(this,a)];case 1:return s=n.sent(),c=this,o.hOP(e,"Name")&&(p=this.getParent(t.RoleDefinitions,this.parentUrl,""),c=p.getByName(e.Name)),[2,{data:s,definition:c}]}}))}))},r}(a._SharePointQueryableInstance);t._RoleDefinition=y,t.RoleDefinition=a.spInvokableFactory(y),function(e){e[e.EmptyMask=0]="EmptyMask",e[e.ViewListItems=1]="ViewListItems",e[e.AddListItems=2]="AddListItems",e[e.EditListItems=3]="EditListItems",e[e.DeleteListItems=4]="DeleteListItems",e[e.ApproveItems=5]="ApproveItems",e[e.OpenItems=6]="OpenItems",e[e.ViewVersions=7]="ViewVersions",e[e.DeleteVersions=8]="DeleteVersions",e[e.CancelCheckout=9]="CancelCheckout",e[e.ManagePersonalViews=10]="ManagePersonalViews",e[e.ManageLists=12]="ManageLists",e[e.ViewFormPages=13]="ViewFormPages",e[e.AnonymousSearchAccessList=14]="AnonymousSearchAccessList",e[e.Open=17]="Open",e[e.ViewPages=18]="ViewPages",e[e.AddAndCustomizePages=19]="AddAndCustomizePages",e[e.ApplyThemeAndBorder=20]="ApplyThemeAndBorder",e[e.ApplyStyleSheets=21]="ApplyStyleSheets",e[e.ViewUsageData=22]="ViewUsageData",e[e.CreateSSCSite=23]="CreateSSCSite",e[e.ManageSubwebs=24]="ManageSubwebs",e[e.CreateGroups=25]="CreateGroups",e[e.ManagePermissions=26]="ManagePermissions",e[e.BrowseDirectories=27]="BrowseDirectories",e[e.BrowseUserInfo=28]="BrowseUserInfo",e[e.AddDelPrivateWebParts=29]="AddDelPrivateWebParts",e[e.UpdatePersonalWebParts=30]="UpdatePersonalWebParts",e[e.ManageWeb=31]="ManageWeb",e[e.AnonymousSearchAccessWebLists=32]="AnonymousSearchAccessWebLists",e[e.UseClientIntegration=37]="UseClientIntegration",e[e.UseRemoteAPIs=38]="UseRemoteAPIs",e[e.ManageAlerts=39]="ManageAlerts",e[e.CreateAlerts=40]="CreateAlerts",e[e.EditMyUserInfo=41]="EditMyUserInfo",e[e.EnumeratePermissions=63]="EnumeratePermissions",e[e.FullMask=65]="FullMask"}(t.PermissionKind||(t.PermissionKind={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.None=0]="None",e[e.View=1]="View",e[e.Edit=2]="Edit",e[e.Owner=3]="Owner"}(t.SharingRole||(t.SharingRole={})),function(e){e[e.Unknown=0]="Unknown",e[e.File=1]="File",e[e.Folder=2]="Folder",e[e.Item=3]="Item",e[e.List=4]="List",e[e.Web=5]="Web",e[e.Max=6]="Max"}(t.SPSharedObjectType||(t.SPSharedObjectType={})),function(e){e[e.None=0]="None",e[e.AllowList=1]="AllowList",e[e.BlockList=2]="BlockList"}(t.SharingDomainRestrictionMode||(t.SharingDomainRestrictionMode={})),function(e){e[e.CompletedSuccessfully=0]="CompletedSuccessfully",e[e.AccessRequestsQueued=1]="AccessRequestsQueued",e[e.NoResolvedUsers=-1]="NoResolvedUsers",e[e.AccessDenied=-2]="AccessDenied",e[e.CrossSiteRequestNotSupported=-3]="CrossSiteRequestNotSupported",e[e.UnknowError=-4]="UnknowError",e[e.EmailBodyTooLong=-5]="EmailBodyTooLong",e[e.ListUniqueScopesExceeded=-6]="ListUniqueScopesExceeded",e[e.CapabilityDisabled=-7]="CapabilityDisabled",e[e.ObjectNotSupported=-8]="ObjectNotSupported",e[e.NestedGroupsNotSupported=-9]="NestedGroupsNotSupported"}(t.SharingOperationStatusCode||(t.SharingOperationStatusCode={})),function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Direct=1]="Direct",e[e.OrganizationView=2]="OrganizationView",e[e.OrganizationEdit=3]="OrganizationEdit",e[e.AnonymousView=4]="AnonymousView",e[e.AnonymousEdit=5]="AnonymousEdit",e[e.Flexible=6]="Flexible"}(t.SharingLinkKind||(t.SharingLinkKind={})),function(e){e[e.None=0]="None",e[e.Guest=1]="Guest",e[e.Reader=2]="Reader",e[e.Contributor=3]="Contributor",e[e.WebDesigner=4]="WebDesigner",e[e.Administrator=5]="Administrator"}(t.RoleType||(t.RoleType={}))},function(e,t,r){"use strict";function n(e){return null!=e}function o(e){return null==e||e.length<1}Object.defineProperty(t,"__esModule",{value:!0}),t.getCtxCallback=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return function(){t.apply(e,r)}},t.dateAdd=function(e,t,r){var n=new Date(e.toString());switch(t.toLowerCase()){case"year":n.setFullYear(n.getFullYear()+r);break;case"quarter":n.setMonth(n.getMonth()+3*r);break;case"month":n.setMonth(n.getMonth()+r);break;case"week":n.setDate(n.getDate()+7*r);break;case"day":n.setDate(n.getDate()+r);break;case"hour":n.setTime(n.getTime()+36e5*r);break;case"minute":n.setTime(n.getTime()+6e4*r);break;case"second":n.setTime(n.getTime()+1e3*r);break;default:n=void 0}return n},t.combine=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.filter((function(e){return!o(e)})).map((function(e){return e.replace(/^[\\|\/]/,"").replace(/[\\|\/]$/,"")})).join("/").replace(/\\/g,"/")},t.getRandomString=function(e){for(var t=new Array(e),r=0;r<e;r++)t[r]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*Math.random()));return t.join("")},t.getGUID=function(){var e=Date.now();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var r=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?r:3&r|8).toString(16)}))},t.isFunc=function(e){return"function"==typeof e},t.objectDefinedNotNull=n,t.isArray=function(e){return Array.isArray?Array.isArray(e):e&&"number"==typeof e.length&&e.constructor===Array},t.assign=function(e,t,r,o){if(void 0===r&&(r=!1),void 0===o&&(o=function(){return!0}),!n(t))return e;var i=r?function(e,t){return!(t in e)}:function(){return!0};return Object.getOwnPropertyNames(t).filter((function(t){return i(e,t)&&o(t)})).reduce((function(e,r){return e[r]=t[r],e}),e)},t.isUrlAbsolute=function(e){return/^https?:\/\/|^\/\//i.test(e)},t.stringIsNullOrEmpty=o,t.sanitizeGuid=function(e){if(o(e))return e;var t=/([0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12})/i.exec(e);return null===t?e:t[1]},t.jsS=function(e){return JSON.stringify(e)},t.hOP=function(e,t){return Object.hasOwnProperty.call(e,t)},t.getHashCode=function(e){var t=0;if(0===e.length)return t;for(var r=0;r<e.length;r++){t=(t<<5)-t+e.charCodeAt(r),t|=0}return t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(2),i=r(29),a=r(12),s=r(5),u=r(0),c=function(){function e(e){void 0===e&&(e=i.SPRuntimeConfig.fetchClientFactory()),this._impl=e,this._digestCache=function(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,(function(){var t,a,s,c,p,d;return n.__generator(this,(function(n){switch(n.label){case 0:return void 0!==(t=l.get(r))&&new Date<t.expiration?[2,t.value]:(a=o.combine(r,"/_api/contextinfo"),s={Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose;charset=utf-8"},[4,e.fetchRaw(a,{cache:"no-cache",credentials:"same-origin",headers:o.assign(s,i.SPRuntimeConfig.headers,!0),method:"POST"})]);case 1:return c=n.sent(),[4,(new u.ODataParser).parse(c).then((function(e){return e.GetContextWebInformation}))];case 2:return p=n.sent(),d={expiration:o.dateAdd(new Date,"second",p.FormDigestTimeoutSeconds),value:p.FormDigestValue},l.set(r,d),[2,d.value]}}))}))}}(this)}return e.prototype.fetch=function(e,t){return void 0===t&&(t={}),n.__awaiter(this,void 0,void 0,(function(){var r,u,c,l,p;return n.__generator(this,(function(n){switch(n.label){case 0:return r=o.assign(t,{cache:"no-cache",credentials:"same-origin"},!0),u=new Headers,o.mergeHeaders(u,i.SPRuntimeConfig.headers),o.mergeHeaders(u,t.headers),u.has("Accept")||u.append("Accept","application/json"),u.has("Content-Type")||u.append("Content-Type","application/json;odata=verbose;charset=utf-8"),u.has("X-ClientService-ClientTag")||(c=s.tag.getClientTag(u),(l="PnPCoreJS:$$Version$$:"+c).length>32&&(l=l.substr(0,32)),u.append("X-ClientService-ClientTag",l)),u.has("User-Agent")||u.append("User-Agent","NONISV|SharePointPnP|PnPjs/$$Version$$"),!(r=o.assign(r,{headers:u})).method||"GET"===r.method.toUpperCase()||u.has("X-RequestDigest")||u.has("Authorization")?[3,2]:[4,this._digestCache(a.extractWebUrl(e))];case 1:p=n.sent(),u.append("X-RequestDigest",p),n.label=2;case 2:return[2,this.fetchRaw(e,r)]}}))}))},e.prototype.fetchRaw=function(e,t){var r=this;void 0===t&&(t={});var n=new Headers;o.mergeHeaders(n,t.headers),t=o.assign(t,{headers:n});var i=function(n){var a=function(e){var t;e.headers.has("Retry-After")?t=parseInt(e.headers.get("Retry-After"),10):(t=n.delay,n.delay*=2),n.attempts++,n.retryCount<=n.attempts?n.reject(Error("Retry count exceeded ("+n.retryCount+") for request. Response status: ["+e.status+"] "+e.statusText)):setTimeout(o.getCtxCallback(r,i,n),t)};r._impl.fetch(e,t).then((function(e){429===e.status?a(e):n.resolve(e)})).catch((function(e){503===e.status?a(e):n.reject(e)}))};return new Promise((function(e,t){i.call(r,{attempts:0,delay:100,reject:t,resolve:e,retryCount:7})}))},e.prototype.get=function(e,t){void 0===t&&(t={});var r=o.assign(t,{method:"GET"});return this.fetch(e,r)},e.prototype.post=function(e,t){void 0===t&&(t={});var r=o.assign(t,{method:"POST"});return this.fetch(e,r)},e.prototype.patch=function(e,t){void 0===t&&(t={});var r=o.assign(t,{method:"PATCH"});return this.fetch(e,r)},e.prototype.delete=function(e,t){void 0===t&&(t={});var r=o.assign(t,{method:"DELETE"});return this.fetch(e,r)},e}();t.SPHttpClient=c;var l=new Map},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2);t.setup=function(e){n.RuntimeConfig.assign(e)};var o=function(){function e(){}return Object.defineProperty(e.prototype,"headers",{get:function(){var e=n.RuntimeConfig.get("sp");return void 0!==e&&void 0!==e.headers?e.headers:{}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"baseUrl",{get:function(){var e=n.RuntimeConfig.get("sp");return void 0!==e&&void 0!==e.baseUrl?e.baseUrl:n.objectDefinedNotNull(n.RuntimeConfig.spfxContext)?n.RuntimeConfig.spfxContext.pageContext.web.absoluteUrl:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fetchClientFactory",{get:function(){var e=n.RuntimeConfig.get("sp");return void 0!==e&&void 0!==e.fetchClientFactory?e.fetchClientFactory:function(){return new n.FetchClient}},enumerable:!0,configurable:!0}),e}();t.SPRuntimeConfigImpl=o,t.SPRuntimeConfig=new o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(14),o=r(23),i=r(23);t.Site=i.Site,Reflect.defineProperty(n.SPRest.prototype,"site",{configurable:!0,enumerable:!0,get:function(){return o.Site(this._baseUrl).configure(this._options)}})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(7),o=r(14),i=r(7);t.Web=i.Web,t.Webs=i.Webs,Reflect.defineProperty(o.SPRest.prototype,"web",{configurable:!0,enumerable:!0,get:function(){return n.Web(this._baseUrl).configure(this._options)}}),o.SPRest.prototype.createBatch=function(){return this.web.createBatch()}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(64);var n=r(16);t.Item=n.Item,t.Items=n.Items,t.ItemVersion=n.ItemVersion,t.ItemVersions=n.ItemVersions,t.PagedItemCollection=n.PagedItemCollection},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(0),i=r(3),a=r(6),s=r(8),u=r(4),c=r(5),l=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r.prototype.addAvailableContentType=function(e){return n.__awaiter(this,void 0,void 0,(function(){var r;return n.__generator(this,(function(n){switch(n.label){case 0:return[4,u.spPost(this.clone(t.ContentTypes,"addAvailableContentType"),o.body({contentTypeId:e}))];case 1:return r=n.sent(),[2,{contentType:this.getById(r.id),data:r}]}}))}))},r.prototype.getById=function(e){return c.tag.configure(t.ContentType(this).concat("('"+e+"')"),"cts.getById")},r.prototype.add=function(e,t,r,i,a){return void 0===r&&(r=""),void 0===i&&(i="Custom Content Types"),void 0===a&&(a={}),n.__awaiter(this,void 0,void 0,(function(){var c,l;return n.__generator(this,(function(n){switch(n.label){case 0:return c=o.body(Object.assign(s.metadata("SP.ContentType"),{Description:r,Group:i,Id:{StringValue:e},Name:t},a)),[4,u.spPost(this,c)];case 1:return l=n.sent(),[2,{contentType:this.getById(l.id),data:l}]}}))}))},n.__decorate([c.tag("cts.addAvailableContentType")],r.prototype,"addAvailableContentType",null),n.__decorate([c.tag("cts.add")],r.prototype,"add",null),r=n.__decorate([a.defaultPath("contenttypes")],r)}(i._SharePointQueryableCollection);t._ContentTypes=l,t.ContentTypes=i.spInvokableFactory(l);var p=function(e){function r(){var t=null!==e&&e.apply(this,arguments)||this;return t.delete=i.deleteable("ct"),t}return n.__extends(r,e),Object.defineProperty(r.prototype,"fieldLinks",{get:function(){return c.tag.configure(t.FieldLinks(this),"ct.fieldLinks")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"fields",{get:function(){return c.tag.configure(i.SharePointQueryableCollection(this,"fields"),"ct.fields")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"parent",{get:function(){return c.tag.configure(t.ContentType(this,"parent"),"ct.parent")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"workflowAssociations",{get:function(){return c.tag.configure(i.SharePointQueryableCollection(this,"workflowAssociations"),"ct.workflowAssociations")},enumerable:!0,configurable:!0}),r}(i._SharePointQueryableInstance);t._ContentType=p,t.ContentType=i.spInvokableFactory(p);var d=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r.prototype.getById=function(e){return c.tag.configure(t.FieldLink(this).concat("(guid'"+e+"')"),"fls.getById")},r=n.__decorate([a.defaultPath("fieldlinks")],r)}(i._SharePointQueryableCollection);t._FieldLinks=d,t.FieldLinks=i.spInvokableFactory(d);var h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t}(i._SharePointQueryableInstance);t._FieldLink=h,t.FieldLink=i.spInvokableFactory(h)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(3),i=r(48),a=r(2),s=r(8),u=r(0),c=r(6),l=r(4),p=r(5),d=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r.prototype.getById=function(e){return p.tag.configure(t.SiteGroup(this).concat("("+e+")"),"sgs.getById")},r.prototype.add=function(e){return n.__awaiter(this,void 0,void 0,(function(){var t,r;return n.__generator(this,(function(n){switch(n.label){case 0:return t=u.body(a.assign(s.metadata("SP.Group"),e)),[4,l.spPost(p.tag.configure(this,"sgs.add"),t)];case 1:return[2,{data:r=n.sent(),group:this.getById(r.Id)}]}}))}))},r.prototype.getByName=function(e){return p.tag.configure(t.SiteGroup(this,"getByName('"+e+"')"),"sgs.getByName")},r.prototype.removeById=function(e){return l.spPost(this.clone(t.SiteGroups,"removeById('"+e+"')"))},r.prototype.removeByLoginName=function(e){return l.spPost(this.clone(t.SiteGroups,"removeByLoginName('"+e+"')"))},n.__decorate([p.tag("sgs.removeById")],r.prototype,"removeById",null),n.__decorate([p.tag("sgs.removeByLoginName")],r.prototype,"removeByLoginName",null),r=n.__decorate([c.defaultPath("sitegroups")],r)}(o._SharePointQueryableCollection);t._SiteGroups=d,t.SiteGroups=o.spInvokableFactory(d);var h=function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r.update=r._update("SP.Group",(function(e,n){var o=r;return a.hOP(n,"Title")&&(o=r.getParent(t.SiteGroup,r.parentUrl,"getByName('"+n.Title+"')")),{data:e,group:o}})),r}return n.__extends(r,e),Object.defineProperty(r.prototype,"users",{get:function(){return p.tag.configure(i.SiteUsers(this,"users"),"sg.users")},enumerable:!0,configurable:!0}),r.prototype.setUserAsOwner=function(e){return l.spPost(this.clone(t.SiteGroup,"SetUserAsOwner("+e+")"))},n.__decorate([p.tag("sg.setUserAsOwner")],r.prototype,"setUserAsOwner",null),r}(o._SharePointQueryableInstance);t._SiteGroup=h,t.SiteGroup=o.spInvokableFactory(h)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(0),i=r(4),a=r(3),s=r(12),u=r(5),c=r(17),l=function(e){function t(t,r){void 0===r&&(r="");var n="string"==typeof t?t:t.toUrl();return e.call(this,s.extractWebUrl(n),"_api/Microsoft.Sharepoint.Utilities.WebTemplateExtensions.SiteScriptUtility."+r)||this}return n.__extends(t,e),t.prototype.execute=function(e){return i.spPost(this,o.body(e))},t.prototype.getSiteScripts=function(){return this.clone(p,"GetSiteScripts",!0).execute({})},t.prototype.createSiteScript=function(e,t,r){return this.clone(p,"CreateSiteScript(Title=@title,Description=@desc)?@title='"+c.escapeQueryStrValue(e)+"'&@desc='"+c.escapeQueryStrValue(t)+"'").execute(r)},t.prototype.getSiteScriptMetadata=function(e){return this.clone(p,"GetSiteScriptMetadata").execute({id:e})},t.prototype.deleteSiteScript=function(e){return this.clone(p,"DeleteSiteScript").execute({id:e})},t.prototype.updateSiteScript=function(e,t){return t&&(e.Content=JSON.stringify(t)),this.clone(p,"UpdateSiteScript").execute({updateInfo:e})},t.prototype.getSiteScriptFromList=function(e){return this.clone(p,"GetSiteScriptFromList").execute({listUrl:e})},t.prototype.getSiteScriptFromWeb=function(e,t){return this.clone(p,"getSiteScriptFromWeb").execute({webUrl:e,info:t})},n.__decorate([u.tag("ss.getSiteScripts")],t.prototype,"getSiteScripts",null),n.__decorate([u.tag("ss.createSiteScript")],t.prototype,"createSiteScript",null),n.__decorate([u.tag("ss.getSiteScriptMetadata")],t.prototype,"getSiteScriptMetadata",null),n.__decorate([u.tag("ss.deleteSiteScript")],t.prototype,"deleteSiteScript",null),n.__decorate([u.tag("ss.updateSiteScript")],t.prototype,"updateSiteScript",null),n.__decorate([u.tag("ss.getSiteScriptFromList")],t.prototype,"getSiteScriptFromList",null),n.__decorate([u.tag("ss.getSiteScriptFromWeb")],t.prototype,"getSiteScriptFromWeb",null),t}(a._SharePointQueryable);t._SiteScripts=l,t.SiteScripts=function(e,t){return new l(e,t)};var p=function(e,r){return void 0===r&&(r=""),t.SiteScripts(e,r)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(3),i=r(2),a=r(0),s=r(6),u=r(4),c=r(5),l=r(8),p=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r.prototype.getById=function(e){return c.tag.configure(t.UserCustomAction(this).concat("('"+e+"')"),"ucas.getById")},r.prototype.add=function(e){return n.__awaiter(this,void 0,void 0,(function(){var t;return n.__generator(this,(function(r){switch(r.label){case 0:return[4,u.spPost(this,a.body(i.assign(l.metadata("SP.UserCustomAction"),e)))];case 1:return t=r.sent(),[2,{action:this.getById(t.Id),data:t}]}}))}))},r.prototype.clear=function(){return u.spPost(this.clone(t.UserCustomActions,"clear"))},n.__decorate([c.tag("ucas.add")],r.prototype,"add",null),n.__decorate([c.tag("ucas.clear")],r.prototype,"clear",null),r=n.__decorate([s.defaultPath("usercustomactions")],r)}(o._SharePointQueryableCollection);t._UserCustomActions=p,t.UserCustomActions=o.spInvokableFactory(p);var d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.delete=o.deleteable("uca"),t.update=t._update("SP.UserCustomAction",(function(e){return{data:e,action:t}})),t}return n.__extends(t,e),t}(o._SharePointQueryableInstance);t._UserCustomAction=d,t.UserCustomAction=o.spInvokableFactory(d),function(e){e[e.None=0]="None",e[e.List=1]="List",e[e.ContentType=2]="ContentType",e[e.ProgId=3]="ProgId",e[e.FileType=4]="FileType"}(t.UserCustomActionRegistrationType||(t.UserCustomActionRegistrationType={})),function(e){e[e.Unknown=0]="Unknown",e[e.Site=2]="Site",e[e.Web=3]="Web",e[e.List=4]="List"}(t.UserCustomActionScope||(t.UserCustomActionScope={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(9),i=r(11),a=r(0),s=r(10),u=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r.prototype.getMemberObjects=function(e){return void 0===e&&(e=!1),s.graphPost(this.clone(t.DirectoryObject,"getMemberObjects"),a.body({securityEnabledOnly:e}))},r.prototype.getMemberGroups=function(e){return void 0===e&&(e=!1),s.graphPost(this.clone(t.DirectoryObject,"getMemberGroups"),a.body({securityEnabledOnly:e}))},r.prototype.checkMemberGroups=function(e){return s.graphPost(this.clone(t.DirectoryObject,"checkMemberGroups"),a.body({groupIds:e}))},r=n.__decorate([i.deleteable()],r)}(o._GraphQueryableInstance);t._DirectoryObject=u,t.DirectoryObject=o.graphInvokableFactory(u);var c,l=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r.prototype.getByIds=function(e,r){return void 0===r&&(r=c.directoryObject),s.graphPost(this.clone(t.DirectoryObjects,"getByIds"),a.body({ids:e,type:r}))},r=n.__decorate([i.defaultPath("directoryObjects"),i.getById(t.DirectoryObject)],r)}(o._GraphQueryableCollection);t._DirectoryObjects=l,t.DirectoryObjects=o.graphInvokableFactory(l),function(e){e[e.directoryObject=0]="directoryObject",e[e.user=1]="user",e[e.group=2]="group",e[e.device=3]="device"}(c=t.DirectoryObjectTypes||(t.DirectoryObjectTypes={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(2),i=r(0),a=r(9),s=r(11),u=r(10),c=r(11),l=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),Object.defineProperty(r.prototype,"plans",{get:function(){return t.Plans(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"tasks",{get:function(){return t.Tasks(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"buckets",{get:function(){return t.Buckets(this)},enumerable:!0,configurable:!0}),r=n.__decorate([c.defaultPath("planner")],r)}(a._GraphQueryableInstance);t._Planner=l,t.Planner=a.graphInvokableFactory(l);var p=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),Object.defineProperty(r.prototype,"tasks",{get:function(){return t.Tasks(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"buckets",{get:function(){return t.Buckets(this)},enumerable:!0,configurable:!0}),r=n.__decorate([s.updateable(),s.deleteable()],r)}(a._GraphQueryableInstance);t._Plan=p,t.Plan=a.graphInvokableFactory(p);var d=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r.prototype.add=function(e,t){return n.__awaiter(this,void 0,void 0,(function(){var r;return n.__generator(this,(function(n){switch(n.label){case 0:return[4,u.graphPost(this,i.body({owner:e,title:t}))];case 1:return[2,{data:r=n.sent(),plan:this.getById(r.id)}]}}))}))},r=n.__decorate([c.defaultPath("plans"),s.getById(t.Plan)],r)}(a._GraphQueryableCollection);t._Plans=d,t.Plans=a.graphInvokableFactory(d);var h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t=n.__decorate([s.updateableWithETag(),s.deleteableWithETag()],t)}(a._GraphQueryableInstance);t._Task=h,t.Task=a.graphInvokableFactory(h);var f=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r.prototype.add=function(e,t,r,a){return n.__awaiter(this,void 0,void 0,(function(){var s,c;return n.__generator(this,(function(n){switch(n.label){case 0:return s=o.assign({planId:e,title:t},r),a&&(s=o.assign(s,{bucketId:a})),[4,u.graphPost(this,i.body(s))];case 1:return[2,{data:c=n.sent(),task:this.getById(c.id)}]}}))}))},r=n.__decorate([c.defaultPath("tasks"),s.getById(t.Task)],r)}(a._GraphQueryableCollection);t._Tasks=f,t.Tasks=a.graphInvokableFactory(f);var y=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),Object.defineProperty(r.prototype,"tasks",{get:function(){return t.Tasks(this)},enumerable:!0,configurable:!0}),r=n.__decorate([s.updateable(),s.deleteable()],r)}(a._GraphQueryableInstance);t._Bucket=y,t.Bucket=a.graphInvokableFactory(y);var g=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r.prototype.add=function(e,t,r){return n.__awaiter(this,void 0,void 0,(function(){var o,a;return n.__generator(this,(function(n){switch(n.label){case 0:return o={name:e,orderHint:r||"",planId:t},[4,u.graphPost(this,i.body(o))];case 1:return a=n.sent(),[2,{bucket:this.getById(a.id),data:a}]}}))}))},r=n.__decorate([c.defaultPath("buckets"),s.getById(t.Bucket)],r)}(a._GraphQueryableCollection);t._Buckets=g,t.Buckets=a.graphInvokableFactory(g)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(2),i=function(){function e(){}return e.prototype.parse=function(e){var t=this;return new Promise((function(r,n){t.handleError(e,n)&&t.parseImpl(e,r,n)}))},e.prototype.parseImpl=function(e,t,r){var n=this;e.headers.has("Content-Length")&&0===parseFloat(e.headers.get("Content-Length"))||204===e.status?t({}):e.text().then((function(e){return e.replace(/\s/gi,"").length>0?JSON.parse(e):{}})).then((function(e){return t(n.parseODataJSON(e))})).catch((function(e){return r(e)}))},e.prototype.handleError=function(e,t){return e.ok||p.init(e).then(t),e.ok},e.prototype.parseODataJSON=function(e){var t=e;return o.hOP(e,"d")?t=o.hOP(e.d,"results")?e.d.results:e.d:o.hOP(e,"value")&&(t=e.value),t},e}();t.ODataParser=i;var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.parseImpl=function(e,t){e.text().then(t)},t}(i);t.TextParser=a;var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.parseImpl=function(e,t){e.blob().then(t)},t}(i);t.BlobParser=s;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.parseImpl=function(e,t){e.json().then(t)},t}(i);t.JSONParser=u;var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.parseImpl=function(e,t){o.isFunc(e.arrayBuffer)?e.arrayBuffer().then(t):e.buffer().then(t)},t}(i);t.BufferParser=c;var l=function(e){function t(t){var r=e.call(this)||this;return r.parser=t,r}return n.__extends(t,e),t.prototype.parseImpl=function(e,t){this.parser(e).then(t)},t}(i);t.LambdaParser=l;var p=function(e){function t(t,r,n,o){void 0===n&&(n=r.status),void 0===o&&(o=r.statusText);var i=e.call(this,t)||this;return i.response=r,i.status=n,i.statusText=o,i.isHttpRequestError=!0,i}return n.__extends(t,e),t.init=function(e){return n.__awaiter(this,void 0,void 0,(function(){var r;return n.__generator(this,(function(n){switch(n.label){case 0:return[4,e.clone().text()];case 1:return r=n.sent(),[2,new t("Error making HttpClient request in queryable ["+e.status+"] "+e.statusText+" ::> "+r,e.clone())]}}))}))},t}(Error);t.HttpRequestError=p},function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),o=r(29);t.toAbsoluteUrl=function(t){return new Promise((function(r){if(n.isUrlAbsolute(t))return r(t);if(null!==o.SPRuntimeConfig.baseUrl)return r(n.combine(o.SPRuntimeConfig.baseUrl,t));if(void 0!==e._spPageContextInfo){if(n.hOP(e._spPageContextInfo,"webAbsoluteUrl"))return r(n.combine(e._spPageContextInfo.webAbsoluteUrl,t));if(n.hOP(e._spPageContextInfo,"webServerRelativeUrl"))return r(n.combine(e._spPageContextInfo.webServerRelativeUrl,t))}if(void 0!==e.location){var i=e.location.toString().toLowerCase();["/_layouts/","/siteassets/"].forEach((function(e){var o=i.indexOf(e);if(o>0)return r(n.combine(i.substr(0,o),t))}))}return r(t)}))}}).call(this,r(56))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(0),i=r(2),a=r(18),s=r(28),u=r(29),c=r(40),l=function(e){function t(t){var r=e.call(this)||this;return r.baseUrl=t,r}return n.__extends(t,e),t.ParseResponse=function(e){return new Promise((function(t,r){for(var n,o,i=[],a=new RegExp("^HTTP/[0-9.]+ +([0-9]+) +(.*)","i"),s=e.split("\n"),u="batch",c=0;c<s.length;++c){var l=s[c];switch(u){case"batch":if("--batchresponse_"===l.substr(0,"--batchresponse_".length))u="batchHeaders";else if(""!==l.trim())throw Error("Invalid response, line "+c);break;case"batchHeaders":""===l.trim()&&(u="status");break;case"status":var p=a.exec(l);if(3!==p.length)throw Error("Invalid status, line "+c);n=parseInt(p[1],10),o=p[2],u="statusHeaders";break;case"statusHeaders":""===l.trim()&&(u="body");break;case"body":i.push(204===n?new Response:new Response(l,{status:n,statusText:o})),u="batch"}}"status"!==u&&r(Error("Unexpected end of input")),t(i)}))},t.prototype.executeImpl=function(){var e=this;if(a.Logger.write("["+this.batchId+"] ("+(new Date).getTime()+") Executing batch with "+this.requests.length+" requests.",1),this.requests.length<1)return a.Logger.write("Resolving empty batch.",1),Promise.resolve();var r=new s.SPHttpClient;return c.toAbsoluteUrl(this.baseUrl).then((function(n){for(var o=[],s="",c=0;c<e.requests.length;c++){var l=e.requests[c];"GET"===l.method?(s.length>0&&(o.push("--changeset_"+s+"--\n\n"),s=""),o.push("--batch_"+e.batchId+"\n")):(s.length<1&&(s=i.getGUID(),o.push("--batch_"+e.batchId+"\n"),o.push('Content-Type: multipart/mixed; boundary="changeset_'+s+'"\n\n')),o.push("--changeset_"+s+"\n")),o.push("Content-Type: application/http\n"),o.push("Content-Transfer-Encoding: binary\n\n");var p=new Headers,d=i.isUrlAbsolute(l.url)?l.url:i.combine(n,l.url);if(a.Logger.write("["+e.batchId+"] ("+(new Date).getTime()+") Adding request "+l.method+" "+d+" to batch.",0),"GET"!==l.method){var h=l.method,f=l.options.headers;i.hOP(l,"options")&&i.hOP(l.options,"headers")&&void 0!==f["X-HTTP-Method"]&&(h=f["X-HTTP-Method"],delete f["X-HTTP-Method"]),o.push(h+" "+d+" HTTP/1.1\n"),p.set("Content-Type","application/json;odata=verbose;charset=utf-8")}else o.push(l.method+" "+d+" HTTP/1.1\n");i.mergeHeaders(p,u.SPRuntimeConfig.headers),l.options&&i.mergeHeaders(p,l.options.headers),p.has("Accept")||p.append("Accept","application/json"),p.has("Content-Type")||p.append("Content-Type","application/json;odata=verbose;charset=utf-8"),p.has("X-ClientService-ClientTag")||p.append("X-ClientService-ClientTag","PnPCoreJS:@pnp-$$Version$$"),p.forEach((function(e,t){o.push(t+": "+e+"\n")})),o.push("\n"),l.options.body&&o.push(l.options.body+"\n\n")}s.length>0&&(o.push("--changeset_"+s+"--\n\n"),s=""),o.push("--batch_"+e.batchId+"--\n");var y={body:o.join(""),headers:{"Content-Type":"multipart/mixed; boundary=batch_"+e.batchId},method:"POST"};return a.Logger.write("["+e.batchId+"] ("+(new Date).getTime()+") Sending batch request.",1),r.fetch(i.combine(n,"/_api/$batch"),y).then((function(e){return e.text()})).then(t.ParseResponse).then((function(t){if(t.length!==e.requests.length)throw Error("Could not properly parse responses to match requests in batch.");return a.Logger.write("["+e.batchId+"] ("+(new Date).getTime()+") Resolving batched requests.",1),t.reduce((function(t,r,n){var o=e.requests[n];return a.Logger.write("["+o.id+"] ("+(new Date).getTime()+") Resolving request in batch "+e.batchId+".",1),t.then((function(e){return o.parser.parse(r).then(o.resolve).catch(o.reject)}))}),Promise.resolve())}))}))},t}(o.Batch);t.SPBatch=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),o=r(43),i=function(){function e(){this._impl=o.GraphRuntimeConfig.fetchClientFactory()}return e.prototype.fetch=function(e,t){void 0===t&&(t={});var r=new Headers;n.mergeHeaders(r,o.GraphRuntimeConfig.headers),n.mergeHeaders(r,t.headers),r.has("Content-Type")||r.append("Content-Type","application/json"),r.has("SdkVersion")||r.append("SdkVersion","PnPCoreJS/$$Version$$");var i=n.assign(t,{headers:r});return this.fetchRaw(e,i)},e.prototype.fetchRaw=function(e,t){var r=this;void 0===t&&(t={});var o=new Headers;n.mergeHeaders(o,t.headers),t=n.assign(t,{headers:o});var i=function(o){r._impl.fetch(e,t).then((function(e){return o.resolve(e)})).catch((function(e){429!==e.status&&503!==e.status&&o.reject(e);var t=o.delay;o.delay*=2,o.attempts++,o.retryCount<=o.attempts&&o.reject(e),setTimeout(n.getCtxCallback(r,i,o),t)}))};return new Promise((function(e,t){var n={attempts:0,delay:100,reject:t,resolve:e,retryCount:7};i.call(r,n)}))},e.prototype.get=function(e,t){void 0===t&&(t={});var r=n.assign(t,{method:"GET"});return this.fetch(e,r)},e.prototype.post=function(e,t){void 0===t&&(t={});var r=n.assign(t,{method:"POST"});return this.fetch(e,r)},e.prototype.patch=function(e,t){void 0===t&&(t={});var r=n.assign(t,{method:"PATCH"});return this.fetch(e,r)},e.prototype.delete=function(e,t){void 0===t&&(t={});var r=n.assign(t,{method:"DELETE"});return this.fetch(e,r)},e}();t.GraphHttpClient=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),o=r(164);t.setup=function(e){n.RuntimeConfig.assign(e)};var i=function(){function e(){}return Object.defineProperty(e.prototype,"headers",{get:function(){var e=n.RuntimeConfig.get("graph");return null!=e&&void 0!==e.headers?e.headers:{}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fetchClientFactory",{get:function(){var e=n.RuntimeConfig.get("graph");if(null!=e&&void 0!==e.fetchClientFactory)return e.fetchClientFactory;if(void 0!==n.RuntimeConfig.spfxContext)return function(){return o.AdalClient.fromSPFxContext(n.RuntimeConfig.spfxContext)};throw Error("There is no Graph Client available, either set one using configuraiton or provide a valid SPFx Context using setup.")},enumerable:!0,configurable:!0}),e}();t.GraphRuntimeConfigImpl=i,t.GraphRuntimeConfig=new i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(0),i=r(3),a=r(6),s=r(4),u=r(5),c=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r.prototype.add=function(e,r){return void 0===r&&(r=!1),n.__awaiter(this,void 0,void 0,(function(){return n.__generator(this,(function(n){switch(n.label){case 0:return[4,s.spPost(this.clone(t.Features,"add"),o.body({featdefScope:0,featureId:e,force:r}))];case 1:return[2,{data:n.sent(),feature:this.getById(e)}]}}))}))},r.prototype.getById=function(e){var r=t.Feature(this);return r.concat("('"+e+"')"),u.tag.configure(r,"fes.getById")},r.prototype.remove=function(e,r){return void 0===r&&(r=!1),s.spPost(this.clone(t.Features,"remove"),o.body({featureId:e,force:r}))},n.__decorate([u.tag("fes.add")],r.prototype,"add",null),n.__decorate([u.tag("fes.remove")],r.prototype,"remove",null),r=n.__decorate([a.defaultPath("features")],r)}(i._SharePointQueryableCollection);t._Features=c,t.Features=i.spInvokableFactory(c);var l=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r.prototype.deactivate=function(e){return void 0===e&&(e=!1),n.__awaiter(this,void 0,void 0,(function(){var r,o,i;return n.__generator(this,(function(n){switch(n.label){case 0:return r=this.addBatchDependency(),[4,t.Feature(this).select("DefinitionId")()];case 1:return o=n.sent(),i=this.getParent(t.Features,this.parentUrl,"",this.batch).remove(o.DefinitionId,e),r(),[2,i]}}))}))},n.__decorate([u.tag("fe.deactivate")],r.prototype,"deactivate",null),r}(i._SharePointQueryableInstance);t._Feature=l,t.Feature=i.spInvokableFactory(l)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(3),i=r(2),a=r(8),s=r(0),u=r(6),c=r(4),l=r(5),p=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r.prototype.getById=function(e){return l.tag.configure(t.Field(this).concat("('"+e+"')"),"fs.getById")},r.prototype.getByTitle=function(e){return l.tag.configure(t.Field(this,"getByTitle('"+e+"')"),"fs.getByTitle")},r.prototype.getByInternalNameOrTitle=function(e){return l.tag.configure(t.Field(this,"getByInternalNameOrTitle('"+e+"')"),"fs.getByInternalNameOrTitle")},r.prototype.createFieldAsXml=function(e){return n.__awaiter(this,void 0,void 0,(function(){var r,o;return n.__generator(this,(function(n){switch(n.label){case 0:return"string"==typeof e&&(e={SchemaXml:e}),r=s.body({parameters:i.assign(a.metadata("SP.XmlSchemaFieldCreationInformation"),e)}),[4,c.spPost(this.clone(t.Fields,"createfieldasxml"),r)];case 1:return[2,{data:o=n.sent(),field:this.getById(o.Id)}]}}))}))},r.prototype.add=function(e,r,o){return n.__awaiter(this,void 0,void 0,(function(){var i,u;return n.__generator(this,(function(n){switch(n.label){case 0:return i=s.body(Object.assign(a.metadata(r),{Title:e},o)),l.tag.isTagged(this)||l.tag.configure(this,"fs.add"),[4,c.spPost(this.clone(t.Fields,null),i)];case 1:return[2,{data:u=n.sent(),field:this.getById(u.Id)}]}}))}))},r.prototype.addText=function(e,t,r){void 0===t&&(t=255);var n={FieldTypeKind:2,MaxLength:t};return this.add(e,"SP.FieldText",i.assign(n,r))},r.prototype.addCalculated=function(e,t,r,n,o){void 0===n&&(n=d.Text);var a={DateFormat:r,FieldTypeKind:17,Formula:t,OutputType:n};return this.add(e,"SP.FieldCalculated",i.assign(a,o))},r.prototype.addDateTime=function(e,t,r,n,o){void 0===t&&(t=h.DateOnly),void 0===r&&(r=y.Gregorian),void 0===n&&(n=f.Unspecified);var a={DateTimeCalendarType:r,DisplayFormat:t,FieldTypeKind:4,FriendlyDisplayFormat:n};return this.add(e,"SP.FieldDateTime",i.assign(a,o))},r.prototype.addNumber=function(e,t,r,n){var o={FieldTypeKind:9};return void 0!==t&&(o=i.assign({MinimumValue:t},o)),void 0!==r&&(o=i.assign({MaximumValue:r},o)),this.add(e,"SP.FieldNumber",i.assign(o,n))},r.prototype.addCurrency=function(e,t,r,n,o){void 0===n&&(n=1033);var a={CurrencyLocaleId:n,FieldTypeKind:10};return void 0!==t&&(a=i.assign({MinimumValue:t},a)),void 0!==r&&(a=i.assign({MaximumValue:r},a)),this.add(e,"SP.FieldCurrency",i.assign(a,o))},r.prototype.addMultilineText=function(e,t,r,n,o,a,s){void 0===t&&(t=6),void 0===r&&(r=!0),void 0===n&&(n=!1),void 0===o&&(o=!1),void 0===a&&(a=!0);var u={AllowHyperlink:a,AppendOnly:o,FieldTypeKind:3,NumberOfLines:t,RestrictedMode:n,RichText:r};return this.add(e,"SP.FieldMultiLineText",i.assign(u,s))},r.prototype.addUrl=function(e,t,r){void 0===t&&(t=g.Hyperlink);var n={DisplayFormat:t,FieldTypeKind:11};return this.add(e,"SP.FieldUrl",i.assign(n,r))},r.prototype.addUser=function(e,t,r){var n={FieldTypeKind:20,SelectionMode:t};return this.add(e,"SP.FieldUser",i.assign(n,r))},r.prototype.addLookup=function(e,r,o,u){return n.__awaiter(this,void 0,void 0,(function(){var l,p,d;return n.__generator(this,(function(n){switch(n.label){case 0:return l=i.assign({FieldTypeKind:7,LookupFieldName:o,LookupListId:r,Title:e},u),p=s.body({parameters:i.assign(a.metadata("SP.FieldCreationInformation"),l)}),[4,c.spPost(this.clone(t.Fields,"addfield"),p)];case 1:return[2,{data:d=n.sent(),field:this.getById(d.Id)}]}}))}))},r.prototype.addChoice=function(e,t,r,n,o){void 0===r&&(r=_.Dropdown);var a={Choices:{results:t},EditFormat:r,FieldTypeKind:6,FillInChoice:n};return this.add(e,"SP.FieldChoice",i.assign(a,o))},r.prototype.addMultiChoice=function(e,t,r,n){var o={Choices:{results:t},FieldTypeKind:15,FillInChoice:r};return this.add(e,"SP.FieldMultiChoice",i.assign(o,n))},r.prototype.addBoolean=function(e,t){return this.add(e,"SP.Field",i.assign({FieldTypeKind:8},t))},r.prototype.addDependentLookupField=function(e,r,o){return n.__awaiter(this,void 0,void 0,(function(){var i,a;return n.__generator(this,(function(n){switch(n.label){case 0:return i="adddependentlookupfield(displayName='"+e+"', primarylookupfieldid='"+r+"', showfield='"+o+"')",[4,c.spPost(this.clone(t.Fields,i))];case 1:return[2,{data:a=n.sent(),field:this.getById(a.Id)}]}}))}))},r.prototype.addLocation=function(e,t){return this.add(e,"SP.FieldLocation",i.assign({FieldTypeKind:33},t))},n.__decorate([l.tag("fs.createFieldAsXml")],r.prototype,"createFieldAsXml",null),n.__decorate([l.tag("fs.addText")],r.prototype,"addText",null),n.__decorate([l.tag("fs.addCalculated")],r.prototype,"addCalculated",null),n.__decorate([l.tag("fs.addDateTime")],r.prototype,"addDateTime",null),n.__decorate([l.tag("fs.addNumber")],r.prototype,"addNumber",null),n.__decorate([l.tag("fs.addCurrency")],r.prototype,"addCurrency",null),n.__decorate([l.tag("fs.addMultilineText")],r.prototype,"addMultilineText",null),n.__decorate([l.tag("fs.addUrl")],r.prototype,"addUrl",null),n.__decorate([l.tag("fs.addUser")],r.prototype,"addUser",null),n.__decorate([l.tag("fs.addLookup")],r.prototype,"addLookup",null),n.__decorate([l.tag("fs.addChoice")],r.prototype,"addChoice",null),n.__decorate([l.tag("fs.addMultiChoice")],r.prototype,"addMultiChoice",null),n.__decorate([l.tag("fs.addBoolean")],r.prototype,"addBoolean",null),n.__decorate([l.tag("fs.addDependentLookupField")],r.prototype,"addDependentLookupField",null),n.__decorate([l.tag("fs.addLocation")],r.prototype,"addLocation",null),r=n.__decorate([u.defaultPath("fields")],r)}(o._SharePointQueryableCollection);t._Fields=p,t.Fields=o.spInvokableFactory(p);var d,h,f,y,g,_,b=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r.prototype.update=function(e,t){return void 0===t&&(t="SP.Field"),n.__awaiter(this,void 0,void 0,(function(){var r;return n.__generator(this,(function(n){switch(n.label){case 0:return r=s.body(i.assign(a.metadata(t),e),s.headers({"X-HTTP-Method":"MERGE"})),[4,c.spPost(this,r)];case 1:return[2,{data:n.sent(),field:this}]}}))}))},r.prototype.setShowInDisplayForm=function(e){return c.spPost(this.clone(t.Field,"setshowindisplayform("+e+")"))},r.prototype.setShowInEditForm=function(e){return c.spPost(this.clone(t.Field,"setshowineditform("+e+")"))},r.prototype.setShowInNewForm=function(e){return c.spPost(this.clone(t.Field,"setshowinnewform("+e+")"))},n.__decorate([l.tag("f.update")],r.prototype,"update",null),n.__decorate([l.tag("f.setShowInDisplayForm")],r.prototype,"setShowInDisplayForm",null),n.__decorate([l.tag("f.setShowInEditForm")],r.prototype,"setShowInEditForm",null),n.__decorate([l.tag("f.setShowInNewForm")],r.prototype,"setShowInNewForm",null),r}(o._SharePointQueryableInstance);t._Field=b,t.Field=o.spInvokableFactory(b),function(e){e[e.Invalid=0]="Invalid",e[e.Integer=1]="Integer",e[e.Text=2]="Text",e[e.Note=3]="Note",e[e.DateTime=4]="DateTime",e[e.Counter=5]="Counter",e[e.Choice=6]="Choice",e[e.Lookup=7]="Lookup",e[e.Boolean=8]="Boolean",e[e.Number=9]="Number",e[e.Currency=10]="Currency",e[e.URL=11]="URL",e[e.Computed=12]="Computed",e[e.Threading=13]="Threading",e[e.Guid=14]="Guid",e[e.MultiChoice=15]="MultiChoice",e[e.GridChoice=16]="GridChoice",e[e.Calculated=17]="Calculated",e[e.File=18]="File",e[e.Attachments=19]="Attachments",e[e.User=20]="User",e[e.Recurrence=21]="Recurrence",e[e.CrossProjectLink=22]="CrossProjectLink",e[e.ModStat=23]="ModStat",e[e.Error=24]="Error",e[e.ContentTypeId=25]="ContentTypeId",e[e.PageSeparator=26]="PageSeparator",e[e.ThreadIndex=27]="ThreadIndex",e[e.WorkflowStatus=28]="WorkflowStatus",e[e.AllDayEvent=29]="AllDayEvent",e[e.WorkflowEventType=30]="WorkflowEventType"}(d=t.FieldTypes||(t.FieldTypes={})),function(e){e[e.DateOnly=0]="DateOnly",e[e.DateTime=1]="DateTime"}(h=t.DateTimeFieldFormatType||(t.DateTimeFieldFormatType={})),function(e){e[e.Unspecified=0]="Unspecified",e[e.Disabled=1]="Disabled",e[e.Relative=2]="Relative"}(f=t.DateTimeFieldFriendlyFormatType||(t.DateTimeFieldFriendlyFormatType={})),function(e){e[e.DefaultValue=0]="DefaultValue",e[e.AddToDefaultContentType=1]="AddToDefaultContentType",e[e.AddToNoContentType=2]="AddToNoContentType",e[e.AddToAllContentTypes=4]="AddToAllContentTypes",e[e.AddFieldInternalNameHint=8]="AddFieldInternalNameHint",e[e.AddFieldToDefaultView=16]="AddFieldToDefaultView",e[e.AddFieldCheckDisplayName=32]="AddFieldCheckDisplayName"}(t.AddFieldOptions||(t.AddFieldOptions={})),function(e){e[e.Gregorian=1]="Gregorian",e[e.Japan=3]="Japan",e[e.Taiwan=4]="Taiwan",e[e.Korea=5]="Korea",e[e.Hijri=6]="Hijri",e[e.Thai=7]="Thai",e[e.Hebrew=8]="Hebrew",e[e.GregorianMEFrench=9]="GregorianMEFrench",e[e.GregorianArabic=10]="GregorianArabic",e[e.GregorianXLITEnglish=11]="GregorianXLITEnglish",e[e.GregorianXLITFrench=12]="GregorianXLITFrench",e[e.KoreaJapanLunar=14]="KoreaJapanLunar",e[e.ChineseLunar=15]="ChineseLunar",e[e.SakaEra=16]="SakaEra",e[e.UmAlQura=23]="UmAlQura"}(y=t.CalendarType||(t.CalendarType={})),function(e){e[e.Hyperlink=0]="Hyperlink",e[e.Image=1]="Image"}(g=t.UrlFieldFormatType||(t.UrlFieldFormatType={})),function(e){e[e.PeopleAndGroups=1]="PeopleAndGroups",e[e.PeopleOnly=0]="PeopleOnly"}(t.FieldUserSelectionMode||(t.FieldUserSelectionMode={})),function(e){e[e.Dropdown=0]="Dropdown",e[e.RadioButtons=1]="RadioButtons"}(_=t.ChoiceFieldFormatType||(t.ChoiceFieldFormatType={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(3),i=r(2),a=r(8),s=r(0),u=r(6),c=r(4),l=r(5),p=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r.prototype.getById=function(e){return l.tag.configure(t.NavigationNode(this).concat("("+e+")"),"nns.getById")},r.prototype.add=function(e,r,o){return void 0===o&&(o=!0),n.__awaiter(this,void 0,void 0,(function(){var u,l;return n.__generator(this,(function(n){switch(n.label){case 0:return u=s.body(i.assign(a.metadata("SP.NavigationNode"),{IsVisible:o,Title:e,Url:r})),[4,c.spPost(this.clone(t.NavigationNodes,null),u)];case 1:return[2,{data:l=n.sent(),node:this.getById(l.Id)}]}}))}))},r.prototype.moveAfter=function(e,r){var n=s.body({nodeId:e,previousNodeId:r});return c.spPost(this.clone(t.NavigationNodes,"MoveAfter"),n)},n.__decorate([l.tag("nns.add")],r.prototype,"add",null),n.__decorate([l.tag("nns.moveAfter")],r.prototype,"moveAfter",null),r}(o._SharePointQueryableCollection);t._NavigationNodes=p,t.NavigationNodes=o.spInvokableFactory(p);var d=function(e){function r(){var t=null!==e&&e.apply(this,arguments)||this;return t.delete=o.deleteable("nn"),t}return n.__extends(r,e),Object.defineProperty(r.prototype,"children",{get:function(){return l.tag.configure(t.NavigationNodes(this,"children"),"nn.children")},enumerable:!0,configurable:!0}),r.prototype.update=function(e){return n.__awaiter(this,void 0,void 0,(function(){var t;return n.__generator(this,(function(r){switch(r.label){case 0:return t=s.body(i.assign(a.metadata("SP.NavigationNode"),e),s.headers({"X-HTTP-Method":"MERGE"})),[4,c.spPost(this,t)];case 1:return[2,{data:r.sent(),node:this}]}}))}))},n.__decorate([l.tag("nn.update")],r.prototype,"update",null),r}(o._SharePointQueryableInstance);t._NavigationNode=d,t.NavigationNode=o.spInvokableFactory(d);var h=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),Object.defineProperty(r.prototype,"quicklaunch",{get:function(){return l.tag.configure(t.NavigationNodes(this,"quicklaunch"),"n.quicklaunch")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"topNavigationBar",{get:function(){return l.tag.configure(t.NavigationNodes(this,"topnavigationbar"),"n.topnavigationbar")},enumerable:!0,configurable:!0}),r=n.__decorate([u.defaultPath("navigation")],r)}(o._SharePointQueryable);t._Navigation=h,t.Navigation=o.spInvokableFactory(h);var f=function(e){function r(t){return void 0===t&&(t=null),e.call(this,"_api/navigation",t)||this}return n.__extends(r,e),r.prototype.getMenuState=function(e,r,n,o){return void 0===e&&(e=null),void 0===r&&(r=10),void 0===n&&(n=null),void 0===o&&(o=null),c.spPost(t.NavigationService("MenuState"),s.body({customProperties:o,depth:r,mapProviderName:n,menuNodeKey:e}))},r.prototype.getMenuNodeKey=function(e,r){return void 0===r&&(r=null),c.spPost(t.NavigationService("MenuNodeKey"),s.body({currentUrl:e,mapProviderName:r}))},n.__decorate([l.tag("ns.getMenuState")],r.prototype,"getMenuState",null),n.__decorate([l.tag("ns.getMenuNodeKey")],r.prototype,"getMenuNodeKey",null),r}(o._SharePointQueryable);t._NavigationService=f,t.NavigationService=function(e){return new f(e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(3),i=r(2),a=r(8),s=r(0),u=r(4),c=r(6),l=r(5),p=new Map([["text","Querytext"],["template","QueryTemplate"],["sourceId","SourceId"],["trimDuplicatesIncludeId",""],["startRow",""],["rowLimit",""],["rankingModelId",""],["rowsPerPage",""],["selectProperties",""],["culture",""],["timeZoneId",""],["refinementFilters",""],["refiners",""],["hiddenConstraints",""],["sortList",""],["timeout",""],["hithighlightedProperties",""],["clientType",""],["personalizationData",""],["resultsURL",""],["queryTag",""],["properties",""],["queryTemplatePropertiesUrl",""],["reorderingRules",""],["hitHighlightedMultivaluePropertyLimit",""],["collapseSpecification",""],["uiLanguage",""],["desiredSnippetLength",""],["maxSnippetLength",""],["summaryLength",""]]),d=new Map([]);function h(e){return e.replace(/^(.)/,(function(e){return e.toUpperCase()}))}t.SearchQueryBuilder=function(e,t){return void 0===e&&(e=""),void 0===t&&(t={}),new Proxy({query:Object.assign({Querytext:e},t)},{get:function(e,t,r){var n=t.toString();if("toSearchQuery"===n)return function(){return e.query};if(p.has(n))return function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];var i=p.get(n);return e.query[i.length>0?i:h(n)]=t.length>1?t:t[0],r};var o=d.has(n)?d.get(n):h(n);return e.query[o]=!0,r}})};var f=/_api\/search\/postquery$/i,y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.execute=function(e){return n.__awaiter(this,void 0,void 0,(function(){var t,r,o,c;return n.__generator(this,(function(n){switch(n.label){case 0:return t=this.parseQuery(e),r=s.body({request:i.assign(a.metadata("Microsoft.Office.Server.Search.REST.SearchRequest"),Object.assign({},t,{HitHighlightedProperties:this.fixArrProp(t.HitHighlightedProperties),Properties:this.fixArrProp(t.Properties),RefinementFilters:this.fixArrProp(t.RefinementFilters),ReorderingRules:this.fixArrProp(t.ReorderingRules),SelectProperties:this.fixArrProp(t.SelectProperties),SortList:this.fixArrProp(t.SortList)}))}),this.data.useCaching&&(this._forceCaching=!0,o="PnPjs.SearchWithCaching("+i.getHashCode(r.body)+")",i.objectDefinedNotNull(this.data.cachingOptions)?f.test(this.data.cachingOptions.key)&&(this.data.cachingOptions.key=o):this.data.cachingOptions=new s.CachingOptions(o)),[4,u.spPost(this,r)];case 1:return c=n.sent(),[2,new g(c,this.toUrl(),t)]}}))}))},t.prototype.fixArrProp=function(e){return void 0===e?{results:[]}:{results:i.isArray(e)?e:[e]}},t.prototype.parseQuery=function(e){return"string"==typeof e?{Querytext:e}:e.toSearchQuery?e.toSearchQuery():e},n.__decorate([l.tag("se.execute")],t.prototype,"execute",null),t=n.__decorate([c.defaultPath("_api/search/postquery")],t)}(o._SharePointQueryableInstance);t._Search=y,t.Search=function(e,t){return void 0===t&&(t={}),function(r){return new y(e).configure(t).execute(r)}};var g=function(){function e(e,t,r,n,o){void 0===n&&(n=null),void 0===o&&(o=null),this._url=t,this._query=r,this._raw=n,this._primary=o,this._url=this._url.replace(f,""),this._raw=e.postquery?e.postquery:e}return Object.defineProperty(e.prototype,"ElapsedTime",{get:function(){return this.RawSearchResults.ElapsedTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RowCount",{get:function(){return this.RawSearchResults.PrimaryQueryResult.RelevantResults.RowCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TotalRows",{get:function(){return this.RawSearchResults.PrimaryQueryResult.RelevantResults.TotalRows},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TotalRowsIncludingDuplicates",{get:function(){return this.RawSearchResults.PrimaryQueryResult.RelevantResults.TotalRowsIncludingDuplicates},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RawSearchResults",{get:function(){return this._raw},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"PrimarySearchResults",{get:function(){return null===this._primary&&(this._primary=this.formatSearchResults(this._raw.PrimaryQueryResult.RelevantResults.Table.Rows)),this._primary},enumerable:!0,configurable:!0}),e.prototype.getPage=function(e,r){if(this.TotalRows<this.RowCount)return Promise.resolve(null);var n=void 0!==r?r:i.hOP(this._query,"RowLimit")?this._query.RowLimit:10,o=i.assign(this._query,{RowLimit:n,StartRow:n*(e-1)});return o.StartRow>this.TotalRows?Promise.resolve(null):t.Search(this._url)(o)},e.prototype.formatSearchResults=function(e){var t,r,o=new Array,i=e.results?e.results:e;try{for(var a=n.__values(i),s=a.next();!s.done;s=a.next()){var u=s.value,c=u.Cells.results?u.Cells.results:u.Cells;o.push(c.reduce((function(e,t){return Reflect.defineProperty(e,t.Key,{configurable:!1,enumerable:!0,value:t.Value,writable:!1}),e}),{}))}}catch(e){t={error:e}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}return o},e}();t.SearchResults=g},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(3),i=r(34),a=r(2),s=r(8),u=r(0),c=r(6),l=r(4),p=r(5),d=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r.prototype.getById=function(e){return p.tag.configure(t.SiteUser(this,"getById("+e+")"),"sus.getById")},r.prototype.getByEmail=function(e){return p.tag.configure(t.SiteUser(this,"getByEmail('"+e+"')"),"sus.getByEmail")},r.prototype.getByLoginName=function(e){return p.tag.configure(t.SiteUser(this).concat("('!@v::"+encodeURIComponent(e)+"')"),"sus.getByLoginName")},r.prototype.removeById=function(e){return l.spPost(this.clone(t.SiteUsers,"removeById("+e+")"))},r.prototype.removeByLoginName=function(e){var r=this.clone(t.SiteUsers,"removeByLoginName(@v)");return r.query.set("@v","'"+encodeURIComponent(e)+"'"),l.spPost(r)},r.prototype.add=function(e){return n.__awaiter(this,void 0,void 0,(function(){return n.__generator(this,(function(r){switch(r.label){case 0:return[4,l.spPost(this.clone(t.SiteUsers,null),u.body(a.assign(s.metadata("SP.User"),{LoginName:e})))];case 1:return r.sent(),[2,this.getByLoginName(e)]}}))}))},n.__decorate([p.tag("sus.remId")],r.prototype,"removeById",null),n.__decorate([p.tag("sus.remLoginName")],r.prototype,"removeByLoginName",null),n.__decorate([p.tag("sus.add")],r.prototype,"add",null),r=n.__decorate([c.defaultPath("siteusers")],r)}(o._SharePointQueryableCollection);t._SiteUsers=d,t.SiteUsers=o.spInvokableFactory(d);var h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.delete=o.deleteable("su"),t.update=t._update("SP.User",(function(e){return{data:e,user:t}})),t}return n.__extends(t,e),Object.defineProperty(t.prototype,"groups",{get:function(){return p.tag.configure(i.SiteGroups(this,"groups"),"su.groups")},enumerable:!0,configurable:!0}),t}(o._SharePointQueryableInstance);t._SiteUser=h,t.SiteUser=o.spInvokableFactory(h)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(25),i=r(3),a=r(2),s=r(4);function u(e){return n.__awaiter(this,void 0,void 0,(function(){var t,r;return n.__generator(this,(function(n){switch(n.label){case 0:return(t=this.clone(i.SharePointQueryableInstance,"getUserEffectivePermissions(@user)")).query.set("@user","'"+encodeURIComponent(e)+"'"),[4,t.get()];case 1:return r=n.sent(),[2,a.hOP(r,"GetUserEffectivePermissions")?r.GetUserEffectivePermissions:r]}}))}))}function c(){return n.__awaiter(this,void 0,void 0,(function(){var e;return n.__generator(this,(function(t){switch(t.label){case 0:return[4,i.SharePointQueryableInstance("_api/web","currentuser").configureFrom(this).select("LoginName")()];case 1:return e=t.sent(),[2,u.call(this,e.LoginName)]}}))}))}t.getUserEffectivePermissions=u,t.getCurrentUserEffectivePermissions=c,t.breakRoleInheritance=function(e,t){return void 0===e&&(e=!1),void 0===t&&(t=!1),n.__awaiter(this,void 0,void 0,(function(){return n.__generator(this,(function(r){switch(r.label){case 0:return[4,s.spPost(this.clone(i.SharePointQueryable,"breakroleinheritance(copyroleassignments="+e+", clearsubscopes="+t+")"))];case 1:return r.sent(),[2]}}))}))},t.resetRoleInheritance=function(){return n.__awaiter(this,void 0,void 0,(function(){return n.__generator(this,(function(e){switch(e.label){case 0:return[4,s.spPost(this.clone(i.SharePointQueryable,"resetroleinheritance"))];case 1:return e.sent(),[2]}}))}))},t.userHasPermissions=function(e,t){return n.__awaiter(this,void 0,void 0,(function(){var r;return n.__generator(this,(function(n){switch(n.label){case 0:return[4,u.call(this,e)];case 1:return r=n.sent(),[2,this.hasPermissions(r,t)]}}))}))},t.currentUserHasPermissions=function(e){return n.__awaiter(this,void 0,void 0,(function(){var t;return n.__generator(this,(function(r){switch(r.label){case 0:return[4,c.call(this)];case 1:return t=r.sent(),[2,this.hasPermissions(t,e)]}}))}))},t.hasPermissions=function(e,t){if(!t)return!0;if(t===o.PermissionKind.FullMask)return 32767==(32767&e.High)&&65535===e.Low;var r=1;return(t-=1)>=0&&t<32?(r<<=t,0!=(e.Low&r)):t>=32&&t<64&&(r<<=t-32,0!=(e.High&r))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(0),i=r(2),a=r(3),s=r(12),u=r(7),c=r(26),l=r(4),p=r(5),d=r(25);function h(e,t){var r=p.tag.configure(u.Web(s.extractWebUrl(e.toUrl()),"/_api/SP.Web.ShareObject"),"sh.sendShareObjectRequest");return l.spPost(r.expand("UsersWithAccessRequests","GroupsSharedWith"),o.body(t))}function f(e,t){return n.__awaiter(this,void 0,void 0,(function(){var r,o;return n.__generator(this,(function(n){switch(n.label){case 0:if(null==t)return[3,7];switch(t){case c.RoleType.Contributor:return[3,1];case c.RoleType.Reader:case c.RoleType.Guest:return[3,3]}return[3,5];case 1:return[4,u.Web("_api/web","associatedmembergroup").select("Id")()];case 2:return[2,"group: "+n.sent().Id];case 3:return[4,u.Web("_api/web","associatedvisitorgroup").select("Id")()];case 4:return[2,"group: "+n.sent().Id];case 5:throw Error("Could not determine role value for supplied value. Contributor, Reader, and Guest are supported");case 6:return[3,9];case 7:return r=e===c.SharingRole.Edit?c.RoleType.Contributor:c.RoleType.Reader,[4,d.RoleDefinitions("_api/web").select("Id").top(1).filter("RoleTypeKind eq "+r)()];case 8:if((o=n.sent()).length<1)throw Error("Could not locate associated role definition for supplied role. Edit and View are supported");return[2,"role: "+o[0].Id];case 9:return[2]}}))}))}t.shareObject=function(e,t,r){return void 0===r&&(r=!1),n.__awaiter(this,void 0,void 0,(function(){var o,a,s;return n.__generator(this,(function(n){switch(n.label){case 0:return r?[2,h(e,t)]:[4,f((t=i.assign(t,{group:null,includeAnonymousLinkInEmail:!1,propagateAcl:!1,useSimplifiedRoles:!0},!0)).role,t.group)];case 1:return o=n.sent(),Array.isArray(t.loginNames)||(t.loginNames=[t.loginNames]),a=i.jsS(t.loginNames.map((function(e){return{Key:e}}))),s={peoplePickerInput:a,roleValue:o,url:t.url},void 0!==t.emailData&&null!==t.emailData&&(s=i.assign(s,{emailBody:t.emailData.body,emailSubject:void 0!==t.emailData.subject?t.emailData.subject:"Shared with you.",sendEmail:!0})),[2,h(e,s)]}}))}))},t.getShareLink=function(e,t){void 0===t&&(t=null);var r=null!==t?t.toISOString():null,n=p.tag.configure(this.clone(a.SharePointQueryableInstance,"shareLink"),"sh.getShareLink");return l.spPost(n,o.body({request:{createLink:!0,emailData:null,settings:{expiration:r,linkKind:e}}}))},t.checkPermissions=function(e){var t=p.tag.configure(this.clone(a.SharePointQueryableInstance,"checkPermissions"),"sh.checkPermissions");return l.spPost(t,o.body({recipients:e}))},t.getSharingInformation=function(e,t){void 0===e&&(e=null),void 0===t&&(t=[]);var r=p.tag.configure(this.clone(a.SharePointQueryableInstance,"getSharingInformation"),"sh.getSharingInformation");return l.spPost(r.expand.apply(r,n.__spread(t)),o.body({request:e}))},t.getObjectSharingSettings=function(e){void 0===e&&(e=!0);var t=p.tag.configure(this.clone(a.SharePointQueryableInstance,"getObjectSharingSettings"),"sh.getObjectSharingSettings");return l.spPost(t,o.body({useSimplifiedRoles:e}))},t.unshareObject=function(){return l.spPost(p.tag.configure(this.clone(a.SharePointQueryableInstance,"unshareObject"),"sh.unshareObject"))},t.deleteLinkByKind=function(e){return l.spPost(p.tag.configure(this.clone(a.SharePointQueryableInstance,"deleteLinkByKind"),"sh.deleteLinkByKind"),o.body({linkKind:e}))},t.unshareLink=function(e,t){return void 0===t&&(t="00000000-0000-0000-0000-000000000000"),l.spPost(p.tag.configure(this.clone(a.SharePointQueryableInstance,"unshareLink"),"sh.unshareLink"),o.body({linkKind:e,shareId:t}))},t.shareWith=function(e,t,r,s,u,d){return void 0===s&&(s=!1),void 0===u&&(u=!1),n.__awaiter(this,void 0,void 0,(function(){var h,f,y,g;return n.__generator(this,(function(n){switch(n.label){case 0:return Array.isArray(t)||(t=[t]),h=i.jsS(t.map((function(e){return{Key:e}}))),f=r===c.SharingRole.Edit?c.RoleType.Contributor:c.RoleType.Reader,[4,a.SharePointQueryableCollection("_api/web","roledefinitions").select("Id").filter("RoleTypeKind eq "+f).get()];case 1:if(y=n.sent(),!Array.isArray(y)||y.length<1)throw Error("Could not locate a role defintion with RoleTypeKind "+f);return g={includeAnonymousLinkInEmail:s,peoplePickerInput:h,propagateAcl:u,roleValue:"role:"+y[0].Id,useSimplifiedRoles:!0},void 0!==d&&(g=i.assign(g,{emailBody:d.body,emailSubject:void 0!==d.subject?d.subject:"",sendEmail:!0})),[2,l.spPost(p.tag.configure(e.clone(a.SharePointQueryableInstance,"shareObject"),"sh.shareWith"),o.body(g))]}}))}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(3),i=r(12),a=r(0),s=r(4),u=r(2),c=r(5),l=function(e){function t(t,r){void 0===r&&(r="");var n="string"==typeof t?t:t.toUrl();return e.call(this,i.extractWebUrl(n),"_api/Microsoft.Sharepoint.Utilities.WebTemplateExtensions.SiteScriptUtility."+r)||this}return n.__extends(t,e),t.prototype.execute=function(e){return s.spPost(this,a.body(e,a.headers({"Content-Type":"application/json;charset=utf-8"})))},t.prototype.createSiteDesign=function(e){return this.clone(p,"CreateSiteDesign").execute({info:e})},t.prototype.applySiteDesign=function(e,t){return this.clone(p,"ApplySiteDesign").execute({siteDesignId:e,webUrl:t})},t.prototype.getSiteDesigns=function(){return this.clone(p,"GetSiteDesigns").execute({})},t.prototype.getSiteDesignMetadata=function(e){return this.clone(p,"GetSiteDesignMetadata").execute({id:e})},t.prototype.updateSiteDesign=function(e){return this.clone(p,"UpdateSiteDesign").execute({updateInfo:e})},t.prototype.deleteSiteDesign=function(e){return this.clone(p,"DeleteSiteDesign").execute({id:e})},t.prototype.getSiteDesignRights=function(e){return this.clone(p,"GetSiteDesignRights").execute({id:e})},t.prototype.grantSiteDesignRights=function(e,t,r){return void 0===r&&(r=1),this.clone(p,"GrantSiteDesignRights").execute({grantedRights:r.toString(),id:e,principalNames:t})},t.prototype.revokeSiteDesignRights=function(e,t){return this.clone(p,"RevokeSiteDesignRights").execute({id:e,principalNames:t})},t.prototype.addSiteDesignTask=function(e,t){return this.clone(p,"AddSiteDesignTask").execute({webUrl:e,siteDesignId:t})},t.prototype.addSiteDesignTaskToCurrentWeb=function(e){return this.clone(p,"AddSiteDesignTaskToCurrentWeb").execute({siteDesignId:e})},t.prototype.getSiteDesignTask=function(e){return n.__awaiter(this,void 0,void 0,(function(){var t;return n.__generator(this,(function(r){switch(r.label){case 0:return[4,this.clone(p,"GetSiteDesignTask").execute({taskId:e})];case 1:return t=r.sent(),[2,u.hOP(t,"ID")?t:null]}}))}))},t.prototype.getSiteDesignRun=function(e,t){return this.clone(p,"GetSiteDesignRun").execute({webUrl:e,siteDesignId:t})},t.prototype.getSiteDesignRunStatus=function(e,t){return this.clone(p,"GetSiteDesignRunStatus").execute({webUrl:e,runId:t})},n.__decorate([c.tag("sd.createSiteDesign")],t.prototype,"createSiteDesign",null),n.__decorate([c.tag("sd.applySiteDesign")],t.prototype,"applySiteDesign",null),n.__decorate([c.tag("sd.getSiteDesigns")],t.prototype,"getSiteDesigns",null),n.__decorate([c.tag("sd.getSiteDesignMetadata")],t.prototype,"getSiteDesignMetadata",null),n.__decorate([c.tag("sd.updateSiteDesign")],t.prototype,"updateSiteDesign",null),n.__decorate([c.tag("sd.deleteSiteDesign")],t.prototype,"deleteSiteDesign",null),n.__decorate([c.tag("sd.getSiteDesignRights")],t.prototype,"getSiteDesignRights",null),n.__decorate([c.tag("sd.grantSiteDesignRights")],t.prototype,"grantSiteDesignRights",null),n.__decorate([c.tag("sd.revokeSiteDesignRights")],t.prototype,"revokeSiteDesignRights",null),n.__decorate([c.tag("sd.addSiteDesignTask")],t.prototype,"addSiteDesignTask",null),n.__decorate([c.tag("sd.addSiteDesignTaskToCurrentWeb")],t.prototype,"addSiteDesignTaskToCurrentWeb",null),n.__decorate([c.tag("sd.getSiteDesignTask")],t.prototype,"getSiteDesignTask",null),n.__decorate([c.tag("sd.getSiteDesignRun")],t.prototype,"getSiteDesignRun",null),n.__decorate([c.tag("sd.getSiteDesignRunStatus")],t.prototype,"getSiteDesignRunStatus",null),t}(o._SharePointQueryable);t._SiteDesigns=l,t.SiteDesigns=function(e,t){return new l(e,t)};var p=function(e,r){return void 0===r&&(r=""),t.SiteDesigns(e,r)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(0),i=r(9),a=r(11),s=r(10),u=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),Object.defineProperty(r.prototype,"threads",{get:function(){return t.Threads(this)},enumerable:!0,configurable:!0}),r=n.__decorate([a.updateable(),a.deleteable()],r)}(i._GraphQueryableInstance);t._Conversation=u,t.Conversation=i.graphInvokableFactory(u);var c=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r=n.__decorate([a.defaultPath("conversations"),a.addable(),a.getById(t.Conversation)],r)}(i._GraphQueryableCollection);t._Conversations=c,t.Conversations=i.graphInvokableFactory(c);var l=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),Object.defineProperty(r.prototype,"posts",{get:function(){return t.Posts(this)},enumerable:!0,configurable:!0}),r.prototype.reply=function(e){return s.graphPost(this.clone(t.Thread,"reply"),o.body(e))},r=n.__decorate([a.deleteable()],r)}(i._GraphQueryableInstance);t._Thread=l,t.Thread=i.graphInvokableFactory(l);var p=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r=n.__decorate([a.defaultPath("threads"),a.addable(),a.getById(t.Thread)],r)}(i._GraphQueryableCollection);t._Threads=p,t.Threads=i.graphInvokableFactory(p);var d=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r.prototype.forward=function(e){return s.graphPost(this.clone(t.Post,"forward"),o.body(e))},r.prototype.reply=function(e){return s.graphPost(this.clone(t.Post,"reply"),o.body(e))},r=n.__decorate([a.deleteable()],r)}(i._GraphQueryableInstance);t._Post=d,t.Post=i.graphInvokableFactory(d);var h=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r=n.__decorate([a.defaultPath("posts"),a.addable(),a.getById(t.Post)],r)}(i._GraphQueryableCollection);t._Posts=h,t.Posts=i.graphInvokableFactory(h);var f=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r.prototype.add=function(e){return s.graphPost(this.clone(t.Senders,"$ref"),o.body({"@odata.id":e}))},r.prototype.remove=function(e){var r=this.clone(t.Senders,"$ref");return r.query.set("$id",e),s.graphDelete(r)},r}(i._GraphQueryableCollection);t._Senders=f,t.Senders=i.graphInvokableFactory(f)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(9),i=r(0),a=r(2),s=r(11),u=r(10),c=r(11),l=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),Object.defineProperty(r.prototype,"channels",{get:function(){return t.Channels(this)},enumerable:!0,configurable:!0}),r.prototype.archive=function(e){return void 0===e&&(e=!1),u.graphPost(this.clone(t.Team,"archive"),i.body({shouldSetSpoSiteReadOnlyForMembers:e}))},r.prototype.unarchive=function(){return u.graphPost(this.clone(t.Team,"unarchive"))},r.prototype.cloneTeam=function(e,r,n,o){void 0===r&&(r=""),void 0===n&&(n="apps,tabs,settings,channels,members"),void 0===o&&(o="private");var a={description:r||"",displayName:e,mailNickname:e,partsToClone:n,visibility:o};return u.graphPost(this.clone(t.Team,"clone"),i.body(a))},r=n.__decorate([c.defaultPath("team"),s.updateable()],r)}(o._GraphQueryableInstance);t._Team=l,t.Team=o.graphInvokableFactory(l);var p=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r=n.__decorate([c.defaultPath("teams"),s.getById(t.Team)],r)}(o._GraphQueryableCollection);t._Teams=p,t.Teams=o.graphInvokableFactory(p);var d=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),Object.defineProperty(r.prototype,"tabs",{get:function(){return t.Tabs(this)},enumerable:!0,configurable:!0}),r}(o._GraphQueryableInstance);t._Channel=d,t.Channel=o.graphInvokableFactory(d);var h=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r.prototype.add=function(e,t){return void 0===t&&(t=""),n.__awaiter(this,void 0,void 0,(function(){var r,o;return n.__generator(this,(function(n){switch(n.label){case 0:return r={description:t,displayName:e},[4,u.graphPost(this,i.body(r))];case 1:return o=n.sent(),[2,{channel:this.getById(o.id),data:o}]}}))}))},r=n.__decorate([c.defaultPath("channels"),s.getById(t.Channel)],r)}(o._GraphQueryableCollection);t._Channels=h,t.Channels=o.graphInvokableFactory(h);var f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t=n.__decorate([c.defaultPath("tab"),s.updateable(),s.deleteable()],t)}(o._GraphQueryableInstance);t._Tab=f,t.Tab=o.graphInvokableFactory(f);var y=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r.prototype.add=function(e,t,r){return n.__awaiter(this,void 0,void 0,(function(){var o,s;return n.__generator(this,(function(n){switch(n.label){case 0:return o=a.assign({name:e,"teamsApp@odata.bind":t},r),[4,u.graphPost(this,i.body(o))];case 1:return[2,{data:s=n.sent(),tab:this.getById(s.id)}]}}))}))},r=n.__decorate([c.defaultPath("tabs"),s.getById(t.Tab)],r)}(o._GraphQueryableCollection);t._Tabs=y,t.Tabs=o.graphInvokableFactory(y)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(27).isFunc(Object.entries)?Object.entries:function(e){return Object.keys(e).map((function(t){return[t,e[t]]}))};t.objectToMap=function(e){return null!=e?new Map(n(e)):new Map},t.mergeMaps=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];for(var n=0;n<t.length;n++)t[n].forEach((function(t,r){e.set(r,t)}));return e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(54);t.setup=function(e){t.RuntimeConfig.assign(e)};var o=["defaultCachingStore","defaultCachingTimeoutSeconds","globalCacheDisable","enableCacheExpiration","cacheExpirationIntervalMilliseconds","spfxContext","ie11"],i=function(){function e(e){void 0===e&&(e=new Map),this._v=e,this._v.set(o[0],"session"),this._v.set(o[1],60),this._v.set(o[2],!1),this._v.set(o[3],!1),this._v.set(o[4],750),this._v.set(o[5],null),this._v.set(o[6],!1)}return e.prototype.assign=function(e){this._v=n.mergeMaps(this._v,n.objectToMap(e))},e.prototype.get=function(e){return this._v.get(e)},Object.defineProperty(e.prototype,"defaultCachingStore",{get:function(){return this.get(o[0])},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"defaultCachingTimeoutSeconds",{get:function(){return this.get(o[1])},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"globalCacheDisable",{get:function(){return this.get(o[2])},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableCacheExpiration",{get:function(){return this.get(o[3])},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cacheExpirationIntervalMilliseconds",{get:function(){return this.get(o[4])},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spfxContext",{get:function(){return this.get(o[5])},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ie11",{get:function(){var e=this.get(o[6]);return e&&console.warn("PnPjs is running in ie11 compat mode. Not all features may work as expected."),e},enumerable:!0,configurable:!0}),e}();t.RuntimeConfigImpl=i;var a=new i;t.RuntimeConfig=a},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1);n.__exportStar(r(149),t),n.__exportStar(r(150),t)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),o=function(){function e(e,t,r){this.wrappedProvider=e,this.cacheKey=t,this.wrappedProvider=e,this.store=r||this.selectPnPCache()}return e.prototype.getWrappedProvider=function(){return this.wrappedProvider},e.prototype.getConfiguration=function(){var e=this;return this.store&&this.store.enabled?this.store.getOrPut(this.cacheKey,(function(){return e.wrappedProvider.getConfiguration().then((function(t){return e.store.put(e.cacheKey,t),t}))})):this.wrappedProvider.getConfiguration()},e.prototype.selectPnPCache=function(){var e=new n.PnPClientStorage;if(e.local&&e.local.enabled)return e.local;if(e.session&&e.session.enabled)return e.session;throw Error("Cannot create a caching configuration provider since cache is not available.")},e}();t.default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(0),i=r(7),a=r(13),s=r(15),u=r(3),c=r(17);o.addProp(i._Web,"lists",a.Lists),o.addProp(i._Web,"siteUserInfoList",a.List,"siteuserinfolist"),o.addProp(i._Web,"defaultDocumentLibrary",a.List,"DefaultDocumentLibrary"),o.addProp(i._Web,"customListTemplates",u.SharePointQueryableCollection,"getcustomlisttemplates"),i._Web.prototype.getList=function(e){return a.List(this,"getList('"+c.escapeQueryStrValue(e)+"')")},i._Web.prototype.getCatalog=function(e){return n.__awaiter(this,void 0,void 0,(function(){var t;return n.__generator(this,(function(r){switch(r.label){case 0:return[4,this.clone(i.Web,"getcatalog("+e+")").select("Id").get()];case 1:return t=r.sent(),[2,a.List(s.odataUrlFrom(t))]}}))}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),o=function(){function e(e,t,r){void 0===t&&(t=n.RuntimeConfig.defaultCachingStore),void 0===r&&(r=n.dateAdd(new Date,"second",n.RuntimeConfig.defaultCachingTimeoutSeconds)),this.key=e,this.storeName=t,this.expiration=r}return Object.defineProperty(e.prototype,"store",{get:function(){return"local"===this.storeName?e.storage.local:e.storage.session},enumerable:!0,configurable:!0}),e.storage=new n.PnPClientStorage,e}();t.CachingOptions=o;var i=function(){function e(e,t){this.parser=e,this.cacheOptions=t}return e.prototype.parse=function(e){var t=this;return this.parser.parse(e).then((function(e){return t.cacheData(e)}))},e.prototype.cacheData=function(e){return null!==this.cacheOptions.store&&this.cacheOptions.store.put(this.cacheOptions.key,e,this.cacheOptions.expiration),e},e}();t.CachingParserWrapper=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(2),i=!1,a=[],s=Symbol("__extensions");function u(e,t){o.isArray(t)?e.push.apply(e,n.__spread(t)):e.push(t)}t.extendGlobal=function(e){i=!0,u(a,e)},t.extendObj=function(e,t){return i=!0,Reflect.has(e,s)||Reflect.set(e,s,[]),u(Reflect.get(e,s),t),e},t.extendFactory=function(e,t){i=!0,void 0===e.__proto__[s]&&(e.__proto__[s]=[]),u(e.__proto__[s],t)},t.clearGlobalExtensions=function(){a.length=0},t.disableExtensions=function(){i=!1},t.enableExtensions=function(){i=!0},t.applyFactoryExtensions=function(e,r){var n=e(r);return e.__proto__[s]&&(n=t.extendObj(n,e.__proto__[s])),n},t.extensionOrDefault=function(e,t,r){for(var u=[],c=3;c<arguments.length;c++)u[c-3]=arguments[c];if(i){var l=[];Reflect.has(r,s)&&l.push.apply(l,n.__spread(Reflect.get(r,s))),l.push.apply(l,n.__spread(a));for(var p=0;p<l.length;p++){var d=l[p],h=void 0;if(o.isFunc(d)?h=d.apply(void 0,n.__spread([e,r],u)):"get"===e&&Reflect.has(d,u[0])?h=Reflect.get(d,u[0],r):Reflect.has(d,e)&&(h=Reflect.get(d,e).apply(void 0,n.__spread([r],u))),void 0!==h)return h}}return t.apply(void 0,n.__spread([r],u))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(2),i=r(39);function a(e){var t=JSON.stringify(e,(function(e,t){switch(e){case"query":return JSON.stringify(n.__spread(t));case"batch":case"batchDependency":case"cachingOptions":case"clientFactory":case"parser":return"-";default:return t}}),0),r=JSON.parse(t,(function(t,r){switch(t){case"query":return new Map(JSON.parse(r));case"batch":return e.batch;case"batchDependency":return e.batchDependency;case"cachingOptions":return e.cachingOptions;case"clientFactory":return e.clientFactory;case"parser":return e.parser;default:return r}}));return e.options&&e.options.body&&(r.options.body=e.options.body),r}t.cloneQueryableData=a;var s=function(){function e(e){void 0===e&&(e={}),this._data=Object.assign({},{cloneParentWasCaching:!1,options:{},parentUrl:"",parser:new i.ODataParser,query:new Map,url:"",useCaching:!1},a(e))}return Object.defineProperty(e.prototype,"data",{get:function(){return this._data},set:function(e){this._data=Object.assign({},a(this.data),a(e))},enumerable:!0,configurable:!0}),e.prototype.toUrl=function(){return this.data.url},e.prototype.concat=function(e){return this.data.url+=e,this},Object.defineProperty(e.prototype,"query",{get:function(){return this.data.query},enumerable:!0,configurable:!0}),e.prototype.configure=function(e){return o.mergeOptions(this.data.options,e),this},e.prototype.configureFrom=function(e){return o.mergeOptions(this.data.options,e.data.options),this},e.prototype.usingCaching=function(e){return o.RuntimeConfig.globalCacheDisable||(this.data.useCaching=!0,void 0!==e&&(this.data.cachingOptions=e)),this},e.prototype.usingParser=function(e){return this.data.parser=e,this},e.prototype.withPipeline=function(e){return this.data.pipes=e.slice(0),this},e.prototype.append=function(e){this.data.url=o.combine(this.data.url,e)},e.prototype.inBatch=function(e){if(null!==this.batch)throw Error("This query is already part of a batch.");return o.objectDefinedNotNull(e)&&(this.data.batch=e),this},e.prototype.addBatchDependency=function(){return o.objectDefinedNotNull(this.data.batch)?this.data.batch.addDependency():function(){return null}},Object.defineProperty(e.prototype,"hasBatch",{get:function(){return o.objectDefinedNotNull(this.data.batch)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"batch",{get:function(){return this.hasBatch?this.data.batch:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parentUrl",{get:function(){return this.data.parentUrl},enumerable:!0,configurable:!0}),e.prototype.cloneTo=function(e,t){return void 0===t&&(t={includeBatch:!0}),e.data=Object.assign({},a(this.data),{batch:null,cloneParentCacheOptions:null,cloneParentWasCaching:!1},a(e.data)),e.configureFrom(this),t.includeBatch&&e.inBatch(this.batch),this.data.useCaching&&(e.data.cloneParentWasCaching=!0,e.data.cloneParentCacheOptions=this.data.cachingOptions),e},e}();t.Queryable=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(2),i=r(18),a=r(60);function s(e,t){return new Promise((function(r){e.result=t,e.hasResult=!0,r(e)}))}function u(e){return e.pipes.length>0?e.pipes.shift()(e):Promise.resolve(e)}function c(e){return void 0===e&&(e=!1),function(t,r,n){var a=n.value;n.value=function(){for(var n=[],s=0;s<arguments.length;s++)n[s]=arguments[s];return!e&&n.length>0&&o.hOP(n[0],"hasResult")&&n[0].hasResult?(i.Logger.write("["+n[0].requestId+"] ("+(new Date).getTime()+") Skipping request pipeline method "+r+", existing result in pipeline.",0),Promise.resolve(n[0])):(i.Logger.write("["+n[0].requestId+"] ("+(new Date).getTime()+") Calling request pipeline method "+r+".",0),a.apply(t,n).then((function(e){return u(e)})))}}}t.setResult=s,t.pipe=function(e){if(e.pipes.length<1)throw i.Logger.write("["+e.requestId+"] ("+(new Date).getTime()+") Request pipeline contains no methods!",3),Error("Request pipeline contains no methods!");var t=u(e).then((function(e){return function(e){return i.Logger.log({data:0===i.Logger.activeLogLevel?e.result:{},level:1,message:"["+e.requestId+"] ("+(new Date).getTime()+") Returning result from pipeline. Set logging to verbose to see data."}),Promise.resolve(e.result)}(e)})).catch((function(e){throw i.Logger.error(e),e}));return e.isBatched&&e.batch.addResolveBatchDependency(t),t},t.requestPipelineMethod=c;var l=function(){function e(){}return e.logStart=function(e){return new Promise((function(t){i.Logger.log({data:1===i.Logger.activeLogLevel?{}:e,level:1,message:"["+e.requestId+"] ("+(new Date).getTime()+") Beginning "+e.method+" request ("+e.url+")"}),t(e)}))},e.caching=function(e){return new Promise((function(t){if(e.useCaching){i.Logger.write("["+e.requestId+"] ("+(new Date).getTime()+") Caching is enabled for request, checking cache...",1);var r=new a.CachingOptions(e.url.toLowerCase());if(void 0!==e.cachingOptions&&(r=o.assign(r,e.cachingOptions)),null!==r.store){var n=r.store.get(r.key);if(null!==n)return i.Logger.log({data:1===i.Logger.activeLogLevel?{}:n,level:1,message:"["+e.requestId+"] ("+(new Date).getTime()+") Value returned from cache."}),o.isFunc(e.batchDependency)&&e.batchDependency(),o.hOP(e.parser,"hydrate")&&(n=e.parser.hydrate(n)),s(e,n).then((function(e){return t(e)}))}i.Logger.write("["+e.requestId+"] ("+(new Date).getTime()+") Value not found in cache.",1),e.parser=new a.CachingParserWrapper(e.parser,r)}return t(e)}))},e.send=function(e){return new Promise((function(t,r){if(e.isBatched){var n=e.batch.add(e.url,e.method,e.options,e.parser,e.requestId);o.isFunc(e.batchDependency)&&e.batchDependency(),i.Logger.write("["+e.requestId+"] ("+(new Date).getTime()+") Batching request in batch "+e.batch.batchId+".",1),t(s(e,n))}else{i.Logger.write("["+e.requestId+"] ("+(new Date).getTime()+") Sending request.",1);var a=e.clientFactory(),u=o.assign(e.options||{},{method:e.method});a.fetch(e.url,u).then((function(t){return e.parser.parse(t)})).then((function(t){return s(e,t)})).then((function(e){return t(e)})).catch((function(e){return r(e)}))}}))},e.logEnd=function(e){return new Promise((function(t){e.isBatched?i.Logger.log({data:1===i.Logger.activeLogLevel?{}:e,level:1,message:"["+e.requestId+"] ("+(new Date).getTime()+") "+e.method+" request will complete in batch "+e.batch.batchId+"."}):i.Logger.log({data:1===i.Logger.activeLogLevel?{}:e,level:1,message:"["+e.requestId+"] ("+(new Date).getTime()+") Completing "+e.method+" request."}),t(e)}))},n.__decorate([c(!0)],e,"logStart",null),n.__decorate([c()],e,"caching",null),n.__decorate([c()],e,"send",null),n.__decorate([c(!0)],e,"logEnd",null),e}();t.PipelineMethods=l,t.getDefaultPipeline=function(){return[l.logStart,l.caching,l.send,l.logEnd].slice(0)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(13),i=r(16);n.addProp(o._List,"items",i.Items)},function(e,t,r){"use strict";r.r(t),r.d(t,"__extends",(function(){return o})),r.d(t,"__assign",(function(){return i})),r.d(t,"__rest",(function(){return a})),r.d(t,"__decorate",(function(){return s})),r.d(t,"__param",(function(){return u})),r.d(t,"__metadata",(function(){return c})),r.d(t,"__awaiter",(function(){return l})),r.d(t,"__generator",(function(){return p})),r.d(t,"__exportStar",(function(){return d})),r.d(t,"__values",(function(){return h})),r.d(t,"__read",(function(){return f})),r.d(t,"__spread",(function(){return y})),r.d(t,"__await",(function(){return g})),r.d(t,"__asyncGenerator",(function(){return _})),r.d(t,"__asyncDelegator",(function(){return b})),r.d(t,"__asyncValues",(function(){return v})),r.d(t,"__makeTemplateObject",(function(){return m})),r.d(t,"__importStar",(function(){return P})),r.d(t,"__importDefault",(function(){return S}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function o(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function a(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&(r[n[o]]=e[n[o]])}return r}function s(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a}function u(e,t){return function(r,n){t(r,n,e)}}function c(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function l(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){e.done?o(e.value):new r((function(t){t(e.value)})).then(a,s)}u((n=n.apply(e,t||[])).next())}))}function p(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function d(e,t){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}function h(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}}function f(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function y(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(f(arguments[t]));return e}function g(e){return this instanceof g?(this.v=e,this):new g(e)}function _(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),i=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(e){o[e]&&(n[e]=function(t){return new Promise((function(r,n){i.push([e,t,r,n])>1||s(e,t)}))})}function s(e,t){try{(r=o[e](t)).value instanceof g?Promise.resolve(r.value.v).then(u,c):l(i[0][2],r)}catch(e){l(i[0][3],e)}var r}function u(e){s("next",e)}function c(e){s("throw",e)}function l(e,t){e(t),i.shift(),i.length&&s(i[0][0],i[0][1])}}function b(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:g(e[n](t)),done:"return"===n}:o?o(t):t}:o}}function v(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=h(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,o){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,o,(t=e[r](t)).done,t.value)}))}}}function m(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function P(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function S(e){return e&&e.__esModule?e:{default:e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(3);t.SharePointQueryableInstance=o.SharePointQueryableInstance,t.SharePointQueryableCollection=o.SharePointQueryableCollection,t.SharePointQueryable=o.SharePointQueryable,t.spInvokableFactory=o.spInvokableFactory;var i=r(41);t.SPBatch=i.SPBatch,n.__exportStar(r(6),t),n.__exportStar(r(4),t);var a=r(28);t.SPHttpClient=a.SPHttpClient;var s=r(14);t.SPRest=s.SPRest,t.sp=s.sp,n.__exportStar(r(160),t);var u=r(40);t.toAbsoluteUrl=u.toAbsoluteUrl;var c=r(12);t.extractWebUrl=c.extractWebUrl;var l=r(67);t.objectToSPKeyValueCollection=l.objectToSPKeyValueCollection;var p=r(161);t.stripInvalidFileFolderChars=p.stripInvalidFileFolderChars,t.containsInvalidFileFolderChars=p.containsInvalidFileFolderChars},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(8),o=r(2);t.objectToSPKeyValueCollection=function(e){return o.assign(n.metadata("Collection(SP.KeyValue)"),{results:Object.keys(e).map((function(t){return o.assign(n.metadata("SP.KeyValue"),{Key:t,Value:Reflect.get(e,t),ValueType:"Edm.String"})}))})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.ensure=function(t,r){var n=[e.Beta,e.V1],o=new RegExp(r,"i"),i=n.filter((function(e){return!o.test(e)})).map((function(e){return e.replace(".","\\.")}));return o=new RegExp("/?("+i.join("|")+")/","ig"),t.replace(o,"/"+r+"/")},e.Beta="beta",e.V1="v1.0",e}();t.GraphEndpoints=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(0),i=r(18),a=r(2),s=r(43),u=r(42),c=function(e){function t(t,r){void 0===t&&(t="https://graph.microsoft.com/v1.0/$batch"),void 0===r&&(r=20);var n=e.call(this)||this;return n.batchUrl=t,n.maxRequests=r,n}return n.__extends(t,e),t.makeUrlRelative=function(e){if(!a.isUrlAbsolute(e))return e;var t=e.indexOf(".com/v1.0/");return t<0?(t=e.indexOf(".com/beta/"))>-1?e.substr(t+10):e:e.substr(t+9)},t.formatRequests=function(e){var t=this;return e.map((function(e,r){var n={id:""+ ++r,method:e.method,url:t.makeUrlRelative(e.url)},o={};return void 0!==s.GraphRuntimeConfig.headers&&null!==s.GraphRuntimeConfig.headers&&(o=a.assign(o,s.GraphRuntimeConfig.headers)),void 0!==e.options&&(void 0!==e.options.headers&&null!==e.options.headers&&(o=a.assign(o,e.options.headers)),void 0!==e.options.body&&null!==e.options.body&&(n=a.assign(n,{body:e.options.body}))),n=a.assign(n,{headers:o})}))},t.parseResponse=function(e,t){return new Promise((function(r){for(var n=new Array(e.length).fill(null),o=0;o<t.responses.length;++o){var i=t.responses[o],a=parseInt(i.id,10)-1;204===i.status?n[a]=new Response:n[a]=new Response(JSON.stringify(i.body),i)}r({nextLink:t.nextLink,responses:n})}))},t.prototype.executeImpl=function(){var e=this;if(i.Logger.write("["+this.batchId+"] ("+(new Date).getTime()+") Executing batch with "+this.requests.length+" requests.",1),this.requests.length<1)return i.Logger.write("Resolving empty batch.",1),Promise.resolve();for(var r=new u.GraphHttpClient,n=this.requests.slice(),o=Promise.resolve(),s=function(){var s=n.splice(0,c.maxRequests),u={requests:t.formatRequests(s)},l={body:a.jsS(u),headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST"};i.Logger.write("["+c.batchId+"] ("+(new Date).getTime()+") Sending batch request.",1),r.fetch(c.batchUrl,l).then((function(e){return e.json()})).then((function(e){return t.parseResponse(s,e)})).then((function(t){i.Logger.write("["+e.batchId+"] ("+(new Date).getTime()+") Resolving batched requests.",1),t.responses.reduce((function(t,r,n){var o=s[n];return i.Logger.write("["+e.batchId+"] ("+(new Date).getTime()+") Resolving batched request "+o.method+" "+o.url+".",0),t.then((function(e){return o.parser.parse(r).then(o.resolve).catch(o.reject)}))}),o)}))},c=this;n.length>0;)s();return o},t}(o.Batch);t.GraphBatch=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(14);r(71),r(73),r(75),r(80),r(81),r(82),r(83),r(85),r(86),r(88),r(90),r(32),r(92),r(93),r(94),r(96),r(98),r(99),r(101),r(103),r(104),r(105),r(106),r(107),r(30),r(108),r(110),r(112),r(114),r(115),r(117),r(31),n.__exportStar(r(71),t),n.__exportStar(r(73),t),n.__exportStar(r(75),t),n.__exportStar(r(80),t),n.__exportStar(r(81),t),n.__exportStar(r(82),t),n.__exportStar(r(83),t),n.__exportStar(r(85),t),n.__exportStar(r(86),t),n.__exportStar(r(88),t),n.__exportStar(r(90),t),n.__exportStar(r(32),t),n.__exportStar(r(92),t),n.__exportStar(r(93),t),n.__exportStar(r(94),t),n.__exportStar(r(96),t),n.__exportStar(r(98),t),n.__exportStar(r(99),t),n.__exportStar(r(101),t),n.__exportStar(r(103),t),n.__exportStar(r(104),t),n.__exportStar(r(105),t),n.__exportStar(r(106),t),n.__exportStar(r(107),t),n.__exportStar(r(30),t),n.__exportStar(r(108),t),n.__exportStar(r(110),t),n.__exportStar(r(112),t),n.__exportStar(r(114),t),n.__exportStar(r(115),t),n.__exportStar(r(117),t),n.__exportStar(r(31),t),n.__exportStar(r(66),t),t.sp=new o.SPRest},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(14),i=r(7);r(167);var a=r(3),s=r(72);t.App=s.App,t.AppCatalog=s.AppCatalog,o.SPRest.prototype.getTenantAppCatalogWeb=function(){return n.__awaiter(this,void 0,void 0,(function(){var e;return n.__generator(this,(function(t){switch(t.label){case 0:return[4,a.SharePointQueryable("/","_api/SP_TenantSettings_Current")()];case 1:return e=t.sent(),[2,i.Web(e.CorporateCatalogUrl)]}}))}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(3),i=r(4),a=r(15),s=r(12),u=r(20),c=r(5),l=r(31);r(32);var p=function(e){function r(t,r){return void 0===r&&(r="_api/web/tenantappcatalog/AvailableApps"),e.call(this,s.extractWebUrl("string"==typeof t?t:t.toUrl()),r)||this}return n.__extends(r,e),r.prototype.getAppById=function(e){return c.tag.configure(t.App(this,"getById('"+e+"')"),"ac.getAppById")},r.prototype.syncSolutionToTeams=function(e,r){return void 0===r&&(r=!1),n.__awaiter(this,void 0,void 0,(function(){var o,a,u,p,d,h;return n.__generator(this,(function(n){switch(n.label){case 0:return o=null,a=s.extractWebUrl(this.toUrl()),r?(o=e,[3,4]):[3,1];case 1:return[4,(u=l.Web(a)).lists.select("Id").filter("EntityTypeName eq 'AppCatalog'")()];case 2:return p=n.sent()[0].Id,[4,u.lists.getById(p).items.filter("AppProductID eq '"+e+"'").top(1)()];case 3:if(!((d=n.sent())&&d.length>0))throw Error("Did not find the app with id "+e+" in the appcatalog.");o=d[0].Id,n.label=4;case 4:return h=c.tag.configure(t.AppCatalog(a,"_api/web/tenantappcatalog/SyncSolutionToTeams(id="+o+")"),"ac.syncSolutionToTeams"),[4,i.spPost(h,{})];case 5:return[2,n.sent()]}}))}))},r.prototype.add=function(e,r,o){return void 0===o&&(o=!0),n.__awaiter(this,void 0,void 0,(function(){var l,p;return n.__generator(this,(function(n){switch(n.label){case 0:return l=c.tag.configure(t.AppCatalog(s.extractWebUrl(this.toUrl()),"_api/web/tenantappcatalog/add(overwrite="+o+",url='"+e+"')"),"ac.add"),[4,i.spPost(l,{body:r,headers:{binaryStringRequestBody:"true"}})];case 1:return[2,{data:p=n.sent(),file:u.File(a.odataUrlFrom(p))}]}}))}))},r}(o._SharePointQueryableCollection);t._AppCatalog=p,t.AppCatalog=o.spInvokableFactory(p);var d=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r.prototype.deploy=function(e){return void 0===e&&(e=!1),this.do("Deploy("+e+")")},r.prototype.retract=function(){return this.do("Retract")},r.prototype.install=function(){return this.do("Install")},r.prototype.uninstall=function(){return this.do("Uninstall")},r.prototype.upgrade=function(){return this.do("Upgrade")},r.prototype.remove=function(){return this.do("Remove")},r.prototype.do=function(e){return i.spPost(this.clone(t.App,e))},n.__decorate([c.tag("app.deploy")],r.prototype,"deploy",null),n.__decorate([c.tag("app.retract")],r.prototype,"retract",null),n.__decorate([c.tag("app.install")],r.prototype,"install",null),n.__decorate([c.tag("app.uninstall")],r.prototype,"uninstall",null),n.__decorate([c.tag("app.upgrade")],r.prototype,"upgrade",null),n.__decorate([c.tag("app.remove")],r.prototype,"remove",null),r}(o._SharePointQueryableInstance);t._App=d,t.App=o.spInvokableFactory(d)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(168);var n=r(74);t.Attachment=n.Attachment,t.Attachments=n.Attachments},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(6),i=r(4),a=r(3),s=r(0),u=r(5),c=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r.prototype.getByName=function(e){var r=u.tag.configure(t.Attachment(this),"ats.getByName");return r.concat("('"+e+"')"),r},r.prototype.add=function(e,r){return n.__awaiter(this,void 0,void 0,(function(){return n.__generator(this,(function(n){switch(n.label){case 0:return[4,i.spPost(this.clone(t.Attachments,"add(FileName='"+e+"')",!1),{body:r})];case 1:return[2,{data:n.sent(),file:this.getByName(e)}]}}))}))},r.prototype.addMultiple=function(e){return n.__awaiter(this,void 0,void 0,(function(){var t;return n.__generator(this,(function(r){switch(r.label){case 0:t=0,r.label=1;case 1:return t<e.length?[4,this.add(e[t].name,e[t].content)]:[3,4];case 2:r.sent(),r.label=3;case 3:return t++,[3,1];case 4:return[2]}}))}))},r.prototype.deleteMultiple=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.__awaiter(this,void 0,void 0,(function(){var t;return n.__generator(this,(function(r){switch(r.label){case 0:t=0,r.label=1;case 1:return t<e.length?[4,this.getByName(e[t]).delete()]:[3,4];case 2:r.sent(),r.label=3;case 3:return t++,[3,1];case 4:return[2]}}))}))},r.prototype.recycleMultiple=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.__awaiter(this,void 0,void 0,(function(){var t;return n.__generator(this,(function(r){switch(r.label){case 0:t=0,r.label=1;case 1:return t<e.length?[4,this.getByName(e[t]).recycle()]:[3,4];case 2:r.sent(),r.label=3;case 3:return t++,[3,1];case 4:return[2]}}))}))},n.__decorate([u.tag("ats.add")],r.prototype,"add",null),n.__decorate([u.tag("ats.addMultiple")],r.prototype,"addMultiple",null),n.__decorate([u.tag("ats.deleteMultiple")],r.prototype,"deleteMultiple",null),n.__decorate([u.tag("ats.recycleMultiple")],r.prototype,"recycleMultiple",null),r=n.__decorate([o.defaultPath("AttachmentFiles")],r)}(a._SharePointQueryableCollection);t._Attachments=c,t.Attachments=a.spInvokableFactory(c);var l=function(e){function r(){var t=null!==e&&e.apply(this,arguments)||this;return t.delete=a.deleteableWithETag("at"),t}return n.__extends(r,e),r.prototype.getText=function(){return this.getParsed(new s.TextParser)},r.prototype.getBlob=function(){return this.getParsed(new s.BlobParser)},r.prototype.getBuffer=function(){return this.getParsed(new s.BufferParser)},r.prototype.getJSON=function(){return this.getParsed(new s.JSONParser)},r.prototype.setContent=function(e){return n.__awaiter(this,void 0,void 0,(function(){return n.__generator(this,(function(r){switch(r.label){case 0:return[4,i.spPost(this.clone(t.Attachment,"$value",!1),s.headers({"X-HTTP-Method":"PUT"},{body:e}))];case 1:return r.sent(),[2,t.Attachment(this)]}}))}))},r.prototype.recycle=function(e){return void 0===e&&(e="*"),i.spPost(this.clone(t.Attachment,"recycleObject"),s.headers({"IF-Match":e,"X-HTTP-Method":"DELETE"}))},r.prototype.getParsed=function(e){return this.clone(t.Attachment,"$value",!1).usingParser(e)()},n.__decorate([u.tag("at.getText")],r.prototype,"getText",null),n.__decorate([u.tag("at.getBlob")],r.prototype,"getBlob",null),n.__decorate([u.tag("at.getBuffer")],r.prototype,"getBuffer",null),n.__decorate([u.tag("at.getJSON")],r.prototype,"getJSON",null),n.__decorate([u.tag("at.setContent")],r.prototype,"setContent",null),n.__decorate([u.tag("at.recycle")],r.prototype,"recycle",null),r}(a._SharePointQueryableInstance);t._Attachment=l,t.Attachment=a.spInvokableFactory(l)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(169);var n=r(76);t.ClientsidePageFromFile=n.ClientsidePageFromFile,t.CreateClientsidePage=n.CreateClientsidePage,t.CanvasColumn=n.CanvasColumn,t.CanvasSection=n.CanvasSection,t.ClientsideText=n.ClientsideText,t.ClientsideWebpart=n.ClientsideWebpart,t.ColumnControl=n.ColumnControl,t.PromotedState=n.PromotedState},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(0),i=r(2),a=r(16),s=r(3),u=r(8),c=r(13),l=r(15),p=r(7),d=r(12),h=r(23),f=r(4),y=r(170);r(77),r(78);var g=r(5);function _(e,t){return v(d.extractWebUrl(e.toUrl()),t).configureFrom(e)}!function(e){e[e.NotPromoted=0]="NotPromoted",e[e.PromoteOnPublish=1]="PromoteOnPublish",e[e.Promoted=2]="Promoted"}(t.PromotedState||(t.PromotedState={}));var b=function(e){function r(t,n,o,a,s,u){void 0===a&&(a=!1),void 0===s&&(s=[]),void 0===u&&(u=!1);var c=e.call(this,t,n)||this;return c.json=o,c.sections=s,c.commentsDisabled=u,c._bannerImageDirty=!1,"string"==typeof t?(c.data.parentUrl="",c.data.url=i.combine(d.extractWebUrl(t),n)):c.assign(_(t,null),n),c._pageSettings={controlType:0,pageSettingsSlice:{isDefaultDescription:!0,isDefaultThumbnail:!0}},c._layoutPart=r.getDefaultLayoutPart(),void 0===o||a||c.fromJSON(o),c}return n.__extends(r,e),r.getDefaultLayoutPart=function(){return{dataVersion:"1.4",description:"Title Region Description",id:"cbe7b0a9-3504-44dd-a3a3-0e5cacd07788",instanceId:"cbe7b0a9-3504-44dd-a3a3-0e5cacd07788",properties:{authors:[],layoutType:"FullWidthImage",showPublishDate:!1,showTopicHeader:!1,textAlignment:"Left",title:"",topicHeader:""},serverProcessedContent:{htmlStrings:{},searchablePlainTexts:{},imageSources:{},links:{}},title:"Title area"}},Object.defineProperty(r.prototype,"pageLayout",{get:function(){return this.json.PageLayoutType},set:function(e){this.json.PageLayoutType=e},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"bannerImageUrl",{get:function(){return this.json.BannerImageUrl},set:function(e){this.json.BannerImageUrl=e,this._bannerImageDirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"topicHeader",{get:function(){return i.objectDefinedNotNull(this.json.TopicHeader)?this.json.TopicHeader:""},set:function(e){this.json.TopicHeader=e,this._layoutPart.properties.topicHeader=e,i.stringIsNullOrEmpty(e)&&(this.showTopicHeader=!1)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"title",{get:function(){return this._layoutPart.properties.title},set:function(e){this.json.Title=e,this._layoutPart.properties.title=e},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"layoutType",{get:function(){return this._layoutPart.properties.layoutType},set:function(e){this._layoutPart.properties.layoutType=e},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"headerTextAlignment",{get:function(){return this._layoutPart.properties.textAlignment},set:function(e){this._layoutPart.properties.textAlignment=e},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"showTopicHeader",{get:function(){return this._layoutPart.properties.showTopicHeader},set:function(e){this._layoutPart.properties.showTopicHeader=e},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"showPublishDate",{get:function(){return this._layoutPart.properties.showPublishDate},set:function(e){this._layoutPart.properties.showPublishDate=e},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"hasVerticalSection",{get:function(){return this.sections.findIndex((function(e){return 2===e.layoutIndex}))>-1},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"verticalSection",{get:function(){return this.hasVerticalSection?this.addVerticalSection():null},enumerable:!0,configurable:!0}),r.prototype.addSection=function(){var e=new m(this,y.getNextOrder(this.sections),1);return this.sections.push(e),e},r.prototype.addVerticalSection=function(){var e=this.sections.findIndex((function(e){return 2===e.layoutIndex}));if(e>-1)return this.sections[e];var t=new m(this,y.getNextOrder(this.sections),2);return this.sections.push(t),t},r.prototype.fromJSON=function(e){this.json=e;var t=JSON.parse(e.CanvasContent1),r=JSON.parse(e.LayoutWebpartsContent);return r&&r.length>0&&(this._layoutPart=r[0]),this.setControls(t),this},r.prototype.load=function(){return n.__awaiter(this,void 0,void 0,(function(){var e,t;return n.__generator(this,(function(r){switch(r.label){case 0:return[4,this.getItem("Id","CommentsDisabled")];case 1:return e=r.sent(),[4,s.SharePointQueryable(this,"_api/sitepages/pages("+e.Id+")")()];case 2:return t=r.sent(),this.commentsDisabled=e.CommentsDisabled,[2,this.fromJSON(t)]}}))}))},r.prototype.save=function(e){return void 0===e&&(e=!0),n.__awaiter(this,void 0,void 0,(function(){var t,r,a,c,l,y,g,b,v,m,P,S,T,I;return n.__generator(this,(function(n){switch(n.label){case 0:if(null===this.json.Id)throw Error("The id for this page is null. If you want to create a new page, please use ClientSidePage.Create");return this._bannerImageDirty?(t=this.json.BannerImageUrl,i.isUrlAbsolute(t)&&(t=t.replace(/^https?:\/\/[a-z0-9\.]*?\.[a-z]{2,3}\//i,"/")),r=h.Site(d.extractWebUrl(this.toUrl())),a=p.Web(d.extractWebUrl(this.toUrl())),c=a.getFileByServerRelativePath(t),l="",y="",g="",b="",v="",m=a.createBatch(),r.select("Id","Url").inBatch(m)().then((function(e){return l=e.Id})),a.select("Id","Url").inBatch(m)().then((function(e){y=e.Id,v=e.Url})),c.listItemAllFields.select("UniqueId","ParentList/Id").expand("ParentList").inBatch(m)().then((function(e){g=e.UniqueId,b=e.ParentList.Id})),[4,m.execute()]):[3,2];case 1:n.sent(),(P=s.SharePointQueryable(v,"_layouts/15/getpreview.ashx")).query.set("guidSite",""+l),P.query.set("guidWeb",""+y),P.query.set("guidFile",""+g),this.bannerImageUrl=P.toUrlAndQuery(),i.objectDefinedNotNull(this._layoutPart.serverProcessedContent)||(this._layoutPart.serverProcessedContent={}),this._layoutPart.serverProcessedContent.imageSources={imageSource:t},i.objectDefinedNotNull(this._layoutPart.serverProcessedContent.customMetadata)||(this._layoutPart.serverProcessedContent.customMetadata={}),this._layoutPart.serverProcessedContent.customMetadata.imageSource={listId:b,siteId:l,uniqueId:g,webId:y},this._layoutPart.properties.webId=y,this._layoutPart.properties.siteId=l,this._layoutPart.properties.listId=b,this._layoutPart.properties.uniqueId=g,n.label=2;case 2:return this.json.IsPageCheckedOutToCurrentUser?[3,4]:[4,f.spPost(_(this,"_api/sitepages/pages("+this.json.Id+")/checkoutpage"))];case 3:n.sent(),n.label=4;case 4:return S=Object.assign(u.metadata("SP.Publishing.SitePage"),{AuthorByline:this.json.AuthorByline||[],BannerImageUrl:this.bannerImageUrl,CanvasContent1:this.getCanvasContent1(),LayoutWebpartsContent:this.getLayoutWebpartsContent(),Title:this.title,TopicHeader:this.topicHeader}),T=_(this,"_api/sitepages/pages("+this.json.Id+")/savepage"),[4,f.spPost(T,o.headers({"if-match":"*"},o.body(S)))];case 5:return n.sent(),I=!0,e?[4,f.spPost(_(this,"_api/sitepages/pages("+this.json.Id+")/publish"))]:[3,7];case 6:(I=n.sent())&&(this.json.IsPageCheckedOutToCurrentUser=!1),n.label=7;case 7:return this._bannerImageDirty=!1,[2,I]}}))}))},r.prototype.discardPageCheckout=function(){return n.__awaiter(this,void 0,void 0,(function(){var e;return n.__generator(this,(function(t){switch(t.label){case 0:if(null===this.json.Id)throw Error("The id for this page is null. If you want to create a new page, please use ClientSidePage.Create");return[4,f.spPost(_(this,"_api/sitepages/pages("+this.json.Id+")/discardPage"),o.body(u.metadata("SP.Publishing.SitePage")))];case 1:return e=t.sent(),this.fromJSON(e),[2]}}))}))},r.prototype.promoteToNews=function(){return n.__awaiter(this,void 0,void 0,(function(){return n.__generator(this,(function(e){return[2,this.promoteNewsImpl("promoteToNews")]}))}))},r.prototype.findControlById=function(e){return this.findControl((function(t){return t.id===e}))},r.prototype.findControl=function(e){for(var t=0;t<this.sections.length;t++)for(var r=0;r<this.sections[t].columns.length;r++)for(var n=0;n<this.sections[t].columns[r].controls.length;n++)if(e(this.sections[t].columns[r].controls[n]))return this.sections[t].columns[r].controls[n];return null},r.prototype.copy=function(e,r,o,i){return void 0===i&&(i=!0),n.__awaiter(this,void 0,void 0,(function(){var a;return n.__generator(this,(function(n){switch(n.label){case 0:return[4,t.CreateClientsidePage(e,r,o,this.pageLayout)];case 1:return(a=n.sent()).setControls(this.getControls()),[4,a.save(i)];case 2:return n.sent(),[2,a]}}))}))},r.prototype.setBannerImage=function(e,t){this.bannerImageUrl=e,this._layoutPart.properties.imageSourceType=2,i.objectDefinedNotNull(t)&&(i.hOP(t,"translateX")&&(this._layoutPart.properties.translateX=t.translateX),i.hOP(t,"translateY")&&(this._layoutPart.properties.translateY=t.translateY),i.hOP(t,"imageSourceType")&&(this._layoutPart.properties.imageSourceType=t.imageSourceType),i.hOP(t,"altText")&&(this._layoutPart.properties.altText=t.altText))},r.prototype.getItem=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.__awaiter(this,void 0,void 0,(function(){var t,r,o,s;return n.__generator(this,(function(n){switch(n.label){case 0:return t=_(this,"/_api/lists/EnsureClientRenderedSitePagesLibrary").select("EnableModeration","EnableMinorVersions","Id"),[4,f.spPost(t)];case 1:return r=n.sent(),[4,(o=c.List(r["odata.id"]).configureFrom(this).items.getById(this.json.Id)).select.apply(o,e)()];case 2:return s=n.sent(),[2,i.assign(a.Item(l.odataUrlFrom(s)).configureFrom(this),s)]}}))}))},r.prototype.assign=function(e,t){this.data.parentUrl=e.data.url,this.data.url=i.combine(this.data.parentUrl,t||""),this.configureFrom(e)},r.prototype.getCanvasContent1=function(){return JSON.stringify(this.getControls())},r.prototype.getLayoutWebpartsContent=function(){return this._layoutPart?JSON.stringify([this._layoutPart]):JSON.stringify(null)},r.prototype.setControls=function(e){if(e&&e.length){for(var t=0;t<e.length;t++){switch(i.hOP(e[t],"controlType")?e[t].controlType:0){case 0:i.hOP(e[t],"pageSettingsSlice")?this._pageSettings=e[t]:this.mergeColumnToTree(new P(e[t]));break;case 3:var r=new I(e[t]);this.mergePartToTree(r,r.data.position);break;case 4:var n=e[t],o=new T(n.innerHTML,n);this.mergePartToTree(o,o.data.position)}}y.reindex(this.sections)}},r.prototype.getControls=function(){var e=this;y.reindex(this.sections);var t=[];return this.sections.forEach((function(r){r.columns.forEach((function(n){n.controls.length<1?t.push({displayMode:n.data.displayMode,emphasis:e.getEmphasisObj(r.emphasis),position:n.data.position}):n.controls.forEach((function(n){n.data.emphasis=e.getEmphasisObj(r.emphasis),t.push(n.data)}))}))})),t.push(this._pageSettings),t},r.prototype.getEmphasisObj=function(e){return e<1||e>3?{}:{zoneEmphasis:e}},r.prototype.promoteNewsImpl=function(e){return n.__awaiter(this,void 0,void 0,(function(){return n.__generator(this,(function(t){switch(t.label){case 0:if(null===this.json.Id)throw Error("The id for this page is null.");return i.stringIsNullOrEmpty(this.json.VersionInfo.LastVersionCreatedBy)&&new Date(this.json.VersionInfo.LastVersionCreated).getFullYear()<2e3?[4,this.save(!0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[4,f.spPost(_(this,"_api/sitepages/pages("+this.json.Id+")/"+e),o.body(u.metadata("SP.Publishing.SitePage")))];case 3:return[2,t.sent()]}}))}))},r.prototype.mergePartToTree=function(e,t){var r=null,n=12,o=0,a=0,s=1;t&&(i.hOP(t,"zoneIndex")&&(a=t.zoneIndex),i.hOP(t,"sectionIndex")&&(o=t.sectionIndex),i.hOP(t,"sectionFactor")&&(n=t.sectionFactor),i.hOP(t,"layoutIndex")&&(s=t.layoutIndex));var u=this.getOrCreateSection(a,s,e.data.emphasis.zoneEmphasis||0),c=u.columns.filter((function(e){return e.order===o}));r=c.length<1?u.addColumn(n,s):c[0],e.column=r,r.addControl(e)},r.prototype.mergeColumnToTree=function(e){var t=i.hOP(e.data,"position")&&i.hOP(e.data.position,"zoneIndex")?e.data.position.zoneIndex:0,r=i.hOP(e.data,"position")&&i.hOP(e.data.position,"layoutIndex")?e.data.position.layoutIndex:1,n=this.getOrCreateSection(t,r,e.data.emphasis.zoneEmphasis||0);e.section=n,n.columns.push(e)},r.prototype.getOrCreateSection=function(e,t,r){var n=null,o=this.sections.filter((function(r){return r.order===e&&r.layoutIndex===t}));return o.length<1?((n=2===t?this.addVerticalSection():this.addSection()).order=e,n.emphasis=r):n=o[0],n},n.__decorate([g.tag("csp.load")],r.prototype,"load",null),n.__decorate([g.tag("csp.save")],r.prototype,"save",null),n.__decorate([g.tag("csp.discardPageCheckout")],r.prototype,"discardPageCheckout",null),n.__decorate([g.tag("csp.promoteToNews")],r.prototype,"promoteToNews",null),n.__decorate([g.tag("csp.copy")],r.prototype,"copy",null),n.__decorate([g.tag("csp.getItem")],r.prototype,"getItem",null),r}(s._SharePointQueryable);t._ClientsidePage=b;var v=function(e,t,r,n,i,a){return void 0===n&&(n=!1),void 0===i&&(i=[]),void 0===a&&(a=!1),o.invokableFactory(b)(e,t,r,n,i,a)};t.ClientsidePageFromFile=function(e){return n.__awaiter(void 0,void 0,void 0,(function(){var t;return n.__generator(this,(function(r){switch(r.label){case 0:return[4,e.getItem()];case 1:return t=r.sent(),[2,v(d.extractWebUrl(e.toUrl()),"",{Id:t.Id},!0).configureFrom(e).load()]}}))}))},t.CreateClientsidePage=function(e,t,r,i){return void 0===i&&(i="Article"),n.__awaiter(void 0,void 0,void 0,(function(){var a,s;return n.__generator(this,(function(n){switch(n.label){case 0:return t=t.replace(/\.aspx$/i,""),[4,f.spPost(_(e,"_api/sitepages/pages"),o.body(Object.assign(u.metadata("SP.Publishing.SitePage"),{PageLayoutType:i})))];case 1:return a=n.sent(),(s=v(e,"",a)).title=t,[4,s.save(!1)];case 2:return n.sent(),s.title=r,[2,s]}}))}))};var m=function(){function e(e,t,r,n,o){void 0===n&&(n=[]),void 0===o&&(o=0),this.page=e,this.columns=n,this._emphasis=o,this._memId=i.getGUID(),this._order=t,this._layoutIndex=r}return Object.defineProperty(e.prototype,"order",{get:function(){return this._order},set:function(e){this._order=e;for(var t=0;t<this.columns.length;t++)this.columns[t].data.position.zoneIndex=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"layoutIndex",{get:function(){return this._layoutIndex},set:function(e){this._layoutIndex=e;for(var t=0;t<this.columns.length;t++)this.columns[t].data.position.layoutIndex=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"defaultColumn",{get:function(){return this.columns.length<1&&this.addColumn(12),this.columns[0]},enumerable:!0,configurable:!0}),e.prototype.addColumn=function(e,t){void 0===t&&(t=1);var r=new P;return r.section=this,r.data.position.zoneIndex=this.order,r.data.position.layoutIndex=t,r.data.position.sectionFactor=e,r.order=y.getNextOrder(this.columns),this.columns.push(r),r},e.prototype.addControl=function(e){return this.defaultColumn.addControl(e),this},Object.defineProperty(e.prototype,"emphasis",{get:function(){return this._emphasis},set:function(e){this._emphasis=e},enumerable:!0,configurable:!0}),e.prototype.remove=function(){var e=this;this.page.sections=this.page.sections.filter((function(t){return t._memId!==e._memId})),y.reindex(this.page.sections)},e}();t.CanvasSection=m;var P=function(){function e(t,r){void 0===t&&(t=JSON.parse(JSON.stringify(e.Default))),void 0===r&&(r=[]),this.json=t,this.controls=r,this._section=null,this._memId=i.getGUID()}return Object.defineProperty(e.prototype,"data",{get:function(){return this.json},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"section",{get:function(){return this._section},set:function(e){this._section=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"order",{get:function(){return this.data.position.sectionIndex},set:function(e){this.data.position.sectionIndex=e;for(var t=0;t<this.controls.length;t++)this.controls[t].data.position.zoneIndex=this.data.position.zoneIndex,this.controls[t].data.position.layoutIndex=this.data.position.layoutIndex,this.controls[t].data.position.sectionIndex=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"factor",{get:function(){return this.data.position.sectionFactor},set:function(e){this.data.position.sectionFactor=e},enumerable:!0,configurable:!0}),e.prototype.addControl=function(e){return e.column=this,this.controls.push(e),this},e.prototype.getControl=function(e){return this.controls[e]},e.prototype.remove=function(){var e=this;this.section.columns=this.section.columns.filter((function(t){return t._memId!==e._memId})),y.reindex(this.section.columns)},e.Default={controlType:0,displayMode:2,emphasis:{},position:{layoutIndex:1,sectionFactor:12,sectionIndex:1,zoneIndex:1}},e}();t.CanvasColumn=P;var S=function(){function e(e){this.json=e}return Object.defineProperty(e.prototype,"id",{get:function(){return this.json.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this.json},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"column",{get:function(){return this._column},set:function(e){this._column=e,this.onColumnChange(this._column)},enumerable:!0,configurable:!0}),e.prototype.remove=function(){var e=this;this.column.controls=this.column.controls.filter((function(t){return t.id!==e.id})),y.reindex(this.column.controls)},e.prototype.setData=function(e){this.json=e},e}();t.ColumnControl=S;var T=function(e){function t(r,n){void 0===n&&(n=JSON.parse(JSON.stringify(t.Default)));var o=this;return i.stringIsNullOrEmpty(n.id)&&(n.id=i.getGUID(),n.anchorComponentId=n.id),(o=e.call(this,n)||this).text=r,o}return n.__extends(t,e),Object.defineProperty(t.prototype,"text",{get:function(){return this.data.innerHTML},set:function(e){e.startsWith("<p>")||(e="<p>"+e+"</p>"),this.data.innerHTML=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"order",{get:function(){return this.data.position.controlIndex},set:function(e){this.data.position.controlIndex=e},enumerable:!0,configurable:!0}),t.prototype.onColumnChange=function(e){this.data.position.sectionFactor=e.factor,this.data.position.controlIndex=y.getNextOrder(e.controls),this.data.position.zoneIndex=e.data.position.zoneIndex,this.data.position.sectionIndex=e.order,this.data.position.layoutIndex=e.data.position.layoutIndex},t.Default={addedFromPersistedData:!1,anchorComponentId:"",controlType:4,displayMode:2,editorType:"CKEditor",emphasis:{},id:"",innerHTML:"",position:{controlIndex:1,layoutIndex:1,sectionFactor:12,sectionIndex:1,zoneIndex:1}},t}(S);t.ClientsideText=T;var I=function(e){function t(r){return void 0===r&&(r=JSON.parse(JSON.stringify(t.Default))),e.call(this,r)||this}return n.__extends(t,e),t.fromComponentDef=function(e){var r=new t;return r.import(e),r},Object.defineProperty(t.prototype,"title",{get:function(){return this.data.webPartData.title},set:function(e){this.data.webPartData.title=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"description",{get:function(){return this.data.webPartData.description},set:function(e){this.data.webPartData.description=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"order",{get:function(){return this.data.position.controlIndex},set:function(e){this.data.position.controlIndex=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.data.reservedHeight},set:function(e){this.data.reservedHeight=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.data.reservedWidth},set:function(e){this.data.reservedWidth=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dataVersion",{get:function(){return this.data.webPartData.dataVersion},set:function(e){this.data.webPartData.dataVersion=e},enumerable:!0,configurable:!0}),t.prototype.setProperties=function(e){return this.data.webPartData.properties=i.assign(this.data.webPartData.properties,e),this},t.prototype.getProperties=function(){return this.data.webPartData.properties},t.prototype.onColumnChange=function(e){this.data.position.sectionFactor=e.factor,this.data.position.controlIndex=y.getNextOrder(e.controls),this.data.position.zoneIndex=e.data.position.zoneIndex,this.data.position.sectionIndex=e.data.position.sectionIndex,this.data.position.layoutIndex=e.data.position.layoutIndex},t.prototype.import=function(e){var t=i.getGUID(),r=e.Id.replace(/^\{|\}$/g,"").toLowerCase(),n=JSON.parse(e.Manifest).preconfiguredEntries[0];this.setData(Object.assign({},this.data,{id:t,webPartData:{dataVersion:"1.0",description:n.description.default,id:r,instanceId:t,properties:n.properties,title:n.title.default},webPartId:r}))},t.Default={addedFromPersistedData:!1,controlType:3,displayMode:2,emphasis:{},id:null,position:{controlIndex:1,layoutIndex:1,sectionFactor:12,sectionIndex:1,zoneIndex:1},reservedHeight:500,reservedWidth:500,webPartData:null,webPartId:null},t}(S);t.ClientsideWebpart=I},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(7),o=r(20),i=r(17);n._Web.prototype.getFileByServerRelativeUrl=function(e){return o.File(this,"getFileByServerRelativeUrl('"+i.escapeQueryStrValue(e)+"')")},n._Web.prototype.getFileByServerRelativePath=function(e){return o.File(this,"getFileByServerRelativePath(decodedUrl='"+i.escapeQueryStrValue(e)+"')")}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(16),i=r(79),a=r(4);n.addProp(o._Item,"comments",i.Comments),o._Item.prototype.getLikedBy=function(){return a.spPost(this.clone(o.Item,"likedBy"))},o._Item.prototype.like=function(){return a.spPost(this.clone(o.Item,"like"))},o._Item.prototype.unlike=function(){return a.spPost(this.clone(o.Item,"unlike"))},o._Item.prototype.getLikedByInformation=function(){return this.clone(o.Item,"likedByInformation").expand("likedby")()}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(6),i=r(3),a=r(2),s=r(15),u=r(8),c=r(0),l=r(4),p=r(5),d=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r.prototype.add=function(e){return n.__awaiter(this,void 0,void 0,(function(){var r,o;return n.__generator(this,(function(n){switch(n.label){case 0:return"string"==typeof e&&(e={text:e}),r=c.body(a.assign(u.metadata("Microsoft.SharePoint.Comments.comment"),e)),[4,l.spPost(this.clone(t.Comments,null),r)];case 1:return o=n.sent(),[2,a.assign(this.getById(o.id),o)]}}))}))},r.prototype.getById=function(e){return p.tag.configure(t.Comment(this).concat("("+e+")"),"coms.getById")},r.prototype.clear=function(){return l.spPost(p.tag.configure(this.clone(t.Comments,"DeleteAll"),"coms.clear"))},n.__decorate([p.tag("coms.add")],r.prototype,"add",null),r=n.__decorate([o.defaultPath("comments")],r)}(i._SharePointQueryableCollection);t._Comments=d,t.Comments=i.spInvokableFactory(d);var h=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),Object.defineProperty(r.prototype,"replies",{get:function(){return p.tag.configure(t.Replies(this),"com.replies")},enumerable:!0,configurable:!0}),r.prototype.like=function(){return l.spPost(this.clone(t.Comment,"Like"))},r.prototype.unlike=function(){return l.spPost(this.clone(t.Comment,"Unlike"))},r.prototype.delete=function(){return l.spPost(this.clone(t.Comment,"DeleteComment"))},n.__decorate([p.tag("com.like")],r.prototype,"like",null),n.__decorate([p.tag("com.unlike")],r.prototype,"unlike",null),n.__decorate([p.tag("com.delete")],r.prototype,"delete",null),r}(i._SharePointQueryableInstance);t._Comment=h,t.Comment=i.spInvokableFactory(h);var f=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r.prototype.add=function(e){return n.__awaiter(this,void 0,void 0,(function(){var r,o;return n.__generator(this,(function(n){switch(n.label){case 0:return"string"==typeof e&&(e={text:e}),r=c.body(a.assign(u.metadata("Microsoft.SharePoint.Comments.comment"),e)),[4,l.spPost(this.clone(t.Replies,null),r)];case 1:return o=n.sent(),[2,a.assign(t.Comment(s.odataUrlFrom(o)),o)]}}))}))},n.__decorate([p.tag("reps.add")],r.prototype,"add",null),r=n.__decorate([o.defaultPath("replies")],r)}(i._SharePointQueryableCollection);t._Replies=f,t.Replies=i.spInvokableFactory(f)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(78);var n=r(79);t.Comment=n.Comment,t.Comments=n.Comments,t.Replies=n.Replies},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(171),r(172),r(173);var n=r(33);t.ContentType=n.ContentType,t.ContentTypes=n.ContentTypes,t.FieldLink=n.FieldLink,t.FieldLinks=n.FieldLinks},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(174),r(175);var n=r(44);t.Feature=n.Feature,t.Features=n.Features},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(84),r(176),r(84);var n=r(45);t.Fields=n.Fields,t.Field=n.Field,t.AddFieldOptions=n.AddFieldOptions,t.CalendarType=n.CalendarType,t.ChoiceFieldFormatType=n.ChoiceFieldFormatType,t.DateTimeFieldFormatType=n.DateTimeFieldFormatType,t.DateTimeFieldFriendlyFormatType=n.DateTimeFieldFriendlyFormatType,t.FieldTypes=n.FieldTypes,t.FieldUserSelectionMode=n.FieldUserSelectionMode,t.UrlFieldFormatType=n.UrlFieldFormatType},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(7),i=r(45);n.addProp(o._Web,"fields",i.Fields),n.addProp(o._Web,"availablefields",i.Fields,"availablefields")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(177),r(178),r(77);var n=r(20);t.File=n.File,t.Files=n.Files,t.CheckinType=n.CheckinType,t.MoveOperations=n.MoveOperations,t.TemplateFileType=n.TemplateFileType,t.Version=n.Version,t.Versions=n.Versions},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(179),r(87),r(180);var n=r(24);t.Folder=n.Folder,t.Folders=n.Folders},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(13),i=r(24);n.addProp(o._List,"rootFolder",i.Folder,"rootFolder")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(181);var n=r(89);t.Form=n.Form,t.Forms=n.Forms},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(3),i=r(6),a=r(5),s=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r.prototype.getById=function(e){return a.tag.configure(t.Form(this).concat("('"+e+"')"),"fos.getById")},r=n.__decorate([i.defaultPath("forms")],r)}(o._SharePointQueryableCollection);t._Forms=s,t.Forms=o.spInvokableFactory(s);var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t}(o._SharePointQueryableInstance);t._Form=u,t.Form=o.spInvokableFactory(u)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(14),o=r(91);r(182),r(183);var i=r(91);t.HubSite=i.HubSite,t.HubSites=i.HubSites,Reflect.defineProperty(n.SPRest.prototype,"hubSites",{configurable:!0,enumerable:!0,get:function(){return o.HubSites(this._baseUrl).configure(this._options)}})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(3),i=r(6),a=r(23),s=r(5),u=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r.prototype.getById=function(e){return s.tag.configure(t.HubSite(this,"GetById?hubSiteId='"+e+"'"),"hss.getById")},r=n.__decorate([i.defaultPath("_api/hubsites")],r)}(o._SharePointQueryableCollection);t._HubSites=u,t.HubSites=o.spInvokableFactory(u);var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.getSite=function(){return n.__awaiter(this,void 0,void 0,(function(){var e;return n.__generator(this,(function(t){switch(t.label){case 0:return[4,this.select("SiteUrl")()];case 1:return e=t.sent(),[2,a.Site(e.SiteUrl)]}}))}))},n.__decorate([s.tag("hs.getSite")],t.prototype,"getSite",null),t}(o._SharePointQueryableInstance);t._HubSite=c,t.HubSite=o.spInvokableFactory(c)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(59);var n=r(13);t.List=n.List,t.Lists=n.Lists,t.ControlMode=n.ControlMode,t.RenderListDataOptions=n.RenderListDataOptions},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(14),o=r(46);r(184);var i=r(46);t.Navigation=i.Navigation,t.NavigationNode=i.NavigationNode,t.NavigationNodes=i.NavigationNodes,t.NavigationService=i.NavigationService,Reflect.defineProperty(n.SPRest.prototype,"navigation",{configurable:!0,enumerable:!0,get:function(){return o.NavigationService().configure(this._options)}})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(14),o=r(95),i=r(95);t.Profiles=i.Profiles,t.UrlZone=i.UrlZone,Reflect.defineProperty(n.SPRest.prototype,"profiles",{configurable:!0,enumerable:!0,get:function(){return o.Profiles(this._baseUrl)}})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(3),i=r(2),a=r(8),s=r(0),u=r(6),c=r(4),l=function(e){function r(t,r){void 0===r&&(r="_api/sp.userprofiles.peoplemanager");var n=e.call(this,t,r)||this;return n.clientPeoplePickerQuery=new h(t).configureFrom(n),n.profileLoader=new p(t).configureFrom(n),n}return n.__extends(r,e),Object.defineProperty(r.prototype,"editProfileLink",{get:function(){return this.clone(t.Profiles,"EditProfileLink").get()},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"isMyPeopleListPublic",{get:function(){return this.clone(t.Profiles,"IsMyPeopleListPublic").get()},enumerable:!0,configurable:!0}),r.prototype.amIFollowedBy=function(e){var r=this.clone(t.Profiles,"amifollowedby(@v)");return r.query.set("@v","'"+encodeURIComponent(e)+"'"),r.get()},r.prototype.amIFollowing=function(e){var r=this.clone(t.Profiles,"amifollowing(@v)");return r.query.set("@v","'"+encodeURIComponent(e)+"'"),r.get()},r.prototype.getFollowedTags=function(e){return void 0===e&&(e=20),this.clone(t.Profiles,"getfollowedtags("+e+")").get()},r.prototype.getFollowersFor=function(e){var r=this.clone(t.Profiles,"getfollowersfor(@v)");return r.query.set("@v","'"+encodeURIComponent(e)+"'"),r.get()},Object.defineProperty(r.prototype,"myFollowers",{get:function(){return o.SharePointQueryableCollection(this,"getmyfollowers")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"myProperties",{get:function(){return new r(this,"getmyproperties")},enumerable:!0,configurable:!0}),r.prototype.getPeopleFollowedBy=function(e){var r=this.clone(t.Profiles,"getpeoplefollowedby(@v)");return r.query.set("@v","'"+encodeURIComponent(e)+"'"),r.get()},r.prototype.getPropertiesFor=function(e){var r=this.clone(t.Profiles,"getpropertiesfor(@v)");return r.query.set("@v","'"+encodeURIComponent(e)+"'"),r.get()},Object.defineProperty(r.prototype,"trendingTags",{get:function(){var e=this.clone(t.Profiles,null);return e.concat(".gettrendingtags"),e.get()},enumerable:!0,configurable:!0}),r.prototype.getUserProfilePropertyFor=function(e,r){var n=this.clone(t.Profiles,"getuserprofilepropertyfor(accountname=@v, propertyname='"+r+"')");return n.query.set("@v","'"+encodeURIComponent(e)+"'"),n.get()},r.prototype.hideSuggestion=function(e){var r=this.clone(t.Profiles,"hidesuggestion(@v)");return r.query.set("@v","'"+encodeURIComponent(e)+"'"),c.spPost(r)},r.prototype.isFollowing=function(e,r){var n=this.clone(t.Profiles,null);return n.concat(".isfollowing(possiblefolloweraccountname=@v, possiblefolloweeaccountname=@y)"),n.query.set("@v","'"+encodeURIComponent(e)+"'"),n.query.set("@y","'"+encodeURIComponent(r)+"'"),n.get()},r.prototype.setMyProfilePic=function(e){var t=null,n=new FileReader;n.onload=function(e){return t=e.target.result},n.readAsArrayBuffer(e);var o=new r(this,"setmyprofilepicture");return c.spPost(o,s.body(String.fromCharCode.apply(null,new Uint16Array(t))))},r.prototype.setSingleValueProfileProperty=function(e,r,n){return c.spPost(this.clone(t.Profiles,"SetSingleValueProfileProperty"),s.body({accountName:e,propertyName:r,propertyValue:n}))},r.prototype.setMultiValuedProfileProperty=function(e,r,n){return c.spPost(this.clone(t.Profiles,"SetMultiValuedProfileProperty"),s.body({accountName:e,propertyName:r,propertyValues:n}))},r.prototype.createPersonalSiteEnqueueBulk=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.profileLoader.createPersonalSiteEnqueueBulk(e)},Object.defineProperty(r.prototype,"ownerUserProfile",{get:function(){return this.profileLoader.ownerUserProfile},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"userProfile",{get:function(){return this.profileLoader.userProfile},enumerable:!0,configurable:!0}),r.prototype.createPersonalSite=function(e){return void 0===e&&(e=!1),this.profileLoader.createPersonalSite(e)},r.prototype.shareAllSocialData=function(e){return this.profileLoader.shareAllSocialData(e)},r.prototype.clientPeoplePickerResolveUser=function(e){return this.clientPeoplePickerQuery.clientPeoplePickerResolveUser(e)},r.prototype.clientPeoplePickerSearchUser=function(e){return this.clientPeoplePickerQuery.clientPeoplePickerSearchUser(e)},r}(o._SharePointQueryableInstance);t._Profiles=l,t.Profiles=o.spInvokableFactory(l);var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.createPersonalSiteEnqueueBulk=function(e){return c.spPost(this.clone(d,"createpersonalsiteenqueuebulk",!1),s.body({emailIDs:e}))},Object.defineProperty(t.prototype,"ownerUserProfile",{get:function(){var e=this.getParent(d,this.parentUrl,"_api/sp.userprofiles.profileloader.getowneruserprofile");return this.hasBatch&&(e=e.inBatch(this.batch)),c.spPost(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userProfile",{get:function(){return c.spPost(this.clone(d,"getuserprofile"))},enumerable:!0,configurable:!0}),t.prototype.createPersonalSite=function(e){return void 0===e&&(e=!1),c.spPost(this.clone(d,"getuserprofile/createpersonalsiteenque("+e+")"))},t.prototype.shareAllSocialData=function(e){return c.spPost(this.clone(d,"getuserprofile/shareallsocialdata("+e+")"))},t=n.__decorate([u.defaultPath("_api/sp.userprofiles.profileloader.getprofileloader")],t)}(o._SharePointQueryable),d=function(e,t){return new p(e,t)},h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.clientPeoplePickerResolveUser=function(e){return n.__awaiter(this,void 0,void 0,(function(){var t,r;return n.__generator(this,(function(n){switch(n.label){case 0:return(t=this.clone(f,null)).concat(".clientpeoplepickerresolveuser"),[4,c.spPost(t,this.getBodyFrom(e))];case 1:return r=n.sent(),[2,JSON.parse("object"==typeof r?r.ClientPeoplePickerResolveUser:r)]}}))}))},t.prototype.clientPeoplePickerSearchUser=function(e){return n.__awaiter(this,void 0,void 0,(function(){var t,r;return n.__generator(this,(function(n){switch(n.label){case 0:return(t=this.clone(f,null)).concat(".clientpeoplepickersearchuser"),[4,c.spPost(t,this.getBodyFrom(e))];case 1:return r=n.sent(),[2,JSON.parse("object"==typeof r?r.ClientPeoplePickerSearchUser:r)]}}))}))},t.prototype.getBodyFrom=function(e){return s.body({queryParams:i.assign(a.metadata("SP.UI.ApplicationPages.ClientPeoplePickerQueryParameters"),e)})},t=n.__decorate([u.defaultPath("_api/sp.ui.applicationpages.clientpeoplepickerwebserviceinterface")],t)}(o._SharePointQueryable),f=function(e,t){return new h(e,t)};!function(e){e[e.DefaultZone=0]="DefaultZone",e[e.Intranet=1]="Intranet",e[e.Internet=2]="Internet",e[e.Custom=3]="Custom",e[e.Extranet=4]="Extranet"}(t.UrlZone||(t.UrlZone={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(185);var n=r(97);t.RegionalSettings=n.RegionalSettings,t.TimeZone=n.TimeZone,t.TimeZones=n.TimeZones},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(2),i=r(3),a=r(6),s=r(15),u=r(4),c=r(5),l=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),Object.defineProperty(r.prototype,"installedLanguages",{get:function(){return c.tag.configure(i.SharePointQueryableCollection(this,"installedlanguages"),"rs.installedLanguages")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"timeZone",{get:function(){return c.tag.configure(t.TimeZone(this),"rs.tz")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"timeZones",{get:function(){return c.tag.configure(t.TimeZones(this),"rs.tzs")},enumerable:!0,configurable:!0}),r=n.__decorate([a.defaultPath("regionalsettings")],r)}(i._SharePointQueryableInstance);t._RegionalSettings=l,t.RegionalSettings=i.spInvokableFactory(l);var p=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r.prototype.utcToLocalTime=function(e){return n.__awaiter(this,void 0,void 0,(function(){var r,i;return n.__generator(this,(function(n){switch(n.label){case 0:return r="string"==typeof e?e:e.toISOString(),[4,u.spPost(this.clone(t.TimeZone,"utctolocaltime('"+r+"')"))];case 1:return i=n.sent(),[2,o.hOP(i,"UTCToLocalTime")?i.UTCToLocalTime:i]}}))}))},r.prototype.localTimeToUTC=function(e){return n.__awaiter(this,void 0,void 0,(function(){var r,i;return n.__generator(this,(function(n){switch(n.label){case 0:return r="string"==typeof e?e:o.dateAdd(e,"minute",-1*e.getTimezoneOffset()).toISOString(),[4,u.spPost(this.clone(t.TimeZone,"localtimetoutc('"+r+"')"))];case 1:return i=n.sent(),[2,o.hOP(i,"LocalTimeToUTC")?i.LocalTimeToUTC:i]}}))}))},n.__decorate([c.tag("tz.utcToLocalTime")],r.prototype,"utcToLocalTime",null),n.__decorate([c.tag("tz.localTimeToUTC")],r.prototype,"localTimeToUTC",null),r=n.__decorate([a.defaultPath("timezone")],r)}(i._SharePointQueryableInstance);t._TimeZone=p,t.TimeZone=i.spInvokableFactory(p);var d=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r.prototype.getById=function(e){return u.spPost(this.clone(t.TimeZones,"GetById("+e+")").usingParser(s.spODataEntity(t.TimeZone)))},n.__decorate([c.tag("tzs.getById")],r.prototype,"getById",null),r=n.__decorate([a.defaultPath("timezones")],r)}(i._SharePointQueryableCollection);t._TimeZones=d,t.TimeZones=i.spInvokableFactory(d)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(186);t.RelatedItemManager=n.RelatedItemManager},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(14),i=r(47),a=r(47),s=r(100);n.__exportStar(r(187),t);var u=r(47);t.SearchQueryBuilder=u.SearchQueryBuilder,t.SearchResults=u.SearchResults,t.Search=u.Search;var c=r(100);t.Suggest=c.Suggest,o.SPRest.prototype.search=function(e){return a.Search(this._baseUrl,this._options)(e)},o.SPRest.prototype.searchWithCaching=function(e,t){return new i._Search(this._baseUrl,null).configure(this._options).usingCaching(t).execute(e)},o.SPRest.prototype.searchSuggest=function(e){return s.Suggest(this._baseUrl,this._options)("string"==typeof e?{querytext:e}:e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(3),i=r(2),a=r(6),s=r(5),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.execute=function(e){return n.__awaiter(this,void 0,void 0,(function(){var t,r;return n.__generator(this,(function(n){switch(n.label){case 0:return this.mapQueryToQueryString(e),[4,this.get()];case 1:return t=n.sent(),[2,{PeopleNames:(r=i.hOP(t,"suggest")?function(e){return t.suggest[e].results}:function(e){return t[e]})("PeopleNames"),PersonalResults:r("PersonalResults"),Queries:r("Queries")}]}}))}))},t.prototype.mapQueryToQueryString=function(e){var t=this;this.query.set("querytext","'"+e.querytext+"'");var r,n=(r=e,function(e){return function(n){i.hOP(r,e)&&t.query.set(n,r[e].toString())}});n("count")("inumberofquerysuggestions"),n("personalCount")("inumberofresultsuggestions"),n("preQuery")("fprequerysuggestions"),n("hitHighlighting")("fhithighlighting"),n("capitalize")("fcapitalizefirstletters"),n("culture")("culture"),n("stemming")("enablestemming"),n("includePeople")("showpeoplenamesuggestions"),n("queryRules")("enablequeryrules"),n("prefixMatch")("fprefixmatchallterms")},n.__decorate([s.tag("su.execute")],t.prototype,"execute",null),t=n.__decorate([a.defaultPath("_api/search/suggest")],t)}(o._SharePointQueryableInstance);t._Suggest=u,t.Suggest=function(e,t){return void 0===t&&(t={}),function(r){return new u(e).configure(t).execute(r)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(188),r(189),r(102);var n=r(25);t.RoleAssignment=n.RoleAssignment,t.RoleAssignments=n.RoleAssignments,t.RoleDefinition=n.RoleDefinition,t.RoleDefinitions=n.RoleDefinitions,t.PermissionKind=n.PermissionKind},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(7),i=r(25),a=r(3),s=r(49);n.addProp(o._Web,"roleDefinitions",i.RoleDefinitions),n.addProp(o._Web,"roleAssignments",i.RoleAssignments),n.addProp(o._Web,"firstUniqueAncestorSecurableObject",a.SharePointQueryableInstance),o._Web.prototype.getUserEffectivePermissions=s.getUserEffectivePermissions,o._Web.prototype.getCurrentUserEffectivePermissions=s.getCurrentUserEffectivePermissions,o._Web.prototype.breakRoleInheritance=s.breakRoleInheritance,o._Web.prototype.resetRoleInheritance=s.resetRoleInheritance,o._Web.prototype.userHasPermissions=s.userHasPermissions,o._Web.prototype.currentUserHasPermissions=s.currentUserHasPermissions,o._Web.prototype.hasPermissions=s.hasPermissions},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(190),r(191),r(192),r(193);var n=r(26);t.SPSharedObjectType=n.SPSharedObjectType,t.SharingDomainRestrictionMode=n.SharingDomainRestrictionMode,t.SharingLinkKind=n.SharingLinkKind,t.SharingOperationStatusCode=n.SharingOperationStatusCode,t.SharingRole=n.SharingRole,t.RoleType=n.RoleType},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(194);var n=r(14),o=r(51),i=r(51);t.SiteDesigns=i.SiteDesigns,Reflect.defineProperty(n.SPRest.prototype,"siteDesigns",{configurable:!0,enumerable:!0,get:function(){return o.SiteDesigns(this._baseUrl)}})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(195);var n=r(34);t.SiteGroup=n.SiteGroup,t.SiteGroups=n.SiteGroups},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(196),r(197);var n=r(14),o=r(35),i=r(35);t.SiteScripts=i.SiteScripts,Reflect.defineProperty(n.SPRest.prototype,"siteScripts",{configurable:!0,enumerable:!0,get:function(){return o.SiteScripts(this._baseUrl)}})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(198);var n=r(48);t.SiteUser=n.SiteUser,t.SiteUsers=n.SiteUsers},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(109),o=r(14),i=r(109);t.MySocial=i.MySocial,t.Social=i.Social,t.SocialActorType=i.SocialActorType,t.SocialActorTypes=i.SocialActorTypes,t.SocialFollowResult=i.SocialFollowResult,t.SocialStatusCode=i.SocialStatusCode,Reflect.defineProperty(o.SPRest.prototype,"social",{configurable:!0,enumerable:!0,get:function(){return n.Social(this._baseUrl)}})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(3),i=r(6),a=r(2),s=r(8),u=r(0),c=r(4),l=r(5),p=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),Object.defineProperty(r.prototype,"my",{get:function(){return t.MySocial(this)},enumerable:!0,configurable:!0}),r.prototype.getFollowedSitesUri=function(){return n.__awaiter(this,void 0,void 0,(function(){var e;return n.__generator(this,(function(t){switch(t.label){case 0:return[4,this.clone(d,"FollowedSitesUri").get()];case 1:return[2,(e=t.sent()).FollowedSitesUri||e]}}))}))},r.prototype.getFollowedDocumentsUri=function(){return n.__awaiter(this,void 0,void 0,(function(){var e;return n.__generator(this,(function(t){switch(t.label){case 0:return[4,this.clone(d,"FollowedDocumentsUri").get()];case 1:return[2,(e=t.sent()).FollowedDocumentsUri||e]}}))}))},r.prototype.follow=function(e){return n.__awaiter(this,void 0,void 0,(function(){return n.__generator(this,(function(t){switch(t.label){case 0:return[4,c.spPost(this.clone(d,"follow"),this.createSocialActorInfoRequestBody(e))];case 1:return[2,t.sent()]}}))}))},r.prototype.isFollowed=function(e){return n.__awaiter(this,void 0,void 0,(function(){return n.__generator(this,(function(t){switch(t.label){case 0:return[4,c.spPost(this.clone(d,"isfollowed"),this.createSocialActorInfoRequestBody(e))];case 1:return[2,t.sent()]}}))}))},r.prototype.stopFollowing=function(e){return n.__awaiter(this,void 0,void 0,(function(){return n.__generator(this,(function(t){switch(t.label){case 0:return[4,c.spPost(this.clone(d,"stopfollowing"),this.createSocialActorInfoRequestBody(e))];case 1:return[2,t.sent()]}}))}))},r.prototype.createSocialActorInfoRequestBody=function(e){return u.body({actor:Object.assign(s.metadata("SP.Social.SocialActorInfo"),{Id:null},e)})},n.__decorate([l.tag("soc.getFollowedSitesUri")],r.prototype,"getFollowedSitesUri",null),n.__decorate([l.tag("soc.getFollowedDocumentsUri")],r.prototype,"getFollowedDocumentsUri",null),n.__decorate([l.tag("soc.follow")],r.prototype,"follow",null),n.__decorate([l.tag("soc.isFollowed")],r.prototype,"isFollowed",null),n.__decorate([l.tag("soc.stopFollowing")],r.prototype,"stopFollowing",null),r=n.__decorate([i.defaultPath("_api/social.following")],r)}(o._SharePointQueryableInstance);t._Social=p,t.Social=function(e){return new p(e)};var d=function(e,t){return new p(e,t)},h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.followed=function(e){return n.__awaiter(this,void 0,void 0,(function(){var t;return n.__generator(this,(function(r){switch(r.label){case 0:return[4,this.clone(f,"followed(types="+e+")")()];case 1:return t=r.sent(),[2,a.hOP(t,"Followed")?t.Followed.results:t]}}))}))},t.prototype.followedCount=function(e){return n.__awaiter(this,void 0,void 0,(function(){var t;return n.__generator(this,(function(r){switch(r.label){case 0:return[4,this.clone(f,"followedcount(types="+e+")")()];case 1:return[2,(t=r.sent()).FollowedCount||t]}}))}))},t.prototype.followers=function(){return n.__awaiter(this,void 0,void 0,(function(){var e;return n.__generator(this,(function(t){switch(t.label){case 0:return[4,this.clone(f,"followers")()];case 1:return e=t.sent(),[2,a.hOP(e,"Followers")?e.Followers.results:e]}}))}))},t.prototype.suggestions=function(){return n.__awaiter(this,void 0,void 0,(function(){var e;return n.__generator(this,(function(t){switch(t.label){case 0:return[4,this.clone(f,"suggestions")()];case 1:return e=t.sent(),[2,a.hOP(e,"Suggestions")?e.Suggestions.results:e]}}))}))},n.__decorate([l.tag("msoc.followed")],t.prototype,"followed",null),n.__decorate([l.tag("msoc.followedCount")],t.prototype,"followedCount",null),n.__decorate([l.tag("msoc.followers")],t.prototype,"followers",null),n.__decorate([l.tag("msoc.suggestions")],t.prototype,"suggestions",null),t=n.__decorate([i.defaultPath("my")],t)}(o._SharePointQueryableInstance);t._MySocial=h,t.MySocial=o.spInvokableFactory(h);var f=function(e,r){return t.MySocial(e,r)};!function(e){e[e.User=0]="User",e[e.Document=1]="Document",e[e.Site=2]="Site",e[e.Tag=3]="Tag"}(t.SocialActorType||(t.SocialActorType={})),function(e){e[e.None=0]="None",e[e.User=1]="User",e[e.Document=2]="Document",e[e.Site=4]="Site",e[e.Tag=8]="Tag",e[e.ExcludeContentWithoutFeeds=268435456]="ExcludeContentWithoutFeeds",e[e.IncludeGroupsSites=536870912]="IncludeGroupsSites",e[e.WithinLast24Hours=1073741824]="WithinLast24Hours"}(t.SocialActorTypes||(t.SocialActorTypes={})),function(e){e[e.Ok=0]="Ok",e[e.AlreadyFollowing=1]="AlreadyFollowing",e[e.LimitReached=2]="LimitReached",e[e.InternalError=3]="InternalError"}(t.SocialFollowResult||(t.SocialFollowResult={})),function(e){e[e.OK=0]="OK",e[e.InvalidRequest=1]="InvalidRequest",e[e.AccessDenied=2]="AccessDenied",e[e.ItemNotFound=3]="ItemNotFound",e[e.InvalidOperation=4]="InvalidOperation",e[e.ItemNotModified=5]="ItemNotModified",e[e.InternalError=6]="InternalError",e[e.CacheReadError=7]="CacheReadError",e[e.CacheUpdateError=8]="CacheUpdateError",e[e.PersonalSiteNotFound=9]="PersonalSiteNotFound",e[e.FailedToCreatePersonalSite=10]="FailedToCreatePersonalSite",e[e.NotAuthorizedToCreatePersonalSite=11]="NotAuthorizedToCreatePersonalSite",e[e.CannotCreatePersonalSite=12]="CannotCreatePersonalSite",e[e.LimitReached=13]="LimitReached",e[e.AttachmentError=14]="AttachmentError",e[e.PartialData=15]="PartialData",e[e.FeatureDisabled=16]="FeatureDisabled",e[e.StorageQuotaExceeded=17]="StorageQuotaExceeded",e[e.DatabaseError=18]="DatabaseError"}(t.SocialStatusCode||(t.SocialStatusCode={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(14),o=r(111),i=r(111);t.Utilities=i.Utilities,Reflect.defineProperty(n.SPRest.prototype,"utility",{configurable:!0,enumerable:!0,get:function(){return o.Utilities(this._baseUrl,"")}})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(3),i=r(2),a=r(0),s=r(15),u=r(8),c=r(20),l=r(12),p=r(4),d=r(5),h=r(67),f=function(e){function t(t,r){var n="string"==typeof t?t:t.toUrl();return e.call(this,l.extractWebUrl(n),"_api/SP.Utilities.Utility."+r)||this}return n.__extends(t,e),t.prototype.excute=function(e){return p.spPost(this,a.body(e))},t.prototype.sendEmail=function(e){var t={properties:i.assign(u.metadata("SP.Utilities.EmailProperties"),{Body:e.Body,From:e.From,Subject:e.Subject})};return e.To&&e.To.length>0&&(t.properties=i.assign(t.properties,{To:{results:e.To}})),e.CC&&e.CC.length>0&&(t.properties=i.assign(t.properties,{CC:{results:e.CC}})),e.BCC&&e.BCC.length>0&&(t.properties=i.assign(t.properties,{BCC:{results:e.BCC}})),e.AdditionalHeaders&&(t.properties=i.assign(t.properties,{AdditionalHeaders:h.objectToSPKeyValueCollection(e.AdditionalHeaders)})),d.tag.configure(this.clone(y,"SendEmail",!0),"u.sendEmail").excute(t)},t.prototype.getCurrentUserEmailAddresses=function(){return d.tag.configure(this.clone(y,"GetCurrentUserEmailAddresses",!0),"u.getCurrentUserEmailAddresses").excute({})},t.prototype.resolvePrincipal=function(e,t,r,n,o,i){void 0===i&&(i=!1);var a={addToUserInfoList:o,input:e,inputIsEmailOnly:n,matchUserInfoList:i,scopes:t,sources:r},s=this.clone(y,"ResolvePrincipalInCurrentContext",!0);return d.tag.configure(s,"u.ResolvePrincipalInCurrentContext").excute(a)},t.prototype.searchPrincipals=function(e,t,r,n,o){var i={groupName:n,input:e,maxCount:o,scopes:t,sources:r},a=this.clone(y,"SearchPrincipalsUsingContextWeb",!0);return d.tag.configure(a,"u.SearchPrincipalsUsingContextWeb").excute(i)},t.prototype.createEmailBodyForInvitation=function(e){var t={pageAddress:e},r=this.clone(y,"CreateEmailBodyForInvitation",!0);return d.tag.configure(r,"u.CreateEmailBodyForInvitation").excute(t)},t.prototype.expandGroupsToPrincipals=function(e,t){void 0===t&&(t=30);var r={inputs:e,maxCount:t},n=this.clone(y,"ExpandGroupsToPrincipals",!0);return d.tag.configure(n,"u.ExpandGroupsToPrincipals").excute(r)},t.prototype.createWikiPage=function(e){return n.__awaiter(this,void 0,void 0,(function(){var t,r;return n.__generator(this,(function(n){switch(n.label){case 0:return t=this.clone(y,"CreateWikiPageInContextWeb",!0),[4,d.tag.configure(t,"u.CreateWikiPageInContextWeb").excute({parameters:e})];case 1:return[2,{data:r=n.sent(),file:c.File(s.odataUrlFrom(r))}]}}))}))},t}(o._SharePointQueryable);t._Utilities=f,t.Utilities=o.spInvokableFactory(f);var y=function(e,r){return t.Utilities(e,r)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(199);var n=r(113);t.Subscription=n.Subscription,t.Subscriptions=n.Subscriptions},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(3),i=r(0),a=r(6),s=r(4),u=r(5),c=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r.prototype.getById=function(e){return u.tag.configure(t.Subscription(this).concat("('"+e+"')"),"subs.getById")},r.prototype.add=function(e,t,r){return n.__awaiter(this,void 0,void 0,(function(){var o,a;return n.__generator(this,(function(n){switch(n.label){case 0:return o={expirationDateTime:t,notificationUrl:e,resource:this.toUrl()},r&&(o.clientState=r),[4,s.spPost(this,i.body(o,i.headers({"Content-Type":"application/json"})))];case 1:return[2,{data:a=n.sent(),subscription:this.getById(a.id)}]}}))}))},n.__decorate([u.tag("subs.add")],r.prototype,"add",null),r=n.__decorate([a.defaultPath("subscriptions")],r)}(o._SharePointQueryableCollection);t._Subscriptions=c,t.Subscriptions=o.spInvokableFactory(c);var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.update=function(e,t,r){return n.__awaiter(this,void 0,void 0,(function(){var o;return n.__generator(this,(function(n){switch(n.label){case 0:return o={},e&&(o.expirationDateTime=e),t&&(o.notificationUrl=t),r&&(o.clientState=r),[4,s.spPatch(this,i.body(o,i.headers({"Content-Type":"application/json"})))];case 1:return[2,{data:n.sent(),subscription:this}]}}))}))},t.prototype.delete=function(){return s.spDelete(this)},n.__decorate([u.tag("sub.update")],t.prototype,"update",null),n.__decorate([u.tag("sub.delete")],t.prototype,"delete",null),t}(o._SharePointQueryableInstance);t._Subscription=l,t.Subscription=o.spInvokableFactory(l)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(200),r(201),r(202);var n=r(36);t.UserCustomAction=n.UserCustomAction,t.UserCustomActions=n.UserCustomActions,t.UserCustomActionRegistrationType=n.UserCustomActionRegistrationType,t.UserCustomActionScope=n.UserCustomActionScope},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(203);var n=r(116);t.View=n.View,t.ViewFields=n.ViewFields,t.Views=n.Views,t.ViewScope=n.ViewScope},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(0),i=r(3),a=r(8),s=r(6),u=r(4),c=r(5),l=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r.prototype.getById=function(e){return t.View(this).concat("('"+e+"')")},r.prototype.getByTitle=function(e){return t.View(this,"getByTitle('"+e+"')")},r.prototype.add=function(e,r,i){return void 0===r&&(r=!1),void 0===i&&(i={}),n.__awaiter(this,void 0,void 0,(function(){var s,c;return n.__generator(this,(function(n){switch(n.label){case 0:return s=o.body(Object.assign(a.metadata("SP.View"),{PersonalView:r,Title:e},i)),[4,u.spPost(this.clone(t.Views,null),s)];case 1:return[2,{data:c=n.sent(),view:this.getById(c.Id)}]}}))}))},n.__decorate([c.tag("vs.add")],r.prototype,"add",null),r=n.__decorate([s.defaultPath("views")],r)}(i._SharePointQueryableCollection);t._Views=l,t.Views=i.spInvokableFactory(l);var p=function(e){function r(){var t=null!==e&&e.apply(this,arguments)||this;return t.delete=i.deleteable("vw"),t.update=t._update("SP.View",(function(e){return{data:e,view:t}})),t}return n.__extends(r,e),Object.defineProperty(r.prototype,"fields",{get:function(){return t.ViewFields(this)},enumerable:!0,configurable:!0}),r.prototype.renderAsHtml=function(){return this.clone(t.View,"renderashtml")()},r.prototype.setViewXml=function(e){return u.spPost(this.clone(t.View,"SetViewXml"),o.body({viewXml:e}))},n.__decorate([c.tag("v.renderAsHtml")],r.prototype,"renderAsHtml",null),n.__decorate([c.tag("v.setViewXml")],r.prototype,"setViewXml",null),r}(i._SharePointQueryableInstance);t._View=p,t.View=i.spInvokableFactory(p);var d=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r.prototype.getSchemaXml=function(){return this.clone(t.ViewFields,"schemaxml")()},r.prototype.add=function(e){return u.spPost(this.clone(t.ViewFields,"addviewfield('"+e+"')"))},r.prototype.move=function(e,r){return u.spPost(this.clone(t.ViewFields,"moveviewfieldto"),o.body({field:e,index:r}))},r.prototype.removeAll=function(){return u.spPost(this.clone(t.ViewFields,"removeallviewfields"))},r.prototype.remove=function(e){return u.spPost(this.clone(t.ViewFields,"removeviewfield('"+e+"')"))},n.__decorate([c.tag("vfs.getSchemaXml")],r.prototype,"getSchemaXml",null),n.__decorate([c.tag("vfs.add")],r.prototype,"add",null),n.__decorate([c.tag("vfs.move")],r.prototype,"move",null),n.__decorate([c.tag("vfs.removeAll")],r.prototype,"removeAll",null),n.__decorate([c.tag("vfs.remove")],r.prototype,"remove",null),r=n.__decorate([s.defaultPath("viewfields")],r)}(i._SharePointQueryableCollection);t._ViewFields=d,t.ViewFields=i.spInvokableFactory(d),function(e){e[e.DefaultValue=0]="DefaultValue",e[e.Recursive=1]="Recursive",e[e.RecursiveAll=2]="RecursiveAll",e[e.FilesOnly=3]="FilesOnly"}(t.ViewScope||(t.ViewScope={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(204);var n=r(118);t.WebPartsPersonalizationScope=n.WebPartsPersonalizationScope,t.WebPartDefinitions=n.WebPartDefinitions,t.WebPartDefinition=n.WebPartDefinition,t.LimitedWebPartManager=n.LimitedWebPartManager},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(3),i=r(0),a=r(4),s=r(5),u=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),Object.defineProperty(r.prototype,"scope",{get:function(){return s.tag.configure(o.SharePointQueryable(this,"Scope"),"f.scope")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"webparts",{get:function(){return t.WebPartDefinitions(this,"webparts")},enumerable:!0,configurable:!0}),r.prototype.export=function(e){return a.spPost(this.clone(c,"ExportWebPart"),i.body({webPartId:e}))},r.prototype.import=function(e){return a.spPost(this.clone(c,"ImportWebPart"),i.body({webPartXml:e}))},r}(o._SharePointQueryable);t._LimitedWebPartManager=u,t.LimitedWebPartManager=function(e,t){return new u(e,t)};var c=function(e,r){return t.LimitedWebPartManager(e,r)},l=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r.prototype.getById=function(e){return t.WebPartDefinition(this,"getbyid('"+e+"')")},r.prototype.getByControlId=function(e){return t.WebPartDefinition(this,"getByControlId('"+e+"')")},r}(o._SharePointQueryableCollection);t._WebPartDefinitions=l,t.WebPartDefinitions=o.spInvokableFactory(l);var p=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),Object.defineProperty(r.prototype,"webpart",{get:function(){return o.SharePointQueryableInstance(this,"webpart")},enumerable:!0,configurable:!0}),r.prototype.saveChanges=function(){return a.spPost(this.clone(t.WebPartDefinition,"SaveWebPartChanges"))},r.prototype.moveTo=function(e,r){return a.spPost(this.clone(t.WebPartDefinition,"MoveWebPartTo(zoneID='"+e+"', zoneIndex="+r+")"))},r.prototype.close=function(){return a.spPost(this.clone(t.WebPartDefinition,"CloseWebPart"))},r.prototype.open=function(){return a.spPost(this.clone(t.WebPartDefinition,"OpenWebPart"))},r.prototype.delete=function(){return a.spPost(this.clone(t.WebPartDefinition,"DeleteWebPart"))},r}(o._SharePointQueryableInstance);t._WebPartDefinition=p,t.WebPartDefinition=o.spInvokableFactory(p),function(e){e[e.User=0]="User",e[e.Shared=1]="Shared"}(t.WebPartsPersonalizationScope||(t.WebPartsPersonalizationScope={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1);r(120),r(122),r(124),r(126),r(127),r(128),r(129),r(131),r(133),r(135),r(137),r(139),r(140),r(142),r(143),n.__exportStar(r(120),t),n.__exportStar(r(122),t),n.__exportStar(r(124),t),n.__exportStar(r(126),t),n.__exportStar(r(127),t),n.__exportStar(r(128),t),n.__exportStar(r(129),t),n.__exportStar(r(131),t),n.__exportStar(r(133),t),n.__exportStar(r(135),t),n.__exportStar(r(137),t),n.__exportStar(r(139),t),n.__exportStar(r(140),t),n.__exportStar(r(142),t),n.__exportStar(r(143),t);var o=r(19);t.graph=o.graph,t.GraphRest=o.GraphRest},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(205);var n=r(121);t.Attachment=n.Attachment,t.Attachments=n.Attachments},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(0),i=r(9),a=r(10),s=r(11),u=r(206),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t}(i._GraphQueryableInstance);t._Attachment=c,t.Attachment=i.graphInvokableFactory(c);var l=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r.prototype.addFile=function(e,t){return a.graphPost(this,o.body(u.type("#microsoft.graph.fileAttachment",{contentBytes:t,name:e})))},r=n.__decorate([s.defaultPath("attachments"),s.getById(t.Attachment)],r)}(i._GraphQueryableCollection);t._Attachments=l,t.Attachments=i.graphInvokableFactory(l)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(207);var n=r(123);t.Calendar=n.Calendar,t.Calendars=n.Calendars,t.Event=n.Event,t.Events=n.Events},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(0),i=r(9),a=r(11),s=r(10),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t=n.__decorate([a.defaultPath("calendars")],t)}(i._GraphQueryableCollection);t._Calendars=u,t.Calendars=i.graphInvokableFactory(u);var c=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),Object.defineProperty(r.prototype,"events",{get:function(){return t.Events(this)},enumerable:!0,configurable:!0}),r}(i._GraphQueryableInstance);t._Calendar=c,t.Calendar=i.graphInvokableFactory(c);var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t=n.__decorate([a.deleteable(),a.updateable()],t)}(i._GraphQueryableInstance);t._Event=l,t.Event=i.graphInvokableFactory(l);var p=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r.prototype.add=function(e){return n.__awaiter(this,void 0,void 0,(function(){var t;return n.__generator(this,(function(r){switch(r.label){case 0:return[4,s.graphPost(this,o.body(e))];case 1:return[2,{data:t=r.sent(),event:this.getById(t.id)}]}}))}))},r=n.__decorate([a.defaultPath("events"),a.getById(t.Event)],r)}(i._GraphQueryableCollection);t._Events=p,t.Events=i.graphInvokableFactory(p)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(208);var n=r(125);t.Contact=n.Contact,t.ContactFolder=n.ContactFolder,t.ContactFolders=n.ContactFolders,t.Contacts=n.Contacts},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(9),i=r(2),a=r(11),s=r(10),u=r(0),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t=n.__decorate([a.updateable(),a.deleteable()],t)}(o._GraphQueryableInstance);t._Contact=c,t.Contact=o.graphInvokableFactory(c);var l=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r.prototype.add=function(e,t,r,o,a){return void 0===a&&(a={}),n.__awaiter(this,void 0,void 0,(function(){var c,l;return n.__generator(this,(function(n){switch(n.label){case 0:return c=i.assign({businessPhones:o,emailAddresses:r,givenName:e,surName:t},a),[4,s.graphPost(this,u.body(c))];case 1:return l=n.sent(),[2,{contact:this.getById(l.id),data:l}]}}))}))},r=n.__decorate([a.defaultPath("contacts"),a.getById(t.Contact)],r)}(o._GraphQueryableCollection);t._Contacts=l,t.Contacts=o.graphInvokableFactory(l);var p=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),Object.defineProperty(r.prototype,"contacts",{get:function(){return t.Contacts(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"childFolders",{get:function(){return t.ContactFolders(this,"childFolders")},enumerable:!0,configurable:!0}),r=n.__decorate([a.deleteable(),a.updateable()],r)}(o._GraphQueryableInstance);t._ContactFolder=p,t.ContactFolder=o.graphInvokableFactory(p);var d=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r.prototype.add=function(e,t){return n.__awaiter(this,void 0,void 0,(function(){var r,o;return n.__generator(this,(function(n){switch(n.label){case 0:return r={displayName:e,parentFolderId:t},[4,s.graphPost(this,u.body(r))];case 1:return o=n.sent(),[2,{contactFolder:this.getById(o.id),data:o}]}}))}))},r=n.__decorate([a.defaultPath("contactFolders"),a.getById(t.ContactFolder)],r)}(o._GraphQueryableCollection);t._ContactFolders=d,t.ContactFolders=o.graphInvokableFactory(d)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(209);var n=r(52);t.Conversation=n.Conversation,t.Conversations=n.Conversations,t.Post=n.Post,t.Posts=n.Posts,t.Senders=n.Senders,t.Thread=n.Thread,t.Threads=n.Threads},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(19),o=r(37),i=r(37);t.DirectoryObjectTypes=i.DirectoryObjectTypes,t.DirectoryObject=i.DirectoryObject,t.DirectoryObjects=i.DirectoryObjects,Reflect.defineProperty(n.GraphRest.prototype,"directoryObjects",{configurable:!0,enumerable:!0,get:function(){return o.DirectoryObjects(this)}})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(19),o=r(21),i=r(21);t.Group=i.Group,t.GroupType=i.GroupType,t.Groups=i.Groups,Reflect.defineProperty(n.GraphRest.prototype,"groups",{configurable:!0,enumerable:!0,get:function(){return o.Groups(this)}})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(210);var n=r(130);t.Member=n.Member,t.Members=n.Members},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(0),i=r(9),a=r(11),s=r(10),u=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r.prototype.remove=function(){return s.graphDelete(this.clone(t.Member,"$ref"))},r}(i._GraphQueryableInstance);t._Member=u,t.Member=i.graphInvokableFactory(u);var c=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r.prototype.add=function(e){return s.graphPost(this.clone(t.Members,"$ref"),o.body({"@odata.id":e}))},r=n.__decorate([a.defaultPath("members"),a.getById(t.Member)],r)}(i._GraphQueryableCollection);t._Members=c,t.Members=i.graphInvokableFactory(c)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(211);var n=r(132);t.MailFolder=n.MailFolder,t.MailFolders=n.MailFolders,t.MailboxSettings=n.MailboxSettings,t.Message=n.Message,t.Messages=n.Messages},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(9),i=r(11),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t}(o._GraphQueryableInstance);t._Message=a,t.Message=o.graphInvokableFactory(a);var s=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r=n.__decorate([i.defaultPath("messages"),i.getById(t.Message),i.addable()],r)}(o._GraphQueryableCollection);t._Messages=s,t.Messages=o.graphInvokableFactory(s);var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t}(o._GraphQueryableInstance);t._MailFolder=u,t.MailFolder=o.graphInvokableFactory(u);var c=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r=n.__decorate([i.defaultPath("mailFolders"),i.getById(t.MailFolder),i.addable()],r)}(o._GraphQueryableCollection);t._MailFolders=c,t.MailFolders=o.graphInvokableFactory(c);var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t=n.__decorate([i.defaultPath("mailboxSettings"),i.updateable()],t)}(o._GraphQueryableInstance);t._MailboxSettings=l,t.MailboxSettings=o.graphInvokableFactory(l)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(212);var n=r(134);t.Drive=n.Drive,t.DriveItem=n.DriveItem,t.DriveItems=n.DriveItems,t.Drives=n.Drives,t.Root=n.Root},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(9),i=r(2),a=r(11),s=r(0),u=r(10),c=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),Object.defineProperty(r.prototype,"root",{get:function(){return t.Root(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"list",{get:function(){return o.GraphQueryableInstance(this,"list")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"recent",{get:function(){return t.DriveItems(this,"recent")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"sharedWithMe",{get:function(){return t.DriveItems(this,"sharedWithMe")},enumerable:!0,configurable:!0}),r.prototype.getItemById=function(e){return t.DriveItem(this,i.combine("items",e))},r=n.__decorate([a.defaultPath("drive")],r)}(o._GraphQueryableInstance);t._Drive=c,t.Drive=o.graphInvokableFactory(c);var l=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r=n.__decorate([a.defaultPath("drives"),a.getById(t.Drive)],r)}(o._GraphQueryableCollection);t._Drives=l,t.Drives=o.graphInvokableFactory(l);var p=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),Object.defineProperty(r.prototype,"children",{get:function(){return t.DriveItems(this,"children")},enumerable:!0,configurable:!0}),r.prototype.search=function(e){var r=this.clone(t.Root);return r.query.set("search","'"+e+"'"),r()},Object.defineProperty(r.prototype,"thumbnails",{get:function(){return o.GraphQueryableCollection(this,"thumbnails")},enumerable:!0,configurable:!0}),r=n.__decorate([a.defaultPath("root")],r)}(o._GraphQueryableInstance);t._Root=p,t.Root=o.graphInvokableFactory(p);var d=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),Object.defineProperty(r.prototype,"children",{get:function(){return t.DriveItems(this,"children")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"thumbnails",{get:function(){return o.GraphQueryableCollection(this,"thumbnails")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"versions",{get:function(){return o.GraphQueryableCollection(this,"versions")},enumerable:!0,configurable:!0}),r.prototype.move=function(e,t){return u.graphPatch(this,s.body(i.assign(e,{name:t})))},r.prototype.getContent=function(){return u.graphGet(this.clone(t.DriveItem,"content"))},r.prototype.setContent=function(e){return u.graphPut(this.clone(t.DriveItem,"content"),{body:e})},r=n.__decorate([a.deleteable(),a.updateable()],r)}(o._GraphQueryableInstance);t._DriveItem=d,t.DriveItem=o.graphInvokableFactory(d);var h=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r=n.__decorate([a.getById(t.DriveItem)],r)}(o._GraphQueryableCollection);t._DriveItems=h,t.DriveItems=o.graphInvokableFactory(h)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(213);var n=r(136);t.Notebook=n.Notebook,t.Notebooks=n.Notebooks,t.OneNote=n.OneNote,t.Section=n.Section,t.Sections=n.Sections},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(0),i=r(9),a=r(11),s=r(10),u=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),Object.defineProperty(r.prototype,"notebooks",{get:function(){return t.Notebooks(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"sections",{get:function(){return t.Sections(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"pages",{get:function(){return i.GraphQueryableCollection(this,"pages")},enumerable:!0,configurable:!0}),r=n.__decorate([a.defaultPath("onenote")],r)}(i._GraphQueryableInstance);t._OneNote=u,t.OneNote=i.graphInvokableFactory(u);var c=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),Object.defineProperty(r.prototype,"sections",{get:function(){return t.Sections(this)},enumerable:!0,configurable:!0}),r}(i._GraphQueryableInstance);t._Notebook=c,t.Notebook=i.graphInvokableFactory(c);var l=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r.prototype.add=function(e){return n.__awaiter(this,void 0,void 0,(function(){var t;return n.__generator(this,(function(r){switch(r.label){case 0:return[4,s.graphPost(this,o.body({displayName:e}))];case 1:return[2,{data:t=r.sent(),notebook:this.getById(t.id)}]}}))}))},r=n.__decorate([a.defaultPath("notebooks"),a.getById(t.Notebook)],r)}(i._GraphQueryableCollection);t._Notebooks=l,t.Notebooks=i.graphInvokableFactory(l);var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t}(i._GraphQueryableInstance);t._Section=p,t.Section=i.graphInvokableFactory(p);var d=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r.prototype.add=function(e){return n.__awaiter(this,void 0,void 0,(function(){var t;return n.__generator(this,(function(r){switch(r.label){case 0:return[4,s.graphPost(this,o.body({displayName:e}))];case 1:return[2,{data:t=r.sent(),section:this.getById(t.id)}]}}))}))},r=n.__decorate([a.defaultPath("sections"),a.getById(t.Section)],r)}(i._GraphQueryableCollection);t._Sections=d,t.Sections=i.graphInvokableFactory(d)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(214);var n=r(138);t.Photo=n.Photo},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(9),i=r(0),a=r(11),s=r(10),u=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r.prototype.getBlob=function(){return this.clone(t.Photo,"$value",!1).usingParser(new i.BlobParser)()},r.prototype.getBuffer=function(){return this.clone(t.Photo,"$value",!1).usingParser(new i.BufferParser)()},r.prototype.setContent=function(e){return s.graphPatch(this.clone(t.Photo,"$value",!1),{body:e})},r=n.__decorate([a.defaultPath("photo")],r)}(o._GraphQueryableInstance);t._Photo=u,t.Photo=o.graphInvokableFactory(u)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(19),o=r(38);r(215),r(216);var i=r(38);t.Bucket=i.Bucket,t.Buckets=i.Buckets,t.Plan=i.Plan,t.Planner=i.Planner,t.Plans=i.Plans,t.Task=i.Task,t.Tasks=i.Tasks,Reflect.defineProperty(n.GraphRest.prototype,"planner",{configurable:!0,enumerable:!0,get:function(){return o.Planner(this)}})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(19),o=r(141),i=r(141);t.Subscription=i.Subscription,t.Subscriptions=i.Subscriptions,Reflect.defineProperty(n.GraphRest.prototype,"subscriptions",{configurable:!0,enumerable:!0,get:function(){return o.Subscriptions(this)}})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(9),i=r(2),a=r(0),s=r(11),u=r(10),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t=n.__decorate([s.deleteable(),s.updateable()],t)}(o._GraphQueryableInstance);t._Subscription=c,t.Subscription=o.graphInvokableFactory(c);var l=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r.prototype.add=function(e,t,r,o,s){return void 0===s&&(s={}),n.__awaiter(this,void 0,void 0,(function(){var c,l;return n.__generator(this,(function(n){switch(n.label){case 0:return c=i.assign({changeType:e,expirationDateTime:o,notificationUrl:t,resource:r},s),[4,u.graphPost(this,a.body(c))];case 1:return[2,{data:l=n.sent(),subscription:this.getById(l.id)}]}}))}))},r=n.__decorate([s.defaultPath("subscriptions"),s.getById(t.Subscription)],r)}(o._GraphQueryableCollection);t._Subscriptions=l,t.Subscriptions=o.graphInvokableFactory(l)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(0),i=r(19),a=r(21),s=r(53),u=r(10);r(217);var c=r(53);t.Channel=c.Channel,t.Channels=c.Channels,t.Tab=c.Tab,t.Tabs=c.Tabs,t.Team=c.Team,t.Teams=c.Teams,o.addProp(a._Group,"team",s.Team),a._Group.prototype.createTeam=function(e){return n.__awaiter(this,void 0,void 0,(function(){return n.__generator(this,(function(t){switch(t.label){case 0:return[4,u.graphPut(this.clone(a.Group,"team"),o.body(e))];case 1:return[2,{data:t.sent(),team:this.team}]}}))}))},Reflect.defineProperty(i.GraphRest.prototype,"teams",{configurable:!0,enumerable:!0,get:function(){return s.Teams(this)}})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(19),o=r(22),i=r(22);t.User=i.User,t.Users=i.Users,Reflect.defineProperty(n.GraphRest.prototype,"me",{configurable:!0,enumerable:!0,get:function(){return o.User(this,"me")}}),Reflect.defineProperty(n.GraphRest.prototype,"users",{configurable:!0,enumerable:!0,get:function(){return o.Users(this)}})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(18),i=r(2),a=r(57),s=r(157),u=r(162),c=r(163);r(70),r(119),n.__exportStar(r(2),t),n.__exportStar(r(18),t),n.__exportStar(r(57),t),n.__exportStar(r(0),t),n.__exportStar(r(218),t),n.__exportStar(r(219),t),t.util={assign:i.assign,combine:i.combine,dateAdd:i.dateAdd,getCtxCallback:i.getCtxCallback,getGUID:i.getGUID,getRandomString:i.getRandomString,isArray:i.isArray,isFunc:i.isFunc,isUrlAbsolute:i.isUrlAbsolute,objectDefinedNotNull:i.objectDefinedNotNull,sanitizeGuid:i.sanitizeGuid,stringIsNullOrEmpty:i.stringIsNullOrEmpty},t.sp=s.sp,t.graph=c.graph,t.storage=new i.PnPClientStorage,t.config=new a.Settings,t.log=o.Logger,t.setup=u.setup;var l={config:t.config,graph:t.graph,log:t.log,setup:t.setup,sp:t.sp,storage:t.storage,util:t.util};t.default=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return Object.defineProperty(e,"activeLogLevel",{get:function(){return e.instance.activeLogLevel},set:function(t){e.instance.activeLogLevel=t},enumerable:!0,configurable:!0}),Object.defineProperty(e,"instance",{get:function(){return void 0!==e._instance&&null!==e._instance||(e._instance=new o),e._instance},enumerable:!0,configurable:!0}),e.subscribe=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];t.forEach((function(t){return e.instance.subscribe(t)}))},e.clearSubscribers=function(){return e.instance.clearSubscribers()},Object.defineProperty(e,"count",{get:function(){return e.instance.count},enumerable:!0,configurable:!0}),e.write=function(t,r){void 0===r&&(r=1),e.instance.log({level:r,message:t})},e.writeJSON=function(e,t){void 0===t&&(t=1),this.write(JSON.stringify(e),t)},e.log=function(t){e.instance.log(t)},e.error=function(t){e.instance.log({data:t,level:3,message:t.message})},e}();t.Logger=n;var o=function(){function e(e,t){void 0===e&&(e=2),void 0===t&&(t=[]),this.activeLogLevel=e,this.subscribers=t}return e.prototype.subscribe=function(e){this.subscribers.push(e)},e.prototype.clearSubscribers=function(){var e=this.subscribers.slice(0);return this.subscribers.length=0,e},Object.defineProperty(e.prototype,"count",{get:function(){return this.subscribers.length},enumerable:!0,configurable:!0}),e.prototype.write=function(e,t){void 0===t&&(t=1),this.log({level:t,message:e})},e.prototype.log=function(e){void 0!==e&&this.activeLogLevel<=e.level&&this.subscribers.map((function(t){return t.log(e)}))},e}();!function(e){e[e.Verbose=0]="Verbose",e[e.Info=1]="Info",e[e.Warning=2]="Warning",e[e.Error=3]="Error",e[e.Off=99]="Off"}(t.LogLevel||(t.LogLevel={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.log=function(e){var t=this.format(e);switch(e.level){case 0:case 1:console.log(t);break;case 2:console.warn(t);break;case 3:console.error(t)}},e.prototype.format=function(e){var t=[];if(t.push("Message: "+e.message),void 0!==e.data)try{t.push(" Data: "+JSON.stringify(e.data))}catch(e){t.push(" Data: Error in stringify of supplied data "+e)}return t.join("")},e}();t.ConsoleListener=n;var o=function(){function e(e){this.method=e}return e.prototype.log=function(e){this.method(e)},e}();t.FunctionListener=o},function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(27);function i(e,t){o.objectDefinedNotNull(t)&&new Request("",{headers:t}).headers.forEach((function(t,r){e.append(r,t)}))}function a(e){var t=new URL(e);return t.protocol+"//"+t.hostname}t.mergeHeaders=i,t.mergeOptions=function(e,t){if(o.objectDefinedNotNull(t)){var r=o.assign(e.headers||{},t.headers);(e=o.assign(e,t)).headers=r}},t.getADALResource=a;var s=function(){function t(){}return t.prototype.fetch=function(t,r){return e.fetch(t,r)},t}();t.FetchClient=s;var u=function(e){function t(t){var r=e.call(this)||this;return r._token=t,r}return n.__extends(t,e),Object.defineProperty(t.prototype,"token",{get:function(){return this._token||""},set:function(e){this._token=e},enumerable:!0,configurable:!0}),t.prototype.fetch=function(t,r){void 0===r&&(r={});var n=new Headers;return i(n,r.headers),n.set("Authorization","Bearer "+this._token),r.headers=n,e.prototype.fetch.call(this,t,r)},t}(s);t.BearerTokenFetchClient=u;var c=function(e){function t(t){var r=e.call(this,null)||this;return r.context=t,r}return n.__extends(t,e),t.prototype.fetch=function(t,r){return n.__awaiter(this,void 0,void 0,(function(){var o;return n.__generator(this,(function(n){switch(n.label){case 0:return[4,this.getToken(a(t))];case 1:return o=n.sent(),this.token=o,[2,e.prototype.fetch.call(this,t,r)]}}))}))},t.prototype.getToken=function(e){return n.__awaiter(this,void 0,void 0,(function(){return n.__generator(this,(function(t){switch(t.label){case 0:return[4,this.context.aadTokenProviderFactory.getTokenProvider()];case 1:return[2,t.sent().getToken(e)]}}))}))},t}(u);t.SPFxAdalClient=c}).call(this,r(56))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(27),i=r(55),a=function(){function e(e,t){void 0===t&&(t=-1),this.store=e,this.defaultTimeoutMinutes=t,this.enabled=this.test(),i.RuntimeConfig.enableCacheExpiration&&this.cacheExpirationHandler()}return e.bind=function(t){return new e(void 0===t?new s:t)},e.prototype.get=function(e){if(!this.enabled)return null;var t=this.store.getItem(e);if(!o.objectDefinedNotNull(t))return null;var r=JSON.parse(t);return new Date(r.expiration)<=new Date?(this.delete(e),null):r.value},e.prototype.put=function(e,t,r){this.enabled&&this.store.setItem(e,this.createPersistable(t,r))},e.prototype.delete=function(e){this.enabled&&this.store.removeItem(e)},e.prototype.getOrPut=function(e,t,r){return n.__awaiter(this,void 0,void 0,(function(){var o;return n.__generator(this,(function(n){switch(n.label){case 0:return this.enabled?null!==(o=this.get(e))?[3,2]:[4,t()]:[2,t()];case 1:o=n.sent(),this.put(e,o,r),n.label=2;case 2:return[2,o]}}))}))},e.prototype.deleteExpired=function(){return n.__awaiter(this,void 0,void 0,(function(){var e,t;return n.__generator(this,(function(r){switch(r.label){case 0:if(!this.enabled)return[2];e=0,r.label=1;case 1:return e<this.store.length?null===(t=this.store.key(e))?[3,3]:/["|']?pnp["|']? ?: ?1/i.test(this.store.getItem(t))?[4,this.get(t)]:[3,3]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))},e.prototype.test=function(){try{return this.store.setItem("t","t"),this.store.removeItem("t"),!0}catch(e){return!1}},e.prototype.createPersistable=function(e,t){if(void 0===t){var r=i.RuntimeConfig.defaultCachingTimeoutSeconds;this.defaultTimeoutMinutes>0&&(r=60*this.defaultTimeoutMinutes),t=o.dateAdd(new Date,"second",r)}return o.jsS({pnp:1,expiration:t,value:e})},e.prototype.cacheExpirationHandler=function(){var e=this;this.enabled&&this.deleteExpired().then((function(t){setTimeout(o.getCtxCallback(e,e.cacheExpirationHandler),i.RuntimeConfig.cacheExpirationIntervalMilliseconds)})).catch(console.error)},e}();t.PnPClientStorageWrapper=a;var s=function(){function e(e){void 0===e&&(e=new Map),this._store=e}return Object.defineProperty(e.prototype,"length",{get:function(){return this._store.size},enumerable:!0,configurable:!0}),e.prototype.clear=function(){this._store.clear()},e.prototype.getItem=function(e){return this._store.get(e)},e.prototype.key=function(e){return Array.from(this._store)[e][0]},e.prototype.removeItem=function(e){this._store.delete(e)},e.prototype.setItem=function(e,t){this._store.set(e,t)},e}(),u=function(){function e(e,t){void 0===e&&(e=null),void 0===t&&(t=null),this._local=e,this._session=t}return Object.defineProperty(e.prototype,"local",{get:function(){return null===this._local&&(this._local=a.bind(localStorage)),this._local},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"session",{get:function(){return null===this._session&&(this._session=a.bind(sessionStorage)),this._session},enumerable:!0,configurable:!0}),e}();t.PnPClientStorage=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),o=function(){function e(e){void 0===e&&(e=new Map),this._settings=e}return e.prototype.add=function(e,t){this._settings.set(e,t)},e.prototype.addJSON=function(e,t){this._settings.set(e,n.jsS(t))},e.prototype.apply=function(e){var t=this;return new Promise((function(r,o){try{t._settings=n.mergeMaps(t._settings,n.objectToMap(e)),r()}catch(e){o(e)}}))},e.prototype.load=function(e){var t=this;return new Promise((function(r,o){e.getConfiguration().then((function(e){t._settings=n.mergeMaps(t._settings,n.objectToMap(e)),r()})).catch(o)}))},e.prototype.get=function(e){return this._settings.get(e)||null},e.prototype.getJSON=function(e){var t=this.get(e);return null==t?t:JSON.parse(t)},e}();t.Settings=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(58);t.CachingConfigurationProvider=n.default;var o=r(151);t.SPListConfigurationProvider=o.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(58);r(59),r(64);var o=function(){function e(e,t,r,n){void 0===t&&(t="config"),void 0===r&&(r="Title"),void 0===n&&(n="Value"),this.web=e,this.listTitle=t,this.keyFieldName=r,this.valueFieldName=n}return e.prototype.getConfiguration=function(){var e=this;return this.web.lists.getByTitle(this.listTitle).items.select(this.keyFieldName,this.valueFieldName)().then((function(t){return t.reduce((function(t,r){return t[r[e.keyFieldName]]=r[e.valueFieldName],t}),{})}))},e.prototype.asCaching=function(e){return void 0===e&&(e="pnp_configcache_splist_"+this.web.toUrl()+"+"+this.listTitle),new n.default(this,e)},e}();t.default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),o=function(){function e(e){void 0===e&&(e=n.getGUID()),this._batchId=e,this._reqs=[],this._deps=[],this._rDeps=[]}return Object.defineProperty(e.prototype,"batchId",{get:function(){return this._batchId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"requests",{get:function(){return this._reqs},enumerable:!0,configurable:!0}),e.prototype.add=function(e,t,r,n,o){var i={id:o,method:t.toUpperCase(),options:r,parser:n,reject:null,resolve:null,url:e},a=new Promise((function(e,t){i.resolve=e,i.reject=t}));return this._reqs.push(i),a},e.prototype.addDependency=function(){var e=function(){};return this._deps.push(new Promise((function(t){e=t}))),e},e.prototype.addResolveBatchDependency=function(e){this._rDeps.push(e)},e.prototype.execute=function(){var e=this;return Promise.all(this._deps).then((function(){return Promise.all(e._deps)})).then((function(){return e.executeImpl()})).then((function(){return Promise.all(e._rDeps)})).then((function(){}))},e}();t.Batch=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addProp=function(e,t,r,n){Reflect.defineProperty(e.prototype,t,{configurable:!0,enumerable:!0,get:function(){return r(this,n)}})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=r(1),i=r(2),a=r(61);t.invokableFactory=(n=function(e){return this.defaultAction(e)},function(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var s=function(t){var r=Object.assign((function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.apply(r,e)}),new(e.bind.apply(e,o.__spread([void 0],t))));return Reflect.setPrototypeOf(r,e.prototype),r};return i.RuntimeConfig.ie11?s(t):new Proxy(a.applyFactoryExtensions(s,t),{apply:function(e,t,r){return a.extensionOrDefault("apply",(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Reflect.apply(e[0],e[1],e[2])}),e,t,r)},get:function(e,t,r){return a.extensionOrDefault("get",(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Reflect.get(e[0],e[1],e[2])}),e,t,r)},has:function(e,t){return a.extensionOrDefault("has",(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Reflect.get(e[0],e[1])}),e,t)},set:function(e,t,r,n){return a.extensionOrDefault("set",(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Reflect.set(e[0],e[1],e[2],e[3])}),e,t,r,n)}})}})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(39),o=r(2),i=r(62),a=r(63);function s(e){return function(t){return function(r){return function(s){return a.pipe(Object.assign({},{batch:s.batch||null,batchDependency:null,cachingOptions:null,clientFactory:t,cloneParentCacheOptions:null,cloneParentWasCaching:!1,hasResult:!1,isBatched:o.objectDefinedNotNull(s.batch),method:r,options:null,parentUrl:"",parser:new n.ODataParser,pipes:e.slice(0),query:new Map,requestId:o.getGUID(),url:"",useCaching:/^get$/i.test(s.method)&&s.useCaching},i.cloneQueryableData(s)))}}}}t.pipelineBinder=s,t.defaultPipelineBinder=s(a.getDefaultPipeline())},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2);t.body=function(e,t){return Object.assign({body:n.jsS(e)},t)},t.headers=function(e,t){return Object.assign({headers:e},t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(65);n.__exportStar(r(158),t),n.__exportStar(r(159),t)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),o=function(){function e(){this.convertToResponse=function(e){var t=new Headers;if(void 0!==e.headers)for(var r in e.headers)e.headers[r]&&t.append(r,e.headers[r]);var n=204===e.statusCode?null:e.body;return new Response(n,{headers:t,status:e.statusCode,statusText:e.statusText})}}return e.prototype.fetch=function(e,t){var r=this;if(void 0===SP||void 0===SP.RequestExecutor)throw Error("SP.RequestExecutor is undefined. Load the SP.RequestExecutor.js library (/_layouts/15/SP.RequestExecutor.js) before loading the PnP JS Core library.");var o,i,a=e.substring(0,e.indexOf("/_api")),s=new SP.RequestExecutor(a),u={};if(t.headers&&t.headers instanceof Headers)for(i=(o=t.headers.entries()).next();!i.done;)u[i.value[0]]=i.value[1],i=o.next();else u=t.headers;return new Promise((function(o,i){var a={error:function(e){i(r.convertToResponse(e))},headers:u,method:t.method,success:function(e){o(r.convertToResponse(e))},url:e};a=t.body?n.assign(a,{body:t.body}):n.assign(a,{binaryStringRequestBody:!0}),s.executeAsync(a)}))},e}();t.SPRequestExecutorClient=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(65),o=r(66),i=r(31),a=r(30),s=r(2),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.crossDomainSite=function(e,t){return this._cdImpl(a.Site,e,t,"site")},t.prototype.crossDomainWeb=function(e,t){return this._cdImpl(i.Web,e,t,"web")},t.prototype._cdImpl=function(e,t,r,n){if(!s.isUrlAbsolute(t))throw Error("The addInWebUrl parameter must be an absolute url.");if(!s.isUrlAbsolute(r))throw Error("The hostWebUrl parameter must be an absolute url.");var o=e(s.combine(t,"_api/SP.AppContextSite(@target)"),n);return o.query.set("@target","'"+encodeURIComponent(r)+"'"),o.configure(this._options)},t}(o.SPRest);t.SPRestAddIn=u,t.sp=new u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.None=0]="None",e[e.User=1]="User",e[e.DistributionList=2]="DistributionList",e[e.SecurityGroup=4]="SecurityGroup",e[e.SharePointGroup=8]="SharePointGroup",e[e.All=15]="All"}(t.PrincipalType||(t.PrincipalType={})),function(e){e[e.None=0]="None",e[e.UserInfoList=1]="UserInfoList",e[e.Windows=2]="Windows",e[e.MembershipProvider=4]="MembershipProvider",e[e.RoleProvider=8]="RoleProvider",e[e.All=15]="All"}(t.PrincipalSource||(t.PrincipalSource={})),function(e){e[e.Invalid=-1]="Invalid",e[e.DefaultView=0]="DefaultView",e[e.NormalView=1]="NormalView",e[e.DialogView=2]="DialogView",e[e.View=3]="View",e[e.DisplayForm=4]="DisplayForm",e[e.DisplayFormDialog=5]="DisplayFormDialog",e[e.EditForm=6]="EditForm",e[e.EditFormDialog=7]="EditFormDialog",e[e.NewForm=8]="NewForm",e[e.NewFormDialog=9]="NewFormDialog",e[e.SolutionForm=10]="SolutionForm",e[e.PAGE_MAXITEMS=11]="PAGE_MAXITEMS"}(t.PageType||(t.PageType={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=/["*:<>?/\\|\x00-\x1f\x7f-\x9f]/g,o=/["#%*:<>?/\\|\x00-\x1f\x7f-\x9f]/g;t.containsInvalidFileFolderChars=function(e,t){return void 0===t&&(t=!1),t?o.test(e):n.test(e)},t.stripInvalidFileFolderChars=function(e,t,r){return void 0===t&&(t=""),void 0===r&&(r=!1),r?e.replace(o,t):e.replace(n,t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2);t.setup=function(e){n.RuntimeConfig.assign(e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(19);t.graph=o.graph,t.GraphRest=o.GraphRest;var i=r(69);t.GraphBatch=i.GraphBatch;var a=r(9);t.GraphQueryable=a.GraphQueryable,t.GraphQueryableCollection=a.GraphQueryableCollection,t.GraphQueryableInstance=a.GraphQueryableInstance,t.GraphQueryableSearchableCollection=a.GraphQueryableSearchableCollection,n.__exportStar(r(42),t),n.__exportStar(r(68),t)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(1).__exportStar(r(165),t)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(2),i=r(166),a=function(e){function t(t,r,n){var o=e.call(this,null)||this;return o.clientId=t,o.tenant=r,o.redirectUri=n,o._displayCallback=null,o._loginPromise=null,o}return n.__extends(t,e),t.fromSPFxContext=function(e){return new o.SPFxAdalClient(e)},t.prototype.fetch=function(t,r){return n.__awaiter(this,void 0,void 0,(function(){var i;return n.__generator(this,(function(n){switch(n.label){case 0:if(!o.isUrlAbsolute(t))throw Error("You must supply absolute urls to AdalClient.fetch.");return[4,this.getToken(o.getADALResource(t))];case 1:return i=n.sent(),this.token=i,[2,e.prototype.fetch.call(this,t,r)]}}))}))},t.prototype.getToken=function(e){return n.__awaiter(this,void 0,void 0,(function(){var r;return n.__generator(this,(function(n){switch(n.label){case 0:return[4,this.ensureAuthContext()];case 1:return n.sent(),[4,this.login()];case 2:return n.sent(),r=null,t._authContext.acquireToken(e,(function(e,t){if(e)throw Error(e);r=t})),[2,r]}}))}))},t.prototype.ensureAuthContext=function(){var e=this;return new Promise((function(r){null===t._authContext&&(t._authContext=i.inject({clientId:e.clientId,displayCall:function(t){e._displayCallback&&e._displayCallback(t)},navigateToLoginRequestUrl:!1,redirectUri:e.redirectUri,tenant:e.tenant})),r()}))},t.prototype.login=function(){var e=this;return this._loginPromise?this._loginPromise:(this._loginPromise=new Promise((function(r,n){if(t._authContext.getCachedUser())return r();e._displayCallback=function(o){var i=window.open(o,"login","width=483, height=600");if(!i)return n(Error("Could not open pop-up window for auth. Likely pop-ups are blocked by the browser."));i&&i.focus&&i.focus();var a=window.setInterval((function(){i&&!i.closed&&void 0!==i.closed||window.clearInterval(a);try{-1!==i.document.URL.indexOf(e.redirectUri)&&(window.clearInterval(a),t._authContext.handleWindowCallback(i.location.hash),i.close(),r())}catch(e){n(e)}}),30)},e.ensureAuthContext().then((function(r){t._authContext._loginInProgress=!1,t._authContext.login(),e._displayCallback=null}))})),this._loginPromise)},t._authContext=null,t}(o.BearerTokenFetchClient);t.AdalClient=a},function(e,t,r){
/*! adal-angular v1.0.17 2018-02-27 */
var n=function(){"use strict";return n=function(e){if(this.REQUEST_TYPE={LOGIN:"LOGIN",RENEW_TOKEN:"RENEW_TOKEN",UNKNOWN:"UNKNOWN"},this.RESPONSE_TYPE={ID_TOKEN_TOKEN:"id_token token",TOKEN:"token"},this.CONSTANTS={ACCESS_TOKEN:"access_token",EXPIRES_IN:"expires_in",ID_TOKEN:"id_token",ERROR_DESCRIPTION:"error_description",SESSION_STATE:"session_state",ERROR:"error",STORAGE:{TOKEN_KEYS:"adal.token.keys",ACCESS_TOKEN_KEY:"adal.access.token.key",EXPIRATION_KEY:"adal.expiration.key",STATE_LOGIN:"adal.state.login",STATE_RENEW:"adal.state.renew",NONCE_IDTOKEN:"adal.nonce.idtoken",SESSION_STATE:"adal.session.state",USERNAME:"adal.username",IDTOKEN:"adal.idtoken",ERROR:"adal.error",ERROR_DESCRIPTION:"adal.error.description",LOGIN_REQUEST:"adal.login.request",LOGIN_ERROR:"adal.login.error",RENEW_STATUS:"adal.token.renew.status",ANGULAR_LOGIN_REQUEST:"adal.angular.login.request"},RESOURCE_DELIMETER:"|",CACHE_DELIMETER:"||",LOADFRAME_TIMEOUT:6e3,TOKEN_RENEW_STATUS_CANCELED:"Canceled",TOKEN_RENEW_STATUS_COMPLETED:"Completed",TOKEN_RENEW_STATUS_IN_PROGRESS:"In Progress",LOGGING_LEVEL:{ERROR:0,WARN:1,INFO:2,VERBOSE:3},LEVEL_STRING_MAP:{0:"ERROR:",1:"WARNING:",2:"INFO:",3:"VERBOSE:"},POPUP_WIDTH:483,POPUP_HEIGHT:600},n.prototype._singletonInstance)return n.prototype._singletonInstance;if(n.prototype._singletonInstance=this,this.instance="https://login.microsoftonline.com/",this.config={},this.callback=null,this.popUp=!1,this.isAngular=!1,this._user=null,this._activeRenewals={},this._loginInProgress=!1,this._acquireTokenInProgress=!1,this._renewStates=[],this._callBackMappedToRenewStates={},this._callBacksMappedToRenewStates={},this._openedWindows=[],this._requestType=this.REQUEST_TYPE.LOGIN,window._adalInstance=this,e.displayCall&&"function"!=typeof e.displayCall)throw new Error("displayCall is not a function");if(!e.clientId)throw new Error("clientId is required");this.config=this._cloneConfig(e),void 0===this.config.navigateToLoginRequestUrl&&(this.config.navigateToLoginRequestUrl=!0),this.config.popUp&&(this.popUp=!0),this.config.callback&&"function"==typeof this.config.callback&&(this.callback=this.config.callback),this.config.instance&&(this.instance=this.config.instance),this.config.loginResource||(this.config.loginResource=this.config.clientId),this.config.redirectUri||(this.config.redirectUri=window.location.href.split("?")[0].split("#")[0]),this.config.postLogoutRedirectUri||(this.config.postLogoutRedirectUri=window.location.href.split("?")[0].split("#")[0]),this.config.anonymousEndpoints||(this.config.anonymousEndpoints=[]),this.config.isAngular&&(this.isAngular=this.config.isAngular),this.config.loadFrameTimeout&&(this.CONSTANTS.LOADFRAME_TIMEOUT=this.config.loadFrameTimeout)},"undefined"!=typeof window&&(window.Logging={piiLoggingEnabled:!1,level:0,log:function(e){}}),n.prototype.login=function(){if(this._loginInProgress)this.info("Login in progress");else{this._loginInProgress=!0;var e=this._guid();this.config.state=e,this._idTokenNonce=this._guid();var t=this._getItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST);t&&""!==t?this._saveItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST,""):t=window.location.href,this.verbose("Expected state: "+e+" startPage:"+t),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,t),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,e,!0),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"");var r=this._getNavigateUrl("id_token",null)+"&nonce="+encodeURIComponent(this._idTokenNonce);this.config.displayCall?this.config.displayCall(r):this.popUp?(this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,""),this._renewStates.push(e),this.registerCallback(e,this.config.clientId,this.callback),this._loginPopup(r)):this.promptUser(r)}},n.prototype._openPopup=function(e,t,r,n){try{var o=window.screenLeft?window.screenLeft:window.screenX,i=window.screenTop?window.screenTop:window.screenY,a=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,s=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,u=a/2-r/2+o,c=s/2-n/2+i,l=window.open(e,t,"width="+r+", height="+n+", top="+c+", left="+u);return l.focus&&l.focus(),l}catch(e){return this.warn("Error opening popup, "+e.message),this._loginInProgress=!1,this._acquireTokenInProgress=!1,null}},n.prototype._handlePopupError=function(e,t,r,n,o){this.warn(n),this._saveItem(this.CONSTANTS.STORAGE.ERROR,r),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,n),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,o),t&&this._activeRenewals[t]&&(this._activeRenewals[t]=null),this._loginInProgress=!1,this._acquireTokenInProgress=!1,e&&e(n,null,r)},n.prototype._loginPopup=function(e,t,r){var n=this._openPopup(e,"login",this.CONSTANTS.POPUP_WIDTH,this.CONSTANTS.POPUP_HEIGHT),o=r||this.callback;if(null!=n){if(this._openedWindows.push(n),-1!=this.config.redirectUri.indexOf("#"))var i=this.config.redirectUri.split("#")[0];else i=this.config.redirectUri;var a=this,s=window.setInterval((function(){if(!n||n.closed||void 0===n.closed){var e="Popup Window closed",r="Popup Window closed by UI action/ Popup Window handle destroyed due to cross zone navigation in IE/Edge";return a.isAngular&&a._broadcast("adal:popUpClosed",r+a.CONSTANTS.RESOURCE_DELIMETER+e),a._handlePopupError(o,t,e,r,r),void window.clearInterval(s)}try{var u=n.location;if(-1!=encodeURI(u.href).indexOf(encodeURI(i)))return a.isAngular?a._broadcast("adal:popUpHashChanged",u.hash):a.handleWindowCallback(u.hash),window.clearInterval(s),a._loginInProgress=!1,a._acquireTokenInProgress=!1,a.info("Closing popup window"),a._openedWindows=[],void n.close()}catch(e){}}),1)}else{var u="Popup Window is null. This can happen if you are using IE";this._handlePopupError(o,t,"Error opening popup",u,u)}},n.prototype._broadcast=function(e,t){!function(){function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var r=document.createEvent("CustomEvent");return r.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),r}if("function"==typeof window.CustomEvent)return!1;e.prototype=window.Event.prototype,window.CustomEvent=e}();var r=new CustomEvent(e,{detail:t});window.dispatchEvent(r)},n.prototype.loginInProgress=function(){return this._loginInProgress},n.prototype._hasResource=function(e){var t=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS);return t&&!this._isEmpty(t)&&t.indexOf(e+this.CONSTANTS.RESOURCE_DELIMETER)>-1},n.prototype.getCachedToken=function(e){if(!this._hasResource(e))return null;var t=this._getItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e),r=this._getItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e),n=this.config.expireOffsetSeconds||300;return r&&r>this._now()+n?t:(this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e,""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e,0),null)},n.prototype.getCachedUser=function(){if(this._user)return this._user;var e=this._getItem(this.CONSTANTS.STORAGE.IDTOKEN);return this._user=this._createUser(e),this._user},n.prototype.registerCallback=function(e,t,r){this._activeRenewals[t]=e,this._callBacksMappedToRenewStates[e]||(this._callBacksMappedToRenewStates[e]=[]);var n=this;this._callBacksMappedToRenewStates[e].push(r),this._callBackMappedToRenewStates[e]||(this._callBackMappedToRenewStates[e]=function(r,o,i,a){n._activeRenewals[t]=null;for(var s=0;s<n._callBacksMappedToRenewStates[e].length;++s)try{n._callBacksMappedToRenewStates[e][s](r,o,i,a)}catch(i){n.warn(i)}n._callBacksMappedToRenewStates[e]=null,n._callBackMappedToRenewStates[e]=null})},n.prototype._renewToken=function(e,t,r){this.info("renewToken is called for resource:"+e);var n=this._addAdalFrame("adalRenewFrame"+e),o=this._guid()+"|"+e;this.config.state=o,this._renewStates.push(o),this.verbose("Renew token Expected state: "+o),r=r||"token";var i=this._urlRemoveQueryStringParameter(this._getNavigateUrl(r,e),"prompt");r===this.RESPONSE_TYPE.ID_TOKEN_TOKEN&&(this._idTokenNonce=this._guid(),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),i+="&nonce="+encodeURIComponent(this._idTokenNonce)),i+="&prompt=none",i=this._addHintParameters(i),this.registerCallback(o,e,t),this.verbosePii("Navigate to:"+i),n.src="about:blank",this._loadFrameTimeout(i,"adalRenewFrame"+e,e)},n.prototype._renewIdToken=function(e,t){this.info("renewIdToken is called");var r=this._addAdalFrame("adalIdTokenFrame"),n=this._guid()+"|"+this.config.clientId;this._idTokenNonce=this._guid(),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),this.config.state=n,this._renewStates.push(n),this.verbose("Renew Idtoken Expected state: "+n);var o=null==t?null:this.config.clientId,i=(t=t||"id_token",this._urlRemoveQueryStringParameter(this._getNavigateUrl(t,o),"prompt"));i+="&prompt=none",i=this._addHintParameters(i),i+="&nonce="+encodeURIComponent(this._idTokenNonce),this.registerCallback(n,this.config.clientId,e),this.verbosePii("Navigate to:"+i),r.src="about:blank",this._loadFrameTimeout(i,"adalIdTokenFrame",this.config.clientId)},n.prototype._urlContainsQueryStringParameter=function(e,t){return new RegExp("[\\?&]"+e+"=").test(t)},n.prototype._urlRemoveQueryStringParameter=function(e,t){var r=new RegExp("(\\&"+t+"=)[^&]+");return e=e.replace(r,""),r=new RegExp("("+t+"=)[^&]+&"),e=e.replace(r,""),r=new RegExp("("+t+"=)[^&]+"),e.replace(r,"")},n.prototype._loadFrameTimeout=function(e,t,r){this.verbose("Set loading state to pending for: "+r),this._saveItem(this.CONSTANTS.STORAGE.RENEW_STATUS+r,this.CONSTANTS.TOKEN_RENEW_STATUS_IN_PROGRESS),this._loadFrame(e,t);var n=this;setTimeout((function(){if(n._getItem(n.CONSTANTS.STORAGE.RENEW_STATUS+r)===n.CONSTANTS.TOKEN_RENEW_STATUS_IN_PROGRESS){n.verbose("Loading frame has timed out after: "+n.CONSTANTS.LOADFRAME_TIMEOUT/1e3+" seconds for resource "+r);var e=n._activeRenewals[r];e&&n._callBackMappedToRenewStates[e]&&n._callBackMappedToRenewStates[e]("Token renewal operation failed due to timeout",null,"Token Renewal Failed"),n._saveItem(n.CONSTANTS.STORAGE.RENEW_STATUS+r,n.CONSTANTS.TOKEN_RENEW_STATUS_CANCELED)}}),n.CONSTANTS.LOADFRAME_TIMEOUT)},n.prototype._loadFrame=function(e,t){var r=this;r.info("LoadFrame: "+t);var n=t;setTimeout((function(){var t=r._addAdalFrame(n);""!==t.src&&"about:blank"!==t.src||(t.src=e,r._loadFrame(e,n))}),500)},n.prototype.acquireToken=function(e,t){if(this._isEmpty(e))return this.warn("resource is required"),void t("resource is required",null,"resource is required");var r=this.getCachedToken(e);return r?(this.info("Token is already in cache for resource:"+e),void t(null,r,null)):this._user||this.config.extraQueryParameter&&-1!==this.config.extraQueryParameter.indexOf("login_hint")?void(this._activeRenewals[e]?this.registerCallback(this._activeRenewals[e],e,t):(this._requestType=this.REQUEST_TYPE.RENEW_TOKEN,e===this.config.clientId?this._user?(this.verbose("renewing idtoken"),this._renewIdToken(t)):(this.verbose("renewing idtoken and access_token"),this._renewIdToken(t,this.RESPONSE_TYPE.ID_TOKEN_TOKEN)):this._user?(this.verbose("renewing access_token"),this._renewToken(e,t)):(this.verbose("renewing idtoken and access_token"),this._renewToken(e,t,this.RESPONSE_TYPE.ID_TOKEN_TOKEN)))):(this.warn("User login is required"),void t("User login is required",null,"login required"))},n.prototype.acquireTokenPopup=function(e,t,r,n){if(this._isEmpty(e))return this.warn("resource is required"),void n("resource is required",null,"resource is required");if(!this._user)return this.warn("User login is required"),void n("User login is required",null,"login required");if(this._acquireTokenInProgress)return this.warn("Acquire token interactive is already in progress"),void n("Acquire token interactive is already in progress",null,"Acquire token interactive is already in progress");var o=this._guid()+"|"+e;this.config.state=o,this._renewStates.push(o),this._requestType=this.REQUEST_TYPE.RENEW_TOKEN,this.verbose("Renew token Expected state: "+o);var i=this._urlRemoveQueryStringParameter(this._getNavigateUrl("token",e),"prompt");if(i+="&prompt=select_account",t&&(i+=t),r&&-1===i.indexOf("&claims"))i+="&claims="+encodeURIComponent(r);else if(r&&-1!==i.indexOf("&claims"))throw new Error("Claims cannot be passed as an extraQueryParameter");i=this._addHintParameters(i),this._acquireTokenInProgress=!0,this.info("acquireToken interactive is called for the resource "+e),this.registerCallback(o,e,n),this._loginPopup(i,e,n)},n.prototype.acquireTokenRedirect=function(e,t,r){if(this._isEmpty(e))return this.warn("resource is required"),void n("resource is required",null,"resource is required");var n=this.callback;if(!this._user)return this.warn("User login is required"),void n("User login is required",null,"login required");if(this._acquireTokenInProgress)return this.warn("Acquire token interactive is already in progress"),void n("Acquire token interactive is already in progress",null,"Acquire token interactive is already in progress");var o=this._guid()+"|"+e;this.config.state=o,this.verbose("Renew token Expected state: "+o);var i=this._urlRemoveQueryStringParameter(this._getNavigateUrl("token",e),"prompt");if(i+="&prompt=select_account",t&&(i+=t),r&&-1===i.indexOf("&claims"))i+="&claims="+encodeURIComponent(r);else if(r&&-1!==i.indexOf("&claims"))throw new Error("Claims cannot be passed as an extraQueryParameter");i=this._addHintParameters(i),this._acquireTokenInProgress=!0,this.info("acquireToken interactive is called for the resource "+e),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,window.location.href),this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,o,!0),this.promptUser(i)},n.prototype.promptUser=function(e){e?(this.infoPii("Navigate to:"+e),window.location.replace(e)):this.info("Navigate url is empty")},n.prototype.clearCache=function(){this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,""),this._saveItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST,""),this._saveItem(this.CONSTANTS.STORAGE.SESSION_STATE,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,""),this._renewStates=[],this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,""),this._saveItem(this.CONSTANTS.STORAGE.IDTOKEN,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,""),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,"");var e=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS);if(!this._isEmpty(e)){e=e.split(this.CONSTANTS.RESOURCE_DELIMETER);for(var t=0;t<e.length&&""!==e[t];t++)this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e[t],""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e[t],0)}this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,"")},n.prototype.clearCacheForResource=function(e){this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,""),this._hasResource(e)&&(this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e,""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e,0))},n.prototype.logOut=function(){var e;if(this.clearCache(),this._user=null,this.config.logOutUri)e=this.config.logOutUri;else{var t="common",r="";this.config.tenant&&(t=this.config.tenant),this.config.postLogoutRedirectUri&&(r="post_logout_redirect_uri="+encodeURIComponent(this.config.postLogoutRedirectUri)),e=this.instance+t+"/oauth2/logout?"+r}this.infoPii("Logout navigate to: "+e),this.promptUser(e)},n.prototype._isEmpty=function(e){return void 0===e||!e||0===e.length},n.prototype.getUser=function(e){if("function"!=typeof e)throw new Error("callback is not a function");if(this._user)e(null,this._user);else{var t=this._getItem(this.CONSTANTS.STORAGE.IDTOKEN);this._isEmpty(t)?(this.warn("User information is not available"),e("User information is not available",null)):(this.info("User exists in cache: "),this._user=this._createUser(t),e(null,this._user))}},n.prototype._addHintParameters=function(e){if(this._user&&this._user.profile)if(this._user.profile.sid&&-1!==e.indexOf("&prompt=none"))this._urlContainsQueryStringParameter("sid",e)||(e+="&sid="+encodeURIComponent(this._user.profile.sid));else if(this._user.profile.upn&&(this._urlContainsQueryStringParameter("login_hint",e)||(e+="&login_hint="+encodeURIComponent(this._user.profile.upn)),!this._urlContainsQueryStringParameter("domain_hint",e)&&this._user.profile.upn.indexOf("@")>-1)){var t=this._user.profile.upn.split("@");e+="&domain_hint="+encodeURIComponent(t[t.length-1])}return e},n.prototype._createUser=function(e){var t=null,r=this._extractIdToken(e);return r&&r.hasOwnProperty("aud")&&(r.aud.toLowerCase()===this.config.clientId.toLowerCase()?(t={userName:"",profile:r},r.hasOwnProperty("upn")?t.userName=r.upn:r.hasOwnProperty("email")&&(t.userName=r.email)):this.warn("IdToken has invalid aud field")),t},n.prototype._getHash=function(e){return e.indexOf("#/")>-1?e=e.substring(e.indexOf("#/")+2):e.indexOf("#")>-1&&(e=e.substring(1)),e},n.prototype.isCallback=function(e){e=this._getHash(e);var t=this._deserialize(e);return t.hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION)||t.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)||t.hasOwnProperty(this.CONSTANTS.ID_TOKEN)},n.prototype.getLoginError=function(){return this._getItem(this.CONSTANTS.STORAGE.LOGIN_ERROR)},n.prototype.getRequestInfo=function(e){e=this._getHash(e);var t=this._deserialize(e),r={valid:!1,parameters:{},stateMatch:!1,stateResponse:"",requestType:this.REQUEST_TYPE.UNKNOWN};if(t&&(r.parameters=t,t.hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION)||t.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)||t.hasOwnProperty(this.CONSTANTS.ID_TOKEN))){r.valid=!0;var n;if(!t.hasOwnProperty("state"))return this.warn("No state returned"),r;if(this.verbose("State: "+t.state),n=t.state,r.stateResponse=n,this._matchState(r))return r;if(!r.stateMatch&&window.parent){r.requestType=this._requestType;for(var o=this._renewStates,i=0;i<o.length;i++)if(o[i]===r.stateResponse){r.stateMatch=!0;break}}}return r},n.prototype._matchNonce=function(e){var t=this._getItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN);if(t){t=t.split(this.CONSTANTS.CACHE_DELIMETER);for(var r=0;r<t.length;r++)if(t[r]===e.profile.nonce)return!0}return!1},n.prototype._matchState=function(e){var t=this._getItem(this.CONSTANTS.STORAGE.STATE_LOGIN);if(t){t=t.split(this.CONSTANTS.CACHE_DELIMETER);for(var r=0;r<t.length;r++)if(t[r]===e.stateResponse)return e.requestType=this.REQUEST_TYPE.LOGIN,e.stateMatch=!0,!0}var n=this._getItem(this.CONSTANTS.STORAGE.STATE_RENEW);if(n){n=n.split(this.CONSTANTS.CACHE_DELIMETER);for(r=0;r<n.length;r++)if(n[r]===e.stateResponse)return e.requestType=this.REQUEST_TYPE.RENEW_TOKEN,e.stateMatch=!0,!0}return!1},n.prototype._getResourceFromState=function(e){if(e){var t=e.indexOf("|");if(t>-1&&t+1<e.length)return e.substring(t+1)}return""},n.prototype.saveTokenFromHash=function(e){this.info("State status:"+e.stateMatch+"; Request type:"+e.requestType),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"");var t=this._getResourceFromState(e.stateResponse);if(e.parameters.hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION))this.infoPii("Error :"+e.parameters.error+"; Error description:"+e.parameters[this.CONSTANTS.ERROR_DESCRIPTION]),this._saveItem(this.CONSTANTS.STORAGE.ERROR,e.parameters.error),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,e.parameters[this.CONSTANTS.ERROR_DESCRIPTION]),e.requestType===this.REQUEST_TYPE.LOGIN&&(this._loginInProgress=!1,this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,e.parameters.error_description));else if(e.stateMatch){var r;this.info("State is right"),e.parameters.hasOwnProperty(this.CONSTANTS.SESSION_STATE)&&this._saveItem(this.CONSTANTS.STORAGE.SESSION_STATE,e.parameters[this.CONSTANTS.SESSION_STATE]),e.parameters.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)&&(this.info("Fragment has access token"),this._hasResource(t)||(r=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS)||"",this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,r+t+this.CONSTANTS.RESOURCE_DELIMETER)),this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+t,e.parameters[this.CONSTANTS.ACCESS_TOKEN]),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+t,this._expiresIn(e.parameters[this.CONSTANTS.EXPIRES_IN]))),e.parameters.hasOwnProperty(this.CONSTANTS.ID_TOKEN)&&(this.info("Fragment has id token"),this._loginInProgress=!1,this._user=this._createUser(e.parameters[this.CONSTANTS.ID_TOKEN]),this._user&&this._user.profile?this._matchNonce(this._user)?(this._saveItem(this.CONSTANTS.STORAGE.IDTOKEN,e.parameters[this.CONSTANTS.ID_TOKEN]),t=this.config.loginResource?this.config.loginResource:this.config.clientId,this._hasResource(t)||(r=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS)||"",this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,r+t+this.CONSTANTS.RESOURCE_DELIMETER)),this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+t,e.parameters[this.CONSTANTS.ID_TOKEN]),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+t,this._user.profile.exp)):(this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,"Nonce received: "+this._user.profile.nonce+" is not same as requested: "+this._getItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN)),this._user=null):(e.parameters.error="invalid id_token",e.parameters.error_description="Invalid id_token. id_token: "+e.parameters[this.CONSTANTS.ID_TOKEN],this._saveItem(this.CONSTANTS.STORAGE.ERROR,"invalid id_token"),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"Invalid id_token. id_token: "+e.parameters[this.CONSTANTS.ID_TOKEN])))}else e.parameters.error="Invalid_state",e.parameters.error_description="Invalid_state. state: "+e.stateResponse,this._saveItem(this.CONSTANTS.STORAGE.ERROR,"Invalid_state"),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"Invalid_state. state: "+e.stateResponse);this._saveItem(this.CONSTANTS.STORAGE.RENEW_STATUS+t,this.CONSTANTS.TOKEN_RENEW_STATUS_COMPLETED)},n.prototype.getResourceForEndpoint=function(e){if(this.config&&this.config.anonymousEndpoints)for(var t=0;t<this.config.anonymousEndpoints.length;t++)if(e.indexOf(this.config.anonymousEndpoints[t])>-1)return null;if(this.config&&this.config.endpoints)for(var r in this.config.endpoints)if(e.indexOf(r)>-1)return this.config.endpoints[r];return e.indexOf("http://")>-1||e.indexOf("https://")>-1?this._getHostFromUri(e)===this._getHostFromUri(this.config.redirectUri)?this.config.loginResource:null:this.config.loginResource},n.prototype._getHostFromUri=function(e){var t=String(e).replace(/^(https?:)\/\//,"");return t.split("/")[0]},n.prototype.handleWindowCallback=function(e){if(null==e&&(e=window.location.hash),this.isCallback(e)){var t=null,r=!1;this._openedWindows.length>0&&this._openedWindows[this._openedWindows.length-1].opener&&this._openedWindows[this._openedWindows.length-1].opener._adalInstance?(t=this._openedWindows[this._openedWindows.length-1].opener._adalInstance,r=!0):window.parent&&window.parent._adalInstance&&(t=window.parent._adalInstance);var n,o,i=t.getRequestInfo(e),a=null;o=r||window.parent!==window?t._callBackMappedToRenewStates[i.stateResponse]:t.callback,t.info("Returned from redirect url"),t.saveTokenFromHash(i),i.requestType===this.REQUEST_TYPE.RENEW_TOKEN&&window.parent?(window.parent!==window?t.verbose("Window is in iframe, acquiring token silently"):t.verbose("acquiring token interactive in progress"),n=i.parameters[t.CONSTANTS.ACCESS_TOKEN]||i.parameters[t.CONSTANTS.ID_TOKEN],a=t.CONSTANTS.ACCESS_TOKEN):i.requestType===this.REQUEST_TYPE.LOGIN&&(n=i.parameters[t.CONSTANTS.ID_TOKEN],a=t.CONSTANTS.ID_TOKEN);var s=i.parameters[t.CONSTANTS.ERROR_DESCRIPTION],u=i.parameters[t.CONSTANTS.ERROR];try{o&&o(s,n,u,a)}catch(e){t.error("Error occurred in user defined callback function: "+e)}window.parent!==window||r||(t.config.navigateToLoginRequestUrl?window.location.href=t._getItem(t.CONSTANTS.STORAGE.LOGIN_REQUEST):window.location.hash="")}},n.prototype._getNavigateUrl=function(e,t){var r="common";this.config.tenant&&(r=this.config.tenant);var n=this.instance+r+"/oauth2/authorize"+this._serialize(e,this.config,t)+this._addLibMetadata();return this.info("Navigate url:"+n),n},n.prototype._extractIdToken=function(e){var t=this._decodeJwt(e);if(!t)return null;try{var r=t.JWSPayload,n=this._base64DecodeStringUrlSafe(r);return n?JSON.parse(n):(this.info("The returned id_token could not be base64 url safe decoded."),null)}catch(e){this.error("The returned id_token could not be decoded",e)}return null},n.prototype._base64DecodeStringUrlSafe=function(e){return e=e.replace(/-/g,"+").replace(/_/g,"/"),window.atob?decodeURIComponent(escape(window.atob(e))):decodeURIComponent(escape(this._decode(e)))},n.prototype._decode=function(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r=(e=String(e).replace(/=+$/,"")).length;if(r%4==1)throw new Error("The token to be decoded is not correctly encoded.");for(var n,o,i,a,s,u,c,l,p="",d=0;d<r;d+=4){if(n=t.indexOf(e.charAt(d)),o=t.indexOf(e.charAt(d+1)),i=t.indexOf(e.charAt(d+2)),a=t.indexOf(e.charAt(d+3)),d+2===r-1){u=(s=n<<18|o<<12|i<<6)>>16&255,c=s>>8&255,p+=String.fromCharCode(u,c);break}if(d+1===r-1){u=(s=n<<18|o<<12)>>16&255,p+=String.fromCharCode(u);break}u=(s=n<<18|o<<12|i<<6|a)>>16&255,c=s>>8&255,l=255&s,p+=String.fromCharCode(u,c,l)}return p},n.prototype._decodeJwt=function(e){if(this._isEmpty(e))return null;var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);return!t||t.length<4?(this.warn("The returned id_token is not parseable."),null):{header:t[1],JWSPayload:t[2],JWSSig:t[3]}},n.prototype._convertUrlSafeToRegularBase64EncodedString=function(e){return e.replace("-","+").replace("_","/")},n.prototype._serialize=function(e,t,r){var n=[];if(null!==t){n.push("?response_type="+e),n.push("client_id="+encodeURIComponent(t.clientId)),r&&n.push("resource="+encodeURIComponent(r)),n.push("redirect_uri="+encodeURIComponent(t.redirectUri)),n.push("state="+encodeURIComponent(t.state)),t.hasOwnProperty("slice")&&n.push("slice="+encodeURIComponent(t.slice)),t.hasOwnProperty("extraQueryParameter")&&n.push(t.extraQueryParameter);var o=t.correlationId?t.correlationId:this._guid();n.push("client-request-id="+encodeURIComponent(o))}return n.join("&")},n.prototype._deserialize=function(e){var t,r=/\+/g,n=/([^&=]+)=([^&]*)/g,o=function(e){return decodeURIComponent(e.replace(r," "))},i={};for(t=n.exec(e);t;)i[o(t[1])]=o(t[2]),t=n.exec(e);return i},n.prototype._decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},n.prototype._guid=function(){var e=window.crypto||window.msCrypto;if(e&&e.getRandomValues){var t=new Uint8Array(16);return e.getRandomValues(t),t[6]|=64,t[6]&=79,t[8]|=128,t[8]&=191,this._decimalToHex(t[0])+this._decimalToHex(t[1])+this._decimalToHex(t[2])+this._decimalToHex(t[3])+"-"+this._decimalToHex(t[4])+this._decimalToHex(t[5])+"-"+this._decimalToHex(t[6])+this._decimalToHex(t[7])+"-"+this._decimalToHex(t[8])+this._decimalToHex(t[9])+"-"+this._decimalToHex(t[10])+this._decimalToHex(t[11])+this._decimalToHex(t[12])+this._decimalToHex(t[13])+this._decimalToHex(t[14])+this._decimalToHex(t[15])}for(var r="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",n="0123456789abcdef",o=0,i="",a=0;a<36;a++)"-"!==r[a]&&"4"!==r[a]&&(o=16*Math.random()|0),"x"===r[a]?i+=n[o]:"y"===r[a]?(o&=3,i+=n[o|=8]):i+=r[a];return i},n.prototype._expiresIn=function(e){return e||(e=3599),this._now()+parseInt(e,10)},n.prototype._now=function(){return Math.round((new Date).getTime()/1e3)},n.prototype._addAdalFrame=function(e){if(void 0!==e){this.info("Add adal frame to document:"+e);var t=document.getElementById(e);if(!t){if(document.createElement&&document.documentElement&&(window.opera||-1===window.navigator.userAgent.indexOf("MSIE 5.0"))){var r=document.createElement("iframe");r.setAttribute("id",e),r.setAttribute("aria-hidden","true"),r.style.visibility="hidden",r.style.position="absolute",r.style.width=r.style.height=r.borderWidth="0px",t=document.getElementsByTagName("body")[0].appendChild(r)}else document.body&&document.body.insertAdjacentHTML&&document.body.insertAdjacentHTML("beforeEnd",'<iframe name="'+e+'" id="'+e+'" style="display:none"></iframe>');window.frames&&window.frames[e]&&(t=window.frames[e])}return t}},n.prototype._saveItem=function(e,t,r){if(this.config&&this.config.cacheLocation&&"localStorage"===this.config.cacheLocation){if(!this._supportsLocalStorage())return this.info("Local storage is not supported"),!1;if(r){var n=this._getItem(e)||"";localStorage.setItem(e,n+t+this.CONSTANTS.CACHE_DELIMETER)}else localStorage.setItem(e,t);return!0}return this._supportsSessionStorage()?(sessionStorage.setItem(e,t),!0):(this.info("Session storage is not supported"),!1)},n.prototype._getItem=function(e){return this.config&&this.config.cacheLocation&&"localStorage"===this.config.cacheLocation?this._supportsLocalStorage()?localStorage.getItem(e):(this.info("Local storage is not supported"),null):this._supportsSessionStorage()?sessionStorage.getItem(e):(this.info("Session storage is not supported"),null)},n.prototype._supportsLocalStorage=function(){try{return!!window.localStorage&&(window.localStorage.setItem("storageTest","A"),"A"==window.localStorage.getItem("storageTest")&&(window.localStorage.removeItem("storageTest"),!window.localStorage.getItem("storageTest")))}catch(e){return!1}},n.prototype._supportsSessionStorage=function(){try{return!!window.sessionStorage&&(window.sessionStorage.setItem("storageTest","A"),"A"==window.sessionStorage.getItem("storageTest")&&(window.sessionStorage.removeItem("storageTest"),!window.sessionStorage.getItem("storageTest")))}catch(e){return!1}},n.prototype._cloneConfig=function(e){if(null===e||"object"!=typeof e)return e;var t={};for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);return t},n.prototype._addLibMetadata=function(){return"&x-client-SKU=Js&x-client-Ver="+this._libVersion()},n.prototype.log=function(e,t,r,n){if(e<=Logging.level){if(!Logging.piiLoggingEnabled&&n)return;var o=(new Date).toUTCString(),i="";i=this.config.correlationId?o+":"+this.config.correlationId+"-"+this._libVersion()+"-"+this.CONSTANTS.LEVEL_STRING_MAP[e]+" "+t:o+":"+this._libVersion()+"-"+this.CONSTANTS.LEVEL_STRING_MAP[e]+" "+t,r&&(i+="\nstack:\n"+r.stack),Logging.log(i)}},n.prototype.error=function(e,t){this.log(this.CONSTANTS.LOGGING_LEVEL.ERROR,e,t)},n.prototype.warn=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.WARN,e,null)},n.prototype.info=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.INFO,e,null)},n.prototype.verbose=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.VERBOSE,e,null)},n.prototype.errorPii=function(e,t){this.log(this.CONSTANTS.LOGGING_LEVEL.ERROR,e,t,!0)},n.prototype.warnPii=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.WARN,e,null,!0)},n.prototype.infoPii=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.INFO,e,null,!0)},n.prototype.verbosePii=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.VERBOSE,e,null,!0)},n.prototype._libVersion=function(){return"1.0.17"},e.exports&&(e.exports=n,e.exports.inject=function(e){return new n(e)}),n}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(7),o=r(72);n._Web.prototype.getAppCatalog=function(e){return o.AppCatalog(e||this)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(16),i=r(74);n.addProp(o._Item,"attachmentFiles",i.Attachments)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(7),o=r(76),i=r(3);n._Web.prototype.getClientsideWebParts=function(){return this.clone(i.SharePointQueryableCollection,"GetClientSideWebParts")()},n._Web.prototype.addClientsidePage=function(e,t,r){return void 0===t&&(t=e.replace(/\.[^/.]+$/,"")),o.CreateClientsidePage(this,e,t,r)},n._Web.prototype.loadClientsidePage=function(e){return o.ClientsidePageFromFile(this.getFileByServerRelativePath(e))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2);t.getNextOrder=function(e){return e.length<1?1:Math.max.apply(null,e.map((function(e){return e.order})))+1},t.reindex=function e(t){for(var r=0;r<t.length;r++)t[r].order=r+1,n.hOP(t[r],"columns")?e(t[r].columns):n.hOP(t[r],"controls")&&e(t[r].controls)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(7),i=r(33);n.addProp(o._Web,"contentTypes",i.ContentTypes)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(16),i=r(33);n.addProp(o._Item,"contentType",i.ContentType,"ContentType")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(13),i=r(33);n.addProp(o._List,"contentTypes",i.ContentTypes)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(23),i=r(44);n.addProp(o._Site,"features",i.Features)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(7),i=r(44);n.addProp(o._Web,"features",i.Features)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(13),i=r(45);n.addProp(o._List,"fields",i.Fields)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(24),i=r(20);n.addProp(o._Folder,"files",i.Files)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(16),i=r(20);n.addProp(o._Item,"file",i.File,"file")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(16),i=r(24);n.addProp(o._Item,"folder",i.Folder,"folder")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(7),i=r(24),a=r(17);n.addProp(o._Web,"folders",i.Folders),n.addProp(o._Web,"rootFolder",i.Folder,"rootFolder"),o._Web.prototype.getFolderByServerRelativeUrl=function(e){return i.Folder(this,"getFolderByServerRelativeUrl('"+a.escapeQueryStrValue(e)+"')")},o._Web.prototype.getFolderByServerRelativePath=function(e){return i.Folder(this,"getFolderByServerRelativePath(decodedUrl='"+a.escapeQueryStrValue(e)+"')")}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(13),i=r(89);n.addProp(o._List,"forms",i.Forms,"forms")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(23),i=r(4);o._Site.prototype.joinHubSite=function(e){return n.__awaiter(this,void 0,void 0,(function(){return n.__generator(this,(function(t){switch(t.label){case 0:return[4,i.spPost(this.clone(o.Site,"joinHubSite('"+e+"')"))];case 1:return t.sent(),[2]}}))}))},o._Site.prototype.registerHubSite=function(){return n.__awaiter(this,void 0,void 0,(function(){return n.__generator(this,(function(e){switch(e.label){case 0:return[4,i.spPost(this.clone(o.Site,"registerHubSite"))];case 1:return e.sent(),[2]}}))}))},o._Site.prototype.unRegisterHubSite=function(){return n.__awaiter(this,void 0,void 0,(function(){return n.__generator(this,(function(e){switch(e.label){case 0:return[4,i.spPost(this.clone(o.Site,"unRegisterHubSite"))];case 1:return e.sent(),[2]}}))}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(7),i=r(4);o._Web.prototype.hubSiteData=function(e){return void 0===e&&(e=!1),n.__awaiter(this,void 0,void 0,(function(){var t;return n.__generator(this,(function(r){switch(r.label){case 0:return[4,this.clone(o.Web,"hubSiteData("+e+")")()];case 1:return"string"==typeof(t=r.sent())?[2,JSON.parse(t)]:[2,t]}}))}))},o._Web.prototype.syncHubSiteTheme=function(){return i.spPost(this.clone(o.Web,"syncHubSiteTheme"))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(7),i=r(46);n.addProp(o._Web,"navigation",i.Navigation)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(7),i=r(97);n.addProp(o._Web,"regionalSettings",i.RegionalSettings)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(3),i=r(12),a=r(6),s=r(4),u=r(0),c=r(5),l=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(r,e),r.prototype.getRelatedItems=function(e,r){var n=this.clone(t.RelatedItemManager,null);return n.concat(".GetRelatedItems"),s.spPost(n,u.body({SourceItemID:r,SourceListName:e}))},r.prototype.getPageOneRelatedItems=function(e,r){var n=this.clone(t.RelatedItemManager,null);return n.concat(".GetPageOneRelatedItems"),s.spPost(n,u.body({SourceItemID:r,SourceListName:e}))},r.prototype.addSingleLink=function(e,r,n,o,i,a,c){void 0===c&&(c=!1);var l=this.clone(t.RelatedItemManager,null);return l.concat(".AddSingleLink"),s.spPost(l,u.body({SourceItemID:r,SourceListName:e,SourceWebUrl:n,TargetItemID:i,TargetListName:o,TargetWebUrl:a,TryAddReverseLink:c}))},r.prototype.addSingleLinkToUrl=function(e,r,n,o){void 0===o&&(o=!1);var i=this.clone(t.RelatedItemManager,null);return i.concat(".AddSingleLinkToUrl"),s.spPost(i,u.body({SourceItemID:r,SourceListName:e,TargetItemUrl:n,TryAddReverseLink:o}))},r.prototype.addSingleLinkFromUrl=function(e,r,n,o){void 0===o&&(o=!1);var i=this.clone(t.RelatedItemManager,null);return i.concat(".AddSingleLinkFromUrl"),s.spPost(i,u.body({SourceItemUrl:e,TargetItemID:n,TargetListName:r,TryAddReverseLink:o}))},r.prototype.deleteSingleLink=function(e,r,n,o,i,a,c){void 0===c&&(c=!1);var l=this.clone(t.RelatedItemManager,null);return l.concat(".DeleteSingleLink"),s.spPost(l,u.body({SourceItemID:r,SourceListName:e,SourceWebUrl:n,TargetItemID:i,TargetListName:o,TargetWebUrl:a,TryDeleteReverseLink:c}))},n.__decorate([c.tag("rim.getRelatedItems")],r.prototype,"getRelatedItems",null),n.__decorate([c.tag("rim.getPageOneRelatedItems")],r.prototype,"getPageOneRelatedItems",null),n.__decorate([c.tag("rim.addSingleLink")],r.prototype,"addSingleLink",null),n.__decorate([c.tag("rim.ToUrl")],r.prototype,"addSingleLinkToUrl",null),n.__decorate([c.tag("rim.FromUrl")],r.prototype,"addSingleLinkFromUrl",null),n.__decorate([c.tag("rim.deleteSingleLink")],r.prototype,"deleteSingleLink",null),r=n.__decorate([a.defaultPath("_api/SP.RelatedItemManager")],r)}(o._SharePointQueryable);t._RelatedItemManager=l,t.RelatedItemManager=function(e){return new l(i.extractWebUrl("string"==typeof e?e:e.toUrl()))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Ascending=0]="Ascending",e[e.Descending=1]="Descending",e[e.FQLFormula=2]="FQLFormula"}(t.SortDirection||(t.SortDirection={})),function(e){e[e.ResultContainsKeyword=0]="ResultContainsKeyword",e[e.TitleContainsKeyword=1]="TitleContainsKeyword",e[e.TitleMatchesKeyword=2]="TitleMatchesKeyword",e[e.UrlStartsWith=3]="UrlStartsWith",e[e.UrlExactlyMatches=4]="UrlExactlyMatches",e[e.ContentTypeIs=5]="ContentTypeIs",e[e.FileExtensionMatches=6]="FileExtensionMatches",e[e.ResultHasTag=7]="ResultHasTag",e[e.ManualCondition=8]="ManualCondition"}(t.ReorderingRuleMatchType||(t.ReorderingRuleMatchType={})),function(e){e[e.None=0]="None",e[e.StringType=1]="StringType",e[e.Int32Type=2]="Int32Type",e[e.BooleanType=3]="BooleanType",e[e.StringArrayType=4]="StringArrayType",e[e.UnSupportedType=5]="UnSupportedType"}(t.QueryPropertyValueType||(t.QueryPropertyValueType={}));var n=function(){function e(){}return e.Documents="e7ec8cee-ded8-43c9-beb5-436b54b31e84",e.ItemsMatchingContentType="5dc9f503-801e-4ced-8a2c-5d1237132419",e.ItemsMatchingTag="e1327b9c-2b8c-4b23-99c9-3730cb29c3f7",e.ItemsRelatedToCurrentUser="48fec42e-4a92-48ce-8363-c2703a40e67d",e.ItemsWithSameKeywordAsThisItem="5c069288-1d17-454a-8ac6-9c642a065f48",e.LocalPeopleResults="b09a7990-05ea-4af9-81ef-edfab16c4e31",e.LocalReportsAndDataResults="203fba36-2763-4060-9931-911ac8c0583b",e.LocalSharePointResults="8413cd39-2156-4e00-b54d-11efd9abdb89",e.LocalVideoResults="78b793ce-7956-4669-aa3b-451fc5defebf",e.Pages="5e34578e-4d08-4edc-8bf3-002acf3cdbcc",e.Pictures="38403c8c-3975-41a8-826e-717f2d41568a",e.Popular="97c71db1-58ce-4891-8b64-585bc2326c12",e.RecentlyChangedItems="ba63bbae-fa9c-42c0-b027-9a878f16557c",e.RecommendedItems="ec675252-14fa-4fbe-84dd-8d098ed74181",e.Wiki="9479bf85-e257-4318-b5a8-81a180f5faa1",e}();t.SearchBuiltInSourceId=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(16),i=r(25),a=r(3),s=r(49);n.addProp(o._Item,"roleAssignments",i.RoleAssignments),n.addProp(o._Item,"firstUniqueAncestorSecurableObject",a.SharePointQueryableInstance),o._Item.prototype.getUserEffectivePermissions=s.getUserEffectivePermissions,o._Item.prototype.getCurrentUserEffectivePermissions=s.getCurrentUserEffectivePermissions,o._Item.prototype.breakRoleInheritance=s.breakRoleInheritance,o._Item.prototype.resetRoleInheritance=s.resetRoleInheritance,o._Item.prototype.userHasPermissions=s.userHasPermissions,o._Item.prototype.currentUserHasPermissions=s.currentUserHasPermissions,o._Item.prototype.hasPermissions=s.hasPermissions},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(13),i=r(25),a=r(3),s=r(49);n.addProp(o._List,"roleAssignments",i.RoleAssignments),n.addProp(o._List,"firstUniqueAncestorSecurableObject",a.SharePointQueryableInstance),o._List.prototype.getUserEffectivePermissions=s.getUserEffectivePermissions,o._List.prototype.getCurrentUserEffectivePermissions=s.getCurrentUserEffectivePermissions,o._List.prototype.breakRoleInheritance=s.breakRoleInheritance,o._List.prototype.resetRoleInheritance=s.resetRoleInheritance,o._List.prototype.userHasPermissions=s.userHasPermissions,o._List.prototype.currentUserHasPermissions=s.currentUserHasPermissions,o._List.prototype.hasPermissions=s.hasPermissions},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(20),o=r(26),i=r(50);n._File.prototype.shareWith=function(e,t,r,n){return void 0===t&&(t=o.SharingRole.View),void 0===r&&(r=!1),i.shareWith(this,e,t,r,!1,n)},n._File.prototype.getShareLink=i.getShareLink,n._File.prototype.checkSharingPermissions=i.checkPermissions,n._File.prototype.getSharingInformation=i.getSharingInformation,n._File.prototype.getObjectSharingSettings=i.getObjectSharingSettings,n._File.prototype.unshare=i.unshareObject,n._File.prototype.deleteSharingLinkByKind=i.deleteLinkByKind,n._File.prototype.unshareLink=i.unshareLink},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(24),i=r(26);o._Folder.prototype.shareWith=function(e,t,r,o,a){return void 0===t&&(t=i.SharingRole.View),void 0===r&&(r=!1),void 0===o&&(o=!1),n.__awaiter(this,void 0,void 0,(function(){var i,s;return n.__generator(this,(function(n){switch(n.label){case 0:return i=this.addBatchDependency(),[4,this.getShareable()];case 1:return s=n.sent(),i(),[2,s.shareWith(e,t,r,o,a)]}}))}))},o._Folder.prototype.getShareLink=function(e,t){return void 0===t&&(t=null),n.__awaiter(this,void 0,void 0,(function(){var r,o;return n.__generator(this,(function(n){switch(n.label){case 0:return r=this.addBatchDependency(),[4,this.getShareable()];case 1:return o=n.sent(),r(),[2,o.getShareLink(e,t)]}}))}))},o._Folder.prototype.checkSharingPermissions=function(e){return n.__awaiter(this,void 0,void 0,(function(){var t,r;return n.__generator(this,(function(n){switch(n.label){case 0:return t=this.addBatchDependency(),[4,this.getShareable()];case 1:return r=n.sent(),t(),[2,r.checkSharingPermissions(e)]}}))}))},o._Folder.prototype.getSharingInformation=function(e,t){return n.__awaiter(this,void 0,void 0,(function(){var r,o;return n.__generator(this,(function(n){switch(n.label){case 0:return r=this.addBatchDependency(),[4,this.getShareable()];case 1:return o=n.sent(),r(),[2,o.getSharingInformation(e,t)]}}))}))},o._Folder.prototype.getObjectSharingSettings=function(e){return void 0===e&&(e=!0),n.__awaiter(this,void 0,void 0,(function(){var t,r;return n.__generator(this,(function(n){switch(n.label){case 0:return t=this.addBatchDependency(),[4,this.getShareable()];case 1:return r=n.sent(),t(),[2,r.getObjectSharingSettings(e)]}}))}))},o._Folder.prototype.unshare=function(){return n.__awaiter(this,void 0,void 0,(function(){var e,t;return n.__generator(this,(function(r){switch(r.label){case 0:return e=this.addBatchDependency(),[4,this.getShareable()];case 1:return t=r.sent(),e(),[2,t.unshare()]}}))}))},o._Folder.prototype.deleteSharingLinkByKind=function(e){return n.__awaiter(this,void 0,void 0,(function(){var t,r;return n.__generator(this,(function(n){switch(n.label){case 0:return t=this.addBatchDependency(),[4,this.getShareable()];case 1:return r=n.sent(),t(),[2,r.deleteSharingLinkByKind(e)]}}))}))},o._Folder.prototype.unshareLink=function(e,t){return n.__awaiter(this,void 0,void 0,(function(){var r,o;return n.__generator(this,(function(n){switch(n.label){case 0:return r=this.addBatchDependency(),[4,this.getShareable()];case 1:return o=n.sent(),r(),[2,o.unshareLink(e,t)]}}))}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(16),o=r(26),i=r(50);n._Item.prototype.shareWith=function(e,t,r,n){return void 0===t&&(t=o.SharingRole.View),void 0===r&&(r=!1),i.shareWith(this,e,t,r,!1,n)},n._Item.prototype.getShareLink=i.getShareLink,n._Item.prototype.checkSharingPermissions=i.checkPermissions,n._Item.prototype.getSharingInformation=i.getSharingInformation,n._Item.prototype.getObjectSharingSettings=i.getObjectSharingSettings,n._Item.prototype.unshare=i.unshareObject,n._Item.prototype.deleteSharingLinkByKind=i.deleteLinkByKind,n._Item.prototype.unshareLink=i.unshareLink},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(7),i=r(26),a=r(3),s=r(12),u=r(50),c=r(2),l=r(0),p=r(4);o._Web.prototype.shareWith=function(e,t,r){return void 0===t&&(t=i.SharingRole.View),n.__awaiter(this,void 0,void 0,(function(){var o,i;return n.__generator(this,(function(n){switch(n.label){case 0:return o=this.addBatchDependency(),[4,new a._SharePointQueryableInstance(s.extractWebUrl(this.toUrl()),"/_api/web/url").get()];case 1:return i=n.sent(),o(),[2,this.shareObject(c.combine(i,"/_layouts/15/aclinv.aspx?forSharing=1&mbypass=1"),e,t,r)]}}))}))},o._Web.prototype.shareObject=function(e,t,r,n,o,i,a,s){return void 0===i&&(i=!1),void 0===a&&(a=!1),void 0===s&&(s=!0),u.shareObject(this,{emailData:n,group:o,includeAnonymousLinkInEmail:a,loginNames:t,propagateAcl:i,role:r,url:e,useSimplifiedRoles:s})},o._Web.prototype.shareObjectRaw=function(e){return u.shareObject(this,e,!0)},o._Web.prototype.unshareObject=function(e){return p.spPost(o.Web(this,"unshareObject"),l.body({url:e}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(7),o=r(51);n._Web.prototype.getSiteDesignRuns=function(e){return o.SiteDesigns(this,"").getSiteDesignRun(void 0,e)},n._Web.prototype.addSiteDesignTask=function(e){return o.SiteDesigns(this,"").addSiteDesignTaskToCurrentWeb(e)},n._Web.prototype.getSiteDesignRunStatus=function(e){return o.SiteDesigns(this,"").getSiteDesignRunStatus(void 0,e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(0),i=r(7),a=r(34),s=r(4),u=r(17);r(102),o.addProp(i._Web,"siteGroups",a.SiteGroups),o.addProp(i._Web,"associatedOwnerGroup",a.SiteGroups,"associatedownergroup"),o.addProp(i._Web,"associatedMemberGroup",a.SiteGroups,"associatedmembergroup"),o.addProp(i._Web,"associatedVisitorGroup",a.SiteGroups,"associatedvisitorgroup"),i._Web.prototype.createDefaultAssociatedGroups=function(e,t,r,o,a){return void 0===r&&(r=!1),void 0===o&&(o=!0),n.__awaiter(this,void 0,void 0,(function(){var c;return n.__generator(this,(function(n){switch(n.label){case 0:return[4,this.breakRoleInheritance(r,o)];case 1:return n.sent(),(c=this.clone(i.Web,"createDefaultAssociatedGroups(userLogin=@u,userLogin2=@v,groupNameSeed=@s)")).query.set("@u","'"+u.escapeQueryStrValue(t||"")+"'"),c.query.set("@v","'"+u.escapeQueryStrValue(a||"")+"'"),c.query.set("@s","'"+u.escapeQueryStrValue(e||"")+"'"),[2,s.spPost(c)]}}))}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(7),o=r(35);n._Web.prototype.getSiteScript=function(e){return o.SiteScripts(this.toUrl(),"").getSiteScriptFromWeb(void 0,e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(2),i=r(13),a=r(35);r(87);var s=r(7),u=r(12);i._List.prototype.getSiteScript=function(){return n.__awaiter(this,void 0,void 0,(function(){var e,t,r;return n.__generator(this,(function(n){switch(n.label){case 0:return[4,this.clone(i.List).rootFolder.get()];case 1:return e=n.sent(),[4,s.Web(u.extractWebUrl(this.toUrl())).select("Url").get()];case 2:return t=n.sent(),r=o.combine(t.Url,"Lists",e.Name),[2,a.SiteScripts(this,"").getSiteScriptFromList(r)]}}))}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(0),i=r(7),a=r(48),s=r(15),u=r(4);o.addProp(i._Web,"siteUsers",a.SiteUsers),o.addProp(i._Web,"currentUser",a.SiteUser,"currentuser"),i._Web.prototype.ensureUser=function(e){return n.__awaiter(this,void 0,void 0,(function(){var t;return n.__generator(this,(function(r){switch(r.label){case 0:return[4,u.spPost(this.clone(i.Web,"ensureuser"),o.body({logonName:e}))];case 1:return[2,{data:t=r.sent(),user:a.SiteUser(s.odataUrlFrom(t))}]}}))}))},i._Web.prototype.getUserById=function(e){return a.SiteUser(this,"getUserById("+e+")")}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(13),i=r(113);n.addProp(o._List,"subscriptions",i.Subscriptions)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(13),i=r(36);n.addProp(o._List,"userCustomActions",i.UserCustomActions)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(7),i=r(36);n.addProp(o._Web,"userCustomActions",i.UserCustomActions)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(23),i=r(36);n.addProp(o._Site,"userCustomActions",i.UserCustomActions)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(13),i=r(116);n.addProp(o._List,"views",i.Views),n.addProp(o._List,"defaultView",i.View,"DefaultView"),o._List.prototype.getView=function(e){return i.View(this,"getView('"+e+"')")}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(20),o=r(118);n._File.prototype.getLimitedWebPartManager=function(e){return void 0===e&&(e=o.WebPartsPersonalizationScope.Shared),o.LimitedWebPartManager(this,"getLimitedWebPartManager(scope="+e+")")}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(52),o=r(0),i=r(121);o.addProp(n._Post,"attachments",i.Attachments)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.type=function(e,t){return Object.assign({"@odata.type":e},t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(21),i=r(123);n.addProp(o._Group,"calendar",i.Calendar,"calendar"),n.addProp(o._Group,"events",i.Events)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(22),i=r(125);n.addProp(o._User,"contacts",i.Contacts),n.addProp(o._User,"contactFolders",i.ContactFolders)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(21),i=r(52);n.addProp(o._Group,"conversations",i.Conversations),n.addProp(o._Group,"acceptedSenders",i.Senders,"acceptedsenders"),n.addProp(o._Group,"rejectedSenders",i.Senders,"rejectedsenders")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(21),i=r(130);n.addProp(o._Group,"owners",i.Members,"owners"),n.addProp(o._Group,"members",i.Members)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(22),i=r(132),a=r(10);n.addProp(o._User,"messages",i.Messages),n.addProp(o._User,"mailboxSettings",i.MailboxSettings),n.addProp(o._User,"mailFolders",i.MailFolders),o._User.prototype.sendMail=function(e){return a.graphPost(this.clone(o.User,"sendMail"),n.body(e))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(22),i=r(134);n.addProp(o._User,"drive",i.Drive),n.addProp(o._User,"drives",i.Drives)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(22),i=r(136);n.addProp(o._User,"onenote",i.OneNote)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(21),i=r(138);n.addProp(o._Group,"photo",i.Photo)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(21),i=r(38);n.addProp(o._Group,"plans",i.Plans,"planner/plans")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(22),i=r(38);n.addProp(o._User,"tasks",i.Tasks,"planner/tasks")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(22),i=r(53);n.addProp(o._User,"joinedTeams",i.Teams,"joinedTeams")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(70);t.SPNS=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(119);t.GraphNS=n}])}));
//# sourceMappingURL=pnp.js.map